<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>54.2. サーバ内部からのエラーの報告</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="source-format.html" title="54.1. 書式" /><link rel="next" href="error-style-guide.html" title="54.3. エラーメッセージのスタイルガイド" /><meta name="viewport" content="width=device-width,initial-scale=1.0" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="4" align="center"><a accesskey="h" href="index.html">PostgreSQL 11.5文書</a></th></tr><tr><td width="10%" align="left"></td><td width="10%" align="left"></td><td width="60%" align="center"><a href="source.html" title="第54章 PostgreSQLコーディング規約">第54章 PostgreSQLコーディング規約</a></td><td width="20%" align="right"><div class="actions"><a class="issue" title="github" href="https://github.com/pgsql-jp/jpug-doc/issues/new?title=version 11.5 &#10;                      error-message-reporting.html">誤訳等の報告
                    </a></div></td></tr><tr><td width="10%" align="left"><a accesskey="p" href="source-format.html" title="54.1. 書式">前へ</a> </td><td width="10%" align="left"><a accesskey="u" href="source.html" title="第54章 PostgreSQLコーディング規約">上へ</a></td><td width="60%" align="center">54.2. サーバ内部からのエラーの報告</td><td width="20%" align="right"> <a accesskey="n" href="error-style-guide.html" title="54.3. エラーメッセージのスタイルガイド">次へ</a></td></tr></table><hr /></div><div class="sect1" id="ERROR-MESSAGE-REPORTING"><div class="titlepage"><div><div><h2 class="title" style="clear: both">54.2. サーバ内部からのエラーの報告</h2></div></div></div><span class="original">
   &lt;title&gt;Reporting Errors Within the Server&lt;/title&gt;
</span><a id="id-1.10.6.3.2" class="indexterm"></a><a id="id-1.10.6.3.3" class="indexterm"></a><p>
<span class="original">
    Error, warning, and log messages generated within the server code
    should be created using &lt;function&gt;ereport&lt;/function&gt;, or its older cousin
    &lt;function&gt;elog&lt;/function&gt;.  The use of this function is complex enough to
    require some explanation.
</span>
サーバコード内から生成されるエラー、警告、ログメッセージは、<code class="function">ereport</code>もしくはこれに似た古い<code class="function">elog</code>を使用して作成してください。
この関数の使用はいくつか説明が必要なほど複雑です。
   </p><p>
<span class="original">
    There are two required elements for every message: a severity level
    (ranging from &lt;literal&gt;DEBUG&lt;/literal&gt; to &lt;literal&gt;PANIC&lt;/literal&gt;) and a primary
    message text.  In addition there are optional elements, the most
    common of which is an error identifier code that follows the SQL spec's
    SQLSTATE conventions.
    &lt;function&gt;ereport&lt;/function&gt; itself is just a shell function, that exists
    mainly for the syntactic convenience of making message generation
    look like a function call in the C source code.  The only parameter
    accepted directly by &lt;function&gt;ereport&lt;/function&gt; is the severity level.
    The primary message text and any optional message elements are
    generated by calling auxiliary functions, such as &lt;function&gt;errmsg&lt;/function&gt;,
    within the &lt;function&gt;ereport&lt;/function&gt; call.
</span>
すべてのメッセージには、深刻度レベル（<code class="literal">DEBUG</code>から<code class="literal">PANIC</code>までの範囲）と主メッセージテキストという、2つの必須要素があります。
さらに、省略可能な要素があります。
その中で最もよく使用されるのは、SQL仕様のSQLSTATE規則に従うエラー識別コードです。
<code class="function">ereport</code>自身はシェル関数で、主に、メッセージ生成をCソースコード内の関数呼び出しのように行わせる、構文の便宜上存在します。
<code class="function">ereport</code>で直接受け付けられる唯一のパラメータは深刻度レベルです。
主メッセージテキストと任意の省略可能なメッセージ要素は、<code class="function">ereport</code>呼び出し内で<code class="function">errmsg</code>などの補助関数を呼び出すことで生成されます。
   </p><p>
<span class="original">
    A typical call to &lt;function&gt;ereport&lt;/function&gt; might look like this:
</span>
典型的な<code class="function">ereport</code>の呼び出しは以下のようなものです。
</p><pre class="programlisting">
ereport(ERROR,
        (errcode(ERRCODE_DIVISION_BY_ZERO),
         errmsg("division by zero")));
</pre><p>
<span class="original">
    This specifies error severity level &lt;literal&gt;ERROR&lt;/literal&gt; (a run-of-the-mill
    error).  The &lt;function&gt;errcode&lt;/function&gt; call specifies the SQLSTATE error code
    using a macro defined in &lt;filename&gt;src/include/utils/errcodes.h&lt;/filename&gt;.  The
    &lt;function&gt;errmsg&lt;/function&gt; call provides the primary message text.  Notice the
    extra set of parentheses surrounding the auxiliary function calls &amp;mdash;
    these are annoying but syntactically necessary.
</span>
これはエラー深刻度レベル<code class="literal">ERROR</code>（普通のエラー）を指定します。
<code class="function">errcode</code>呼び出しは、<code class="filename">src/include/utils/errcodes.h</code>で定義されたマクロを使用してSQLSTATEエラーコードを指定します。
<code class="function">errmsg</code>呼び出しは主メッセージテキストを提供します。
補助関数呼び出しを囲む余計な括弧群に注意してください。
これらはいらいらさせられますが、構文上必要です。
   </p><p>
<span class="original">
    Here is a more complex example:
</span>
以下に、より複雑な例を示します。
</p><pre class="programlisting">
ereport(ERROR,
        (errcode(ERRCODE_AMBIGUOUS_FUNCTION),
         errmsg("function %s is not unique",
                func_signature_string(funcname, nargs,
                                      NIL, actual_arg_types)),
         errhint("Unable to choose a best candidate function. "
                 "You might need to add explicit typecasts.")));
</pre><p>
<span class="original">
    This illustrates the use of format codes to embed run-time values into
    a message text.  Also, an optional &lt;quote&gt;hint&lt;/quote&gt; message is provided.
</span>
これは、実行時の値をメッセージテキスト内に埋め込むための整形用コードの使用を示します。
また、省略可能な<span class="quote">「<span class="quote">ヒント</span>」</span>メッセージも提供されています。
   </p><p>
<span class="original">
    If the severity level is &lt;literal&gt;ERROR&lt;/literal&gt; or higher,
    &lt;function&gt;ereport&lt;/function&gt; aborts the execution of the user-defined
    function and does not return to the caller. If the severity level is
    lower than &lt;literal&gt;ERROR&lt;/literal&gt;, &lt;function&gt;ereport&lt;/function&gt; returns normally.
</span>
深刻度レベルが<code class="literal">ERROR</code>以上であれば、<code class="function">ereport</code>はユーザ定義関数の実行を中断し呼び出し元には戻りません。
深刻度レベルが<code class="literal">ERROR</code>未満であれば、<code class="function">ereport</code>は正常に戻ります。
   </p><p>
<span class="original">
    The available auxiliary routines for &lt;function&gt;ereport&lt;/function&gt; are:
</span>
<code class="function">ereport</code>で使用可能な補助ルーチンを以下に示します。
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
<span class="original">
     &lt;function&gt;errcode(sqlerrcode)&lt;/function&gt; specifies the SQLSTATE error identifier
     code for the condition.  If this routine is not called, the error
     identifier defaults to
     &lt;literal&gt;ERRCODE_INTERNAL_ERROR&lt;/literal&gt; when the error severity level is
     &lt;literal&gt;ERROR&lt;/literal&gt; or higher, &lt;literal&gt;ERRCODE_WARNING&lt;/literal&gt; when the
     error level is &lt;literal&gt;WARNING&lt;/literal&gt;, otherwise (for &lt;literal&gt;NOTICE&lt;/literal&gt;
     and below) &lt;literal&gt;ERRCODE_SUCCESSFUL_COMPLETION&lt;/literal&gt;.
     While these defaults are often convenient, always think whether they
     are appropriate before omitting the &lt;function&gt;errcode()&lt;/function&gt; call.
</span>
<code class="function">errcode(sqlerrcode)</code>は、その条件用のSQLSTATEエラー識別コードを指定します。
このルーチンが呼び出されないと、エラー識別子のデフォルトは、エラー深刻度レベルが<code class="literal">ERROR</code>以上の場合には<code class="literal">ERRCODE_INTERNAL_ERROR</code>に、エラー深刻度レベルが<code class="literal">WARNING</code>の場合には<code class="literal">ERRCODE_WARNING</code>に、さもなければ（<code class="literal">NOTICE</code>以下）<code class="literal">ERRCODE_SUCCESSFUL_COMPLETION</code>になります。
これらのデフォルトはしばしば便利ですが、<code class="function">errcode()</code>呼び出しを省略する前に、常に適切かどうかを検討してください。
    </p></li><li class="listitem"><p>
<span class="original">
     &lt;function&gt;errmsg(const char *msg, ...)&lt;/function&gt; specifies the primary error
     message text, and possibly run-time values to insert into it.  Insertions
     are specified by &lt;function&gt;sprintf&lt;/function&gt;-style format codes.  In addition to
     the standard format codes accepted by &lt;function&gt;sprintf&lt;/function&gt;, the format
     code &lt;literal&gt;%m&lt;/literal&gt; can be used to insert the error message returned
     by &lt;function&gt;strerror&lt;/function&gt; for the current value of &lt;literal&gt;errno&lt;/literal&gt;.
</span>
<code class="function">errmsg(const char *msg, ...)</code>は、主エラーメッセージテキストを指定し、また、実行時の値をそこに挿入することもできます。
挿入は、<code class="function">sprintf</code>様式の書式コードで指定されます。
<code class="function">sprintf</code>で受け付けられる標準の書式コードに加え、<code class="literal">%m</code>書式コードを使用して、現在の<code class="literal">errno</code>の値用の<code class="function">strerror</code>で返されるエラーメッセージを挿入することができます。
     <a href="#ftn.id-1.10.6.3.9.2.2.1.7" class="footnote"><sup class="footnote" id="id-1.10.6.3.9.2.2.1.7">[13]</sup></a>
<span class="original">
     &lt;literal&gt;%m&lt;/literal&gt; does not require any
     corresponding entry in the parameter list for &lt;function&gt;errmsg&lt;/function&gt;.
     Note that the message string will be run through &lt;function&gt;gettext&lt;/function&gt;
     for possible localization before format codes are processed.
</span>
<code class="literal">%m</code>は<code class="function">errmsg</code>のパラメータリスト内に対応する項目を必要としません。
メッセージ文字列は、書式コードの処理を行う前に、地域化のために<code class="function">gettext</code>を通ることに注意してください。
    </p></li><li class="listitem"><p>
<span class="original">
     &lt;function&gt;errmsg_internal(const char *msg, ...)&lt;/function&gt; is the same as
     &lt;function&gt;errmsg&lt;/function&gt;, except that the message string will not be
     translated nor included in the internationalization message dictionary.
     This should be used for &lt;quote&gt;cannot happen&lt;/quote&gt; cases that are probably
     not worth expending translation effort on.
</span>
<code class="function">errmsg_internal(const char *msg, ...)</code>は、そのメッセージ文字列は変換されず、国際化用メッセージ辞書に含まれない点を除き、<code class="function">errmsg</code>と同一です。
これは、おそらく翻訳作業を行う価値がない<span class="quote">「<span class="quote">発生し得ない</span>」</span>場合用に使用すべきです。
    </p></li><li class="listitem"><p>
<span class="original">
     &lt;function&gt;errmsg_plural(const char *fmt_singular, const char *fmt_plural,
     unsigned long n, ...)&lt;/function&gt; is like &lt;function&gt;errmsg&lt;/function&gt;, but with
     support for various plural forms of the message.
     &lt;replaceable&gt;fmt_singular&lt;/replaceable&gt; is the English singular format,
     &lt;replaceable&gt;fmt_plural&lt;/replaceable&gt; is the English plural format,
     &lt;replaceable&gt;n&lt;/replaceable&gt; is the integer value that determines which plural
     form is needed, and the remaining arguments are formatted according
     to the selected format string.  For more information see
     &lt;xref linkend="nls-guidelines"/&gt;.
</span>
<code class="function">errmsg_plural(const char *fmt_singular, const char *fmt_plural, unsigned long n, ...)</code>は<code class="function">errmsg</code>のようですが、メッセージの各種の複数書式があります。
<em class="replaceable"><code>fmt_singular</code></em>は英語の単数書式、<em class="replaceable"><code>fmt_plural</code></em>は英語の複数書式、<em class="replaceable"><code>n</code></em>はどの複数書式が必要なのかを決定する整数値で、残りの引数は選択された書式文字列に従って書式化されます。
より詳細な情報は<a class="xref" href="nls-programmer.html#NLS-GUIDELINES" title="55.2.2. メッセージ記述の指針">55.2.2</a>を参照してください。
    </p></li><li class="listitem"><p>
<span class="original">
     &lt;function&gt;errdetail(const char *msg, ...)&lt;/function&gt; supplies an optional
     &lt;quote&gt;detail&lt;/quote&gt; message; this is to be used when there is additional
     information that seems inappropriate to put in the primary message.
     The message string is processed in just the same way as for
     &lt;function&gt;errmsg&lt;/function&gt;.
</span>
<code class="function">errdetail(const char *msg, ...)</code>は省略可能な<span class="quote">「<span class="quote">詳細</span>」</span>メッセージを提供します。
これは、主メッセージ内に記述するには不適切と考えられる追加情報がある場合に使用されます。
このメッセージ文字列は<code class="function">errmsg</code>とまったく同じ方法で処理されます。
    </p></li><li class="listitem"><p>
<span class="original">
     &lt;function&gt;errdetail_internal(const char *msg, ...)&lt;/function&gt; is the same
     as &lt;function&gt;errdetail&lt;/function&gt;, except that the message string will not be
     translated nor included in the internationalization message dictionary.
     This should be used for detail messages that are not worth expending
     translation effort on, for instance because they are too technical to be
     useful to most users.
</span>
<code class="function">errdetail_internal(const char *msg, ...)</code>は、メッセージが翻訳されない、または、国際化メッセージ辞書内に含まれない点を除き、<code class="function">errdetail</code>と同じです。
これは、例えばほとんどのユーザに役に立つにはあまりにも技術的すぎるなど、翻訳する手間をかける価値がない詳細メッセージで有用であるはずです。
    </p></li><li class="listitem"><p>
<span class="original">
     &lt;function&gt;errdetail_plural(const char *fmt_singular, const char *fmt_plural,
     unsigned long n, ...)&lt;/function&gt; is like &lt;function&gt;errdetail&lt;/function&gt;, but with
     support for various plural forms of the message.
     For more information see &lt;xref linkend="nls-guidelines"/&gt;.
</span>
<code class="function">errdetail_plural(const char *fmt_singular, const char *fmt_plural, unsigned long n, ...)</code>は<code class="function">errdetail</code>と似ていますが、メッセージの各種の複数書式をサポートします。
より詳細な情報は<a class="xref" href="nls-programmer.html#NLS-GUIDELINES" title="55.2.2. メッセージ記述の指針">55.2.2</a>を参照してください。
    </p></li><li class="listitem"><p>
<span class="original">
     &lt;function&gt;errdetail_log(const char *msg, ...)&lt;/function&gt; is the same as
     &lt;function&gt;errdetail&lt;/function&gt; except that this string goes only to the server
     log, never to the client.  If both &lt;function&gt;errdetail&lt;/function&gt; (or one of
     its equivalents above) and
     &lt;function&gt;errdetail_log&lt;/function&gt; are used then one string goes to the client
     and the other to the log.  This is useful for error details that are
     too security-sensitive or too bulky to include in the report
     sent to the client.
</span>
この文字列がサーバログのみに渡り、クライアントに渡らない点を除き<code class="function">errdetail_log(const char *msg, ...)</code>は<code class="function">errdetail</code>と同一です。
<code class="function">errdetail</code>（や上記の等価物の１つ）と<code class="function">errdetail_log</code>が共に使用された場合、１つの文字列はクライアントに渡り、もう１つはログに渡ります。
クライアントに送られるレポートに含めるにはセキュリティに対して慎重を期さなければならないもの、あるいは膨大すぎるエラー詳細に対して効果があります。
    </p></li><li class="listitem"><p>
<span class="original">
     &lt;function&gt;errdetail_log_plural(const char *fmt_singular, const char
     *fmt_plural, unsigned long n, ...)&lt;/function&gt; is like
     &lt;function&gt;errdetail_log&lt;/function&gt;, but with support for various plural forms of
     the message.
     For more information see &lt;xref linkend="nls-guidelines"/&gt;.
</span>
<code class="function">errdetail_log_plural(const char *fmt_singular, const char *fmt_plural, unsigned long n, ...)</code>は<code class="function">errdetail_log</code>と似ていますが、メッセージの各種の複数書式をサポートします。
より詳細な情報は<a class="xref" href="nls-programmer.html#NLS-GUIDELINES" title="55.2.2. メッセージ記述の指針">55.2.2</a>を参照してください。
    </p></li><li class="listitem"><p>
<span class="original">
     &lt;function&gt;errhint(const char *msg, ...)&lt;/function&gt; supplies an optional
     &lt;quote&gt;hint&lt;/quote&gt; message; this is to be used when offering suggestions
     about how to fix the problem, as opposed to factual details about
     what went wrong.
     The message string is processed in just the same way as for
     &lt;function&gt;errmsg&lt;/function&gt;.
</span>
<code class="function">errhint(const char *msg, ...)</code>は、省略可能な<span class="quote">「<span class="quote">ヒント</span>」</span>メッセージを提供します。
これは、何が悪かったのかについての事実に基づく詳細とは反対で、問題を解決させる方法に関する提言を提供するために使用されます。
このメッセージ文字列は<code class="function">errmsg</code>とまったく同じ方法で処理されます。
    </p></li><li class="listitem"><p>
<span class="original">
     &lt;function&gt;errcontext(const char *msg, ...)&lt;/function&gt; is not normally called
     directly from an &lt;function&gt;ereport&lt;/function&gt; message site; rather it is used
     in &lt;literal&gt;error_context_stack&lt;/literal&gt; callback functions to provide
     information about the context in which an error occurred, such as the
     current location in a PL function.
     The message string is processed in just the same way as for
     &lt;function&gt;errmsg&lt;/function&gt;.  Unlike the other auxiliary functions, this can
     be called more than once per &lt;function&gt;ereport&lt;/function&gt; call; the successive
     strings thus supplied are concatenated with separating newlines.
</span>
<code class="function">errcontext(const char *msg, ...)</code>は通常<code class="function">ereport</code>メッセージ側から直接呼び出されません。
エラーが発生したコンテキスト、例えばPL関数の現在位置の情報を提供するために<code class="literal">error_context_stack</code>コールバック関数内で使用されます。
メッセージ文字列は<code class="function">errmsg</code>とまったく同じ方法で処理されます。
他の補助関数とは異なり、1つの<code class="function">ereport</code>呼び出しで何度も呼び出すことができます。
こうして提供される文字列の並びは、改行で区切った形で連結されます。
    </p></li><li class="listitem"><p>
<span class="original">
     &lt;function&gt;errposition(int cursorpos)&lt;/function&gt; specifies the textual location
     of an error within a query string.  Currently it is only useful for
     errors detected in the lexical and syntactic analysis phases of
     query processing.
</span>
<code class="function">errposition(int cursorpos)</code>は、問い合わせ文字列内でエラーが発生した位置をテキストで指定します。
現在、問い合わせ処理の字句解析および構文解析段階でエラーが検出された場合にのみ役に立ちます。
    </p></li><li class="listitem"><p>
<span class="original">
     &lt;function&gt;errtable(Relation rel)&lt;/function&gt; specifies a relation whose
     name and schema name should be included as auxiliary fields in the error
     report.
</span>
<code class="function">errtable(Relation rel)</code>はエラーレポートにおいて名前とスキーマ名が外部フィールドとして含まれなければならないリレーションを指定します。
    </p></li><li class="listitem"><p>
<span class="original">
     &lt;function&gt;errtablecol(Relation rel, int attnum)&lt;/function&gt; specifies
     a column whose name, table name, and schema name should be included as
     auxiliary fields in the error report.
</span>
<code class="function">errtablecol(Relation rel, int attnum)</code>はエラーレポートにおいて名前、テーブル名、およびスキーマ名が外部フィールドとして含まれなければならない列を指定します。
    </p></li><li class="listitem"><p>
<span class="original">
     &lt;function&gt;errtableconstraint(Relation rel, const char *conname)&lt;/function&gt;
     specifies a table constraint whose name, table name, and schema name
     should be included as auxiliary fields in the error report.  Indexes
     should be considered to be constraints for this purpose, whether or
     not they have an associated &lt;structname&gt;pg_constraint&lt;/structname&gt; entry.  Be
     careful to pass the underlying heap relation, not the index itself, as
     &lt;literal&gt;rel&lt;/literal&gt;.
</span>
<code class="function">errtableconstraint(Relation rel, const char *conname)</code>はエラーレポートにおいて名前、テーブル名、およびスキーマ名が外部フィールドとして含まれなければならないテーブル制約を指定します。
この目的のため、関連した<code class="structname">pg_constraint</code>エントリの有る無しに関わらず、インデックスは制約と見なされなければなりません。進行中のヒープリレーションを受け渡すにはインデックスではなく<code class="literal">rel</code>とすることに注意してください。
    </p></li><li class="listitem"><p>
<span class="original">
     &lt;function&gt;errdatatype(Oid datatypeOid)&lt;/function&gt; specifies a data
     type whose name and schema name should be included as auxiliary fields
     in the error report.
</span>
<code class="function">errdatatype(Oid datatypeOid)</code>はエラーレポートにおいて名前とスキーマ名が外部フィールドとして含まれなければならないデータ型を指定します。
    </p></li><li class="listitem"><p>
<span class="original">
     &lt;function&gt;errdomainconstraint(Oid datatypeOid, const char *conname)&lt;/function&gt;
     specifies a domain constraint whose name, domain name, and schema name
     should be included as auxiliary fields in the error report.
</span>
<code class="function">errdomainconstraint(Oid datatypeOid, const char *conname)</code>はエラーレポートにおいて名前、ドメイン名、およびスキーマ名が外部フィールドとして含まれなければならないドメイン制約を指定します。
    </p></li><li class="listitem"><p>
<span class="original">
     &lt;function&gt;errcode_for_file_access()&lt;/function&gt; is a convenience function that
     selects an appropriate SQLSTATE error identifier for a failure in a
     file-access-related system call.  It uses the saved
     &lt;literal&gt;errno&lt;/literal&gt; to determine which error code to generate.
     Usually this should be used in combination with &lt;literal&gt;%m&lt;/literal&gt; in the
     primary error message text.
</span>
<code class="function">errcode_for_file_access()</code>は、ファイルアクセス関連のシステムコールでの失敗用のSQLSTATEエラー識別子を適切に選択する、便利な関数です。
保存された<code class="literal">errno</code>を使用して、どのエラーコードを生成するかを決定します。
通常、これは主エラーメッセージテキスト内で<code class="literal">%m</code>と組み合わせて使用されなければなりません。
    </p></li><li class="listitem"><p>
<span class="original">
     &lt;function&gt;errcode_for_socket_access()&lt;/function&gt; is a convenience function that
     selects an appropriate SQLSTATE error identifier for a failure in a
     socket-related system call.
</span>
<code class="function">errcode_for_socket_access()</code>は、ソケット関連のシステムコールでの失敗用のSQLSTATEエラー識別子を適切に選択する、便利な関数です。
    </p></li><li class="listitem"><p>
<span class="original">
     &lt;function&gt;errhidestmt(bool hide_stmt)&lt;/function&gt; can be called to specify
     suppression of the &lt;literal&gt;STATEMENT:&lt;/literal&gt; portion of a message in the
     postmaster log.  Generally this is appropriate if the message text
     includes the current statement already.
</span>
<code class="function">errhidestmt(bool hide_stmt)</code>は、postmasterのログ内のメッセージにおける<code class="literal">STATEMENT:</code>部分を抑制するために呼び出すことができます。
通常これは、メッセージテキスト内にすでに現在の文が含まれている場合に適しています。
    </p></li><li class="listitem"><p>
<span class="original">
     &lt;function&gt;errhidecontext(bool hide_ctx)&lt;/function&gt; can be called to
     specify suppression of the &lt;literal&gt;CONTEXT:&lt;/literal&gt; portion of a message in
     the postmaster log.  This should only be used for verbose debugging
     messages where the repeated inclusion of context would bloat the log
     volume too much.
</span>
<code class="function">errhidecontext(bool hide_ctx)</code>は、postmasterのログ内のメッセージにおける<code class="literal">CONTEXT:</code>部分を抑制するために呼び出すことができます。
これは、冗長なデバッグメッセージにおいてコンテキストを繰り返し含めることがログのサイズを巨大にしてしまうような場合にのみ用いられるべきです。
    </p></li></ul></div><p>
   </p><div class="note"><h3 class="title">注記</h3><p>
<span class="original">
     At most one of the functions &lt;function&gt;errtable&lt;/function&gt;,
     &lt;function&gt;errtablecol&lt;/function&gt;, &lt;function&gt;errtableconstraint&lt;/function&gt;,
     &lt;function&gt;errdatatype&lt;/function&gt;, or &lt;function&gt;errdomainconstraint&lt;/function&gt; should
     be used in an &lt;function&gt;ereport&lt;/function&gt; call.  These functions exist to
     allow applications to extract the name of a database object associated
     with the error condition without having to examine the
     potentially-localized error message text.
     These functions should be used in error reports for which it's likely
     that applications would wish to have automatic error handling.  As of
     &lt;productname&gt;PostgreSQL&lt;/productname&gt; 9.3, complete coverage exists only for
     errors in SQLSTATE class 23 (integrity constraint violation), but this
     is likely to be expanded in future.
</span>
<code class="function">ereport</code>呼び出しにおいて、最大限でも<code class="function">errtable</code>、<code class="function">errtablecol</code>、 <code class="function">errtableconstraint</code>、<code class="function">errdatatype</code>、または<code class="function">errdomainconstraint</code>のうちの一つの関数が使用されなければなりません。
これらの関数は、アプリケーションが自動エラー対応であって欲しいと期待するエラーレポートにおいて使用されるべきです。
<span class="productname">PostgreSQL</span> 9.3の時点で、この機能を完璧に保証する範囲はSQLSTATEクラス23（整合性制約違反）のみですが、将来的には十中八九拡張されそうです。
    </p></div><p>
<span class="original">
    There is an older function &lt;function&gt;elog&lt;/function&gt; that is still heavily used.
    An &lt;function&gt;elog&lt;/function&gt; call:
</span>
まだ頻繁に使用されている、古めの<code class="function">elog</code>関数があります。
以下の<code class="function">elog</code>呼び出しは、
</p><pre class="programlisting">
elog(level, "format string", ...);
</pre><p>
<span class="original">
    is exactly equivalent to:
</span>
以下とまったく同じです。
</p><pre class="programlisting">
ereport(level, (errmsg_internal("format string", ...)));
</pre><p>
<span class="original">
    Notice that the SQLSTATE error code is always defaulted, and the message
    string is not subject to translation.
    Therefore, &lt;function&gt;elog&lt;/function&gt; should be used only for internal errors and
    low-level debug logging.  Any message that is likely to be of interest to
    ordinary users should go through &lt;function&gt;ereport&lt;/function&gt;.  Nonetheless,
    there are enough internal &lt;quote&gt;cannot happen&lt;/quote&gt; error checks in the
    system that &lt;function&gt;elog&lt;/function&gt; is still widely used; it is preferred for
    those messages for its notational simplicity.
</span>
SQLSTATEエラーコードが常にデフォルトになること、メッセージ文字列が変換されないことに注意してください。
したがって、<code class="function">elog</code>は、内部エラーと低レベルなデバッグ用ログにのみ使用すべきです。
一般ユーザを対象とする任意のメッセージは<code class="function">ereport</code>を使用すべきです。
それでもなお、システム内の<span class="quote">「<span class="quote">発生できなかった</span>」</span>内部エラーの検査に<code class="function">elog</code>がまだ多く使用されています。
これは、こうした単純な表記のメッセージに適しています。
   </p><p>
<span class="original">
    Advice about writing good error messages can be found in
    &lt;xref linkend="error-style-guide"/&gt;.
</span>
<a class="xref" href="error-style-guide.html" title="54.3. エラーメッセージのスタイルガイド">54.3</a>に推奨するエラーメッセージの作成についての提言を示します。
   </p><div class="footnotes"><br /><hr style="width:100; text-align:left;margin-left: 0" /><div id="ftn.id-1.10.6.3.9.2.2.1.7" class="footnote"><p><a href="#id-1.10.6.3.9.2.2.1.7" class="para"><sup class="para">[13] </sup></a>
<span class="original">
       That is, the value that was current when the &lt;function&gt;ereport&lt;/function&gt; call
       was reached; changes of &lt;literal&gt;errno&lt;/literal&gt; within the auxiliary reporting
       routines will not affect it.  That would not be true if you were to
       write &lt;literal&gt;strerror(errno)&lt;/literal&gt; explicitly in &lt;function&gt;errmsg&lt;/function&gt;'s
       parameter list; accordingly, do not do so.
</span>
つまり、<code class="function">ereport</code>呼び出しに達した時点の値です。
補助報告ルーチン内で<code class="literal">errno</code>を変更しても効果はありません。
<code class="function">errmsg</code>内で<code class="literal">strerror(errno)</code>を明示的に記述したとしても正確なものにはなりません。
したがって、このようにはしないでください。
      </p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="source-format.html">前へ</a> </td><td width="20%" align="center"><a accesskey="u" href="source.html">上へ</a></td><td width="40%" align="right"> <a accesskey="n" href="error-style-guide.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">54.1. 書式 </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> 54.3. エラーメッセージのスタイルガイド</td></tr></table></div></body></html>