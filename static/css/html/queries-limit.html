<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>7.6. LIMITとOFFSET</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="queries-order.html" title="7.5. 行の並べ替え" /><link rel="next" href="queries-values.html" title="7.7. VALUESリスト" /><meta name="viewport" content="width=device-width,initial-scale=1.0" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="4" align="center"><a accesskey="h" href="index.html">PostgreSQL 11.4文書</a></th></tr><tr><td width="10%" align="left"></td><td width="10%" align="left"></td><td width="60%" align="center"><a href="queries.html" title="第7章 問い合わせ">第7章 問い合わせ</a></td><td width="20%" align="right"></td></tr><tr><td width="10%" align="left"><a accesskey="p" href="queries-order.html" title="7.5. 行の並べ替え">前へ</a> </td><td width="10%" align="left"><a accesskey="u" href="queries.html" title="第7章 問い合わせ">上へ</a></td><td width="60%" align="center">7.6. <code class="literal">LIMIT</code>と<code class="literal">OFFSET</code></td><td width="20%" align="right"> <a accesskey="n" href="queries-values.html" title="7.7. VALUESリスト">次へ</a></td></tr></table><hr /></div><div class="sect1" id="QUERIES-LIMIT"><div class="titlepage"><div><div><h2 class="title" style="clear: both">7.6. <code class="literal">LIMIT</code>と<code class="literal">OFFSET</code></h2></div></div></div><!--
  <title><literal>LIMIT</literal> and <literal>OFFSET</literal></title>
--><a id="id-1.5.6.10.2" class="indexterm"></a><a id="id-1.5.6.10.3" class="indexterm"></a><p>
<!--
   <literal>LIMIT</literal> and <literal>OFFSET</literal> allow you to retrieve just
   a portion of the rows that are generated by the rest of the query:
-->
<code class="literal">LIMIT</code>および<code class="literal">OFFSET</code>を使うことで、問い合わせの実行で生成された行の一部だけを取り出すことができます。
</p><pre class="synopsis">
SELECT <em class="replaceable"><code>select_list</code></em>
    FROM <em class="replaceable"><code>table_expression</code></em>
    [<span class="optional"> ORDER BY ... </span>]
    [<span class="optional"> LIMIT { <em class="replaceable"><code>number</code></em> | ALL } </span>] [<span class="optional"> OFFSET <em class="replaceable"><code>number</code></em> </span>]
</pre><p>
  </p><p>
<!--
   If a limit count is given, no more than that many rows will be
   returned (but possibly fewer, if the query itself yields fewer rows).
   <literal>LIMIT ALL</literal> is the same as omitting the <literal>LIMIT</literal>
   clause, as is <literal>LIMIT</literal> with a NULL argument.
-->
限度(limit)数を指定すると、指定した行数より多くの行が返されることはありません（しかし、問い合わせの結果が指定した行数より少なければ、それより少なくなります）。
<code class="literal">LIMIT ALL</code>は、<code class="literal">LIMIT</code>句を省略した場合と同じです。<code class="literal">LIMIT</code>の引数がNULLの場合も同様です。
  </p><p>
<!--
   <literal>OFFSET</literal> says to skip that many rows before beginning to
   return rows.  <literal>OFFSET 0</literal> is the same as omitting the
   <literal>OFFSET</literal> clause, as is <literal>OFFSET</literal> with a NULL argument.
-->
<code class="literal">OFFSET</code>は、行を返し始める前に飛ばす行数を指定します。
<code class="literal">OFFSET 0</code>は、<code class="literal">OFFSET</code>句を省略した場合と同じです。<code class="literal">OFFSET</code>の引数がNULLの場合も同様です。
  </p><p>
<!--
   If both <literal>OFFSET</literal>
   and <literal>LIMIT</literal> appear, then <literal>OFFSET</literal> rows are
   skipped before starting to count the <literal>LIMIT</literal> rows that
   are returned.
-->
<code class="literal">OFFSET</code>および<code class="literal">LIMIT</code>の両者が指定された場合、<code class="literal">OFFSET</code>分の行を飛ばしてから、返される<code class="literal">LIMIT</code>行を数え始めます。
  </p><p>
<!--
   When using <literal>LIMIT</literal>, it is important to use an
   <literal>ORDER BY</literal> clause that constrains the result rows into a
   unique order.  Otherwise you will get an unpredictable subset of
   the query's rows. You might be asking for the tenth through
   twentieth rows, but tenth through twentieth in what ordering? The
   ordering is unknown, unless you specified <literal>ORDER BY</literal>.
-->
<code class="literal">LIMIT</code>を使用する時は、結果の行を一意な順序に制御する<code class="literal">ORDER BY</code>句を使用することが重要です。
<code class="literal">ORDER BY</code>を使わなければ、問い合わせの行について予測不能な部分集合を得ることになるでしょう。
10番目から20番目の行を問い合わせることもあるでしょうが、どういう並び順での10番目から20番目の行でしょうか？
<code class="literal">ORDER BY</code>を指定しなければ、並び順はわかりません。
  </p><p>
<!--
   The query optimizer takes <literal>LIMIT</literal> into account when
   generating query plans, so you are very likely to get different
   plans (yielding different row orders) depending on what you give
   for <literal>LIMIT</literal> and <literal>OFFSET</literal>.  Thus, using
   different <literal>LIMIT</literal>/<literal>OFFSET</literal> values to select
   different subsets of a query result <emphasis>will give
   inconsistent results</emphasis> unless you enforce a predictable
   result ordering with <literal>ORDER BY</literal>.  This is not a bug; it
   is an inherent consequence of the fact that SQL does not promise to
   deliver the results of a query in any particular order unless
   <literal>ORDER BY</literal> is used to constrain the order.
-->
問い合わせオプティマイザは、問い合わせ計画を生成する時に<code class="literal">LIMIT</code>を考慮します。
そのため、<code class="literal">LIMIT</code>と<code class="literal">OFFSET</code>に指定した値によって、異なった計画（得られる行の順序も異なります）が得られる可能性が高いです。
従って、1つの問い合わせ結果から異なる部分集合を選び出すために、異なる<code class="literal">LIMIT</code>/<code class="literal">OFFSET</code>の値を使用すると、<code class="literal">ORDER BY</code>で結果の順序を制御しなければ、<span class="emphasis"><em>一貫しない結果が生じるでしょう</em></span>。
これは不具合ではありません。
<code class="literal">ORDER BY</code>を使って順序を制御しない限り、SQLは必ずしも特定の順序で問い合わせの結果を渡さないという特性の必然的な結果です。
  </p><p>
<!--
   The rows skipped by an <literal>OFFSET</literal> clause still have to be
   computed inside the server; therefore a large <literal>OFFSET</literal>
   might be inefficient.
-->
<code class="literal">OFFSET</code>句で飛ばされる行を、実際にはサーバ内で計算しなければなりません。
そのため、大きな値の<code class="literal">OFFSET</code>は非効率的になることがあります。
  </p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="queries-order.html">前へ</a> </td><td width="20%" align="center"><a accesskey="u" href="queries.html">上へ</a></td><td width="40%" align="right"> <a accesskey="n" href="queries-values.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">7.5. 行の並べ替え </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> 7.7. <code class="literal">VALUES</code>リスト</td></tr></table></div></body></html>