<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>9.27. システム管理関数</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="functions-info.html" title="9.26. システム情報関数と演算子" /><link rel="next" href="functions-trigger.html" title="9.28. トリガ関数" /><meta name="viewport" content="width=device-width,initial-scale=1.0" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="4" align="center"><a accesskey="h" href="index.html">PostgreSQL 16.0文書</a></th></tr><tr><td width="10%" align="left"></td><td width="10%" align="left"></td><td width="60%" align="center"><a href="functions.html" title="第9章 関数と演算子">第9章 関数と演算子</a></td><td width="20%" align="right"></td></tr><tr><td width="10%" align="left"><a accesskey="p" href="functions-info.html" title="9.26. システム情報関数と演算子">前へ</a> </td><td width="10%" align="left"><a accesskey="u" href="functions.html" title="第9章 関数と演算子">上へ</a></td><td width="60%" align="center">9.27. システム管理関数</td><td width="20%" align="right"> <a accesskey="n" href="functions-trigger.html" title="9.28. トリガ関数">次へ</a></td></tr></table><hr /></div><div class="sect1" id="FUNCTIONS-ADMIN"><div class="titlepage"><div><div><h2 class="title" style="clear: both">9.27. システム管理関数 <a href="#FUNCTIONS-ADMIN" class="id_link">#</a></h2></div></div></div><!--
   <title>System Administration Functions</title>
--><p>
<!--
    The functions described in this section are used to control and
    monitor a <productname>PostgreSQL</productname> installation.
-->
本節で説明する関数は、<span class="productname">PostgreSQL</span>インストレーションの制御と監視を行うために使用されます。
   </p><div class="sect2" id="FUNCTIONS-ADMIN-SET"><div class="titlepage"><div><div><h3 class="title">9.27.1. 構成設定関数 <a href="#FUNCTIONS-ADMIN-SET" class="id_link">#</a></h3></div></div></div><!--
   <title>Configuration Settings Functions</title>
--><a id="id-1.5.8.35.3.2" class="indexterm"></a><a id="id-1.5.8.35.3.3" class="indexterm"></a><a id="id-1.5.8.35.3.4" class="indexterm"></a><a id="id-1.5.8.35.3.5" class="indexterm"></a><p>
<!--
    <xref linkend="functions-admin-set-table"/> shows the functions
    available to query and alter run-time configuration parameters.
-->
<a class="xref" href="functions-admin.html#FUNCTIONS-ADMIN-SET-TABLE" title="表9.89 構成設定関数">表 9.89</a>は、実行時設定パラメータの問い合わせや変更に使用できる関数を示しています。
   </p><div class="table" id="FUNCTIONS-ADMIN-SET-TABLE"><p class="title"><strong>表9.89 構成設定関数</strong></p><div class="table-contents"><!--
    <title>Configuration Settings Functions</title>
--><table class="table" summary="構成設定関数" border="1"><colgroup><col /></colgroup><thead><tr><th class="func_table_entry"><p class="func_signature">
<!--
        Function
-->
関数
       </p>
       <p>
<!--
        Description
-->
説明
       </p>
       <p>
<!--
        Example(s)
-->
例
       </p></th></tr></thead><tbody><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.3.7.2.2.1.1.1.1" class="indexterm"></a>
        <code class="function">current_setting</code> ( <em class="parameter"><code>setting_name</code></em> <code class="type">text</code> [<span class="optional">, <em class="parameter"><code>missing_ok</code></em> <code class="type">boolean</code> </span>] )
        → <code class="returnvalue">text</code>
       </p>
       <p>
<!--
        Returns the current value of the
        setting <parameter>setting_name</parameter>.  If there is no such
        setting, <function>current_setting</function> throws an error
        unless <parameter>missing_ok</parameter> is supplied and
        is <literal>true</literal> (in which case NULL is returned).
        This function corresponds to
        the <acronym>SQL</acronym> command <xref linkend="sql-show"/>.
-->
現在の<em class="parameter"><code>setting_name</code></em>の設定値を返します。
そのような設定がなければ、<em class="parameter"><code>missing_ok</code></em>が渡され、それが<code class="literal">true</code>でない限り<code class="function">current_setting</code>はエラーを引き起こします（この場合はNULLが返ります）。
この関数は<acronym class="acronym">SQL</acronym>コマンドの<a class="xref" href="sql-show.html" title="SHOW"><span class="refentrytitle">SHOW</span></a>に関連します。
       </p>
       <p>
        <code class="literal">current_setting('datestyle')</code>
        → <code class="returnvalue">ISO, MDY</code>
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.3.7.2.2.2.1.1.1" class="indexterm"></a>
        <code class="function">set_config</code> (
          <em class="parameter"><code>setting_name</code></em> <code class="type">text</code>,
          <em class="parameter"><code>new_value</code></em> <code class="type">text</code>,
          <em class="parameter"><code>is_local</code></em> <code class="type">boolean</code> )
        → <code class="returnvalue">text</code>
       </p>
       <p>
<!--
        Sets the parameter <parameter>setting_name</parameter>
        to <parameter>new_value</parameter>, and returns that value.
        If <parameter>is_local</parameter> is <literal>true</literal>, the new
        value will only apply during the current transaction. If you want the
        new value to apply for the rest of the current session,
        use <literal>false</literal> instead. This function corresponds to
        the SQL command <xref linkend="sql-set"/>.
-->
<em class="parameter"><code>setting_name</code></em>パラメータに<em class="parameter"><code>new_value</code></em>を設定し、その値を返します。
<em class="parameter"><code>is_local</code></em>が渡され、それが<code class="literal">true</code>なら新しい値は現在のトランザクションの間にのみ適用されます。
現在のセッションで以降に新しい値を適用したければ、代わりに<code class="literal">false</code>としてください。
このコマンドはSQLコマンドの<a class="xref" href="sql-set.html" title="SET"><span class="refentrytitle">SET</span></a>に関連します。
       </p>
       <p>
        <code class="literal">set_config('log_statement_stats', 'off', false)</code>
        → <code class="returnvalue">off</code>
       </p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="FUNCTIONS-ADMIN-SIGNAL"><div class="titlepage"><div><div><h3 class="title">9.27.2. サーバシグナル送信関数 <a href="#FUNCTIONS-ADMIN-SIGNAL" class="id_link">#</a></h3></div></div></div><!--
   <title>Server Signaling Functions</title>
--><a id="id-1.5.8.35.4.2" class="indexterm"></a><a id="id-1.5.8.35.4.3" class="indexterm"></a><p>
<!--
    The functions shown in <xref
    linkend="functions-admin-signal-table"/> send control signals to
    other server processes.  Use of these functions is restricted to
    superusers by default but access may be granted to others using
    <command>GRANT</command>, with noted exceptions.
-->
<a class="xref" href="functions-admin.html#FUNCTIONS-ADMIN-SIGNAL-TABLE" title="表9.90 サーバシグナル送信関数">表 9.90</a>に示す関数は、制御用シグナルを他のサーバプロセスに送信します。
これらの関数の使用は、デフォルトでスーパーユーザのみに制限されていますが、注記された例外を除き、<code class="command">GRANT</code>を使用して他のユーザにアクセスを許可できます。
   </p><p>
<!--
    Each of these functions returns <literal>true</literal> if
    the signal was successfully sent and <literal>false</literal>
    if sending the signal failed.
-->
これらのそれぞれの関数はシグナルの送付が成功の場合<code class="literal">true</code>を返し、シグナルの送付に失敗したときには<code class="literal">false</code>を返します。
   </p><div class="table" id="FUNCTIONS-ADMIN-SIGNAL-TABLE"><p class="title"><strong>表9.90 サーバシグナル送信関数</strong></p><div class="table-contents"><!--
    <title>Server Signaling Functions</title>
--><table class="table" summary="サーバシグナル送信関数" border="1"><colgroup><col /></colgroup><thead><tr><th class="func_table_entry"><p class="func_signature">
<!--
        Function
-->
関数
       </p>
       <p>
<!--
        Description
-->
説明
       </p></th></tr></thead><tbody><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.4.6.2.2.1.1.1.1" class="indexterm"></a>
        <code class="function">pg_cancel_backend</code> ( <em class="parameter"><code>pid</code></em> <code class="type">integer</code> )
        → <code class="returnvalue">boolean</code>
       </p>
       <p>
<!--
        Cancels the current query of the session whose backend process has the
        specified process ID.  This is also allowed if the
        calling role is a member of the role whose backend is being canceled or
        the calling role has privileges of <literal>pg_signal_backend</literal>,
        however only superusers can cancel superuser backends.
-->
指定したプロセスIDを持つバックエンドプロセスの現在のセッションの問い合わせを取り消します。
呼び出し側のロールがキャンセルされるバックエンドのロールのメンバーであるか、<code class="literal">pg_signal_backend</code>の権限を与えられている場合に実行できます。
ただし、スーパーユーザのバックエンドはスーパーユーザのみが取り消せます。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.4.6.2.2.2.1.1.1" class="indexterm"></a>
        <code class="function">pg_log_backend_memory_contexts</code> ( <em class="parameter"><code>pid</code></em> <code class="type">integer</code> )
        → <code class="returnvalue">boolean</code>
       </p>
       <p>
<!--
        Requests to log the memory contexts of the backend with the
        specified process ID.  This function can send the request to
        backends and auxiliary processes except logger.  These memory contexts
        will be logged at
        <literal>LOG</literal> message level. They will appear in
        the server log based on the log configuration set
        (see <xref linkend="runtime-config-logging"/> for more information),
        but will not be sent to the client regardless of
        <xref linkend="guc-client-min-messages"/>.
-->
指定プロセスIDのバックエンドのメモリコンテキストを記録することを要求します。
この関数はバックエンドとロガー以外の外部プロセスに要求を送ることができます。
メモリコンテキストは<code class="literal">LOG</code>メッセージレベルでログされます。
ログは、ログ設定（詳細は<a class="xref" href="runtime-config-logging.html" title="20.8. エラー報告とログ取得">20.8</a>を参照）に基づきサーバログに現れますが、<a class="xref" href="runtime-config-client.html#GUC-CLIENT-MIN-MESSAGES">client_min_messages</a>に関わらずクライアントには送られません。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.4.6.2.2.3.1.1.1" class="indexterm"></a>
        <code class="function">pg_reload_conf</code> ()
        → <code class="returnvalue">boolean</code>
       </p>
       <p>
<!--
        Causes all processes of the <productname>PostgreSQL</productname>
        server to reload their configuration files.  (This is initiated by
        sending a <systemitem>SIGHUP</systemitem> signal to the postmaster
        process, which in turn sends <systemitem>SIGHUP</systemitem> to each
        of its children.) You can use the
        <link linkend="view-pg-file-settings"><structname>pg_file_settings</structname></link>,
        <link linkend="view-pg-hba-file-rules"><structname>pg_hba_file_rules</structname></link> and
        <link linkend="view-pg-hba-file-rules"><structname>pg_ident_file_mappings</structname></link> views
        to check the configuration files for possible errors, before reloading.
-->
<span class="productname">PostgreSQL</span>のすべてのサーバプロセスに構成ファイルの再読み込みをさせます。
（これは<span class="systemitem">SIGHUP</span>シグナルをpostmasterプロセスに送ることによって始まり、postmasterは続いて<span class="systemitem">SIGHUP</span>を子に送ります。）
再ロードする前に、設定ファイルにエラーの可能性があるかどうかをチェックするために<a class="link" href="view-pg-file-settings.html" title="54.7. pg_file_settings"><code class="structname">pg_file_settings</code></a>、<a class="link" href="view-pg-hba-file-rules.html" title="54.9. pg_hba_file_rules"><code class="structname">pg_hba_file_rules</code></a>、<a class="link" href="view-pg-hba-file-rules.html" title="54.9. pg_hba_file_rules"><code class="structname">pg_ident_file_mappings</code></a>ビューを利用できます。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.4.6.2.2.4.1.1.1" class="indexterm"></a>
        <code class="function">pg_rotate_logfile</code> ()
        → <code class="returnvalue">boolean</code>
       </p>
       <p>
<!--
        Signals the log-file manager to switch to a new output file
        immediately.  This works only when the built-in log collector is
        running, since otherwise there is no log-file manager subprocess.
-->
ログファイルマネージャにシグナルを送って新しいファイルに直ちに切り替えさせます。
これは組み込みのログ収集機構が実行中のみ動作します。でないとログマネージャサブプロセスが存在しないからです。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.4.6.2.2.5.1.1.1" class="indexterm"></a>
        <code class="function">pg_terminate_backend</code> ( <em class="parameter"><code>pid</code></em> <code class="type">integer</code>, <em class="parameter"><code>timeout</code></em> <code class="type">bigint</code> <code class="literal">DEFAULT</code> <code class="literal">0</code> )
        → <code class="returnvalue">boolean</code>
       </p>
       <p>
<!--
        Terminates the session whose backend process has the
        specified process ID.  This is also allowed if the calling role
        is a member of the role whose backend is being terminated or the
        calling role has privileges of <literal>pg_signal_backend</literal>,
        however only superusers can terminate superuser backends.
-->
バックエンドが指定したプロセスIDを持つセッションを終了させます。
呼び出し側のロールが終了されるバックエンドのロールのメンバーであるか、<code class="literal">pg_signal_backend</code>の権限を与えられている場合に実行できます。
ただし、スーパーユーザのバックエンドはスーパーユーザのみが終了できます。
       </p>
       <p>
<!--
        If <parameter>timeout</parameter> is not specified or zero, this
        function returns <literal>true</literal> whether the process actually
        terminates or not, indicating only that the sending of the signal was
        successful.  If the <parameter>timeout</parameter> is specified (in
        milliseconds) and greater than zero, the function waits until the
        process is actually terminated or until the given time has passed. If
        the process is terminated, the function
        returns <literal>true</literal>.  On timeout, a warning is emitted and
        <literal>false</literal> is returned.
-->
<em class="parameter"><code>timeout</code></em>が与えられないか、ゼロなら、この関数はプロセスが実際に終了したかどうかに関わらず、この関数はシグナルの送付が成功したことのみを意味する<code class="literal">true</code>を返します。
<em class="parameter"><code>timeout</code></em>が指定され、ゼロよりも大きければ、この関数はプロセスが実際に終了するか、指定時間が経過するまで待ちます。
プロセスが終了したら、この関数は<code class="literal">true</code>を返します。
タイムアウトの場合は、警告が出力され、<code class="literal">false</code>が返ります。
       </p></td></tr></tbody></table></div></div><br class="table-break" /><p>
<!--
    <function>pg_cancel_backend</function> and <function>pg_terminate_backend</function>
    send signals (<systemitem>SIGINT</systemitem> or <systemitem>SIGTERM</systemitem>
    respectively) to backend processes identified by process ID.
    The process ID of an active backend can be found from
    the <structfield>pid</structfield> column of the
    <structname>pg_stat_activity</structname> view, or by listing the
    <command>postgres</command> processes on the server (using
    <application>ps</application> on Unix or the <application>Task
    Manager</application> on <productname>Windows</productname>).
    The role of an active backend can be found from the
    <structfield>usename</structfield> column of the
    <structname>pg_stat_activity</structname> view.
-->
<code class="function">pg_cancel_backend</code>と<code class="function">pg_terminate_backend</code>は（それぞれ、<span class="systemitem">SIGINT</span>または<span class="systemitem">SIGTERM</span>）シグナルをプロセス識別子で特定されたバックエンドプロセスに送ります。
使用中のバックエンドのプロセス識別子は<code class="structname">pg_stat_activity</code>ビューの<code class="structfield">pid</code>列から、もしくは、（Unixでは<span class="application">ps</span>、<span class="productname">Windows</span>では<span class="application">Task Manager</span>により）サーバ上の<code class="command">postgres</code>プロセスをリストすることで見つけられます。
実行中のバックエンドのロールは<code class="structname">pg_stat_activity</code>の<code class="structfield">usename</code>列から確認することができます。
   </p><p>
<!--
    <function>pg_log_backend_memory_contexts</function> can be used
    to log the memory contexts of a backend process. For example:
-->
バックエンドプロセスのメモリコンテキストのログを取るために<code class="function">pg_log_backend_memory_contexts</code>を利用できます。
例を示します。
</p><pre class="programlisting">
postgres=# SELECT pg_log_backend_memory_contexts(pg_backend_pid());
 pg_log_backend_memory_contexts
--------------------------------
 t
(1 row)
</pre><p>
<!--
One message for each memory context will be logged. For example:
-->
各々のメモリコンテキストについて一つのメッセージがログされます。例を示します。
</p><pre class="screen">
LOG:  logging memory contexts of PID 10377
STATEMENT:  SELECT pg_log_backend_memory_contexts(pg_backend_pid());
LOG:  level: 0; TopMemoryContext: 80800 total in 6 blocks; 14432 free (5 chunks); 66368 used
LOG:  level: 1; pgstat TabStatusArray lookup hash table: 8192 total in 1 blocks; 1408 free (0 chunks); 6784 used
LOG:  level: 1; TopTransactionContext: 8192 total in 1 blocks; 7720 free (1 chunks); 472 used
LOG:  level: 1; RowDescriptionContext: 8192 total in 1 blocks; 6880 free (0 chunks); 1312 used
LOG:  level: 1; MessageContext: 16384 total in 2 blocks; 5152 free (0 chunks); 11232 used
LOG:  level: 1; Operator class cache: 8192 total in 1 blocks; 512 free (0 chunks); 7680 used
LOG:  level: 1; smgr relation table: 16384 total in 2 blocks; 4544 free (3 chunks); 11840 used
LOG:  level: 1; TransactionAbortContext: 32768 total in 1 blocks; 32504 free (0 chunks); 264 used
...
LOG:  level: 1; ErrorContext: 8192 total in 1 blocks; 7928 free (3 chunks); 264 used
LOG:  Grand total: 1651920 bytes in 201 blocks; 622360 free (88 chunks); 1029560 used
</pre><p>
<!--
    If there are more than 100 child contexts under the same parent, the first
    100 child contexts are logged, along with a summary of the remaining contexts.
    Note that frequent calls to this function could incur significant overhead,
    because it may generate a large number of log messages.
-->
同じ親に100よりも多い子コンテキストがあると、最初の100子コンテキストがログされ、残りのコンテキストについてはサマリが付加されます。
この関数を頻繁に呼び出すと、大きなオーバーヘッドを引き起こす可能性があることに注意してください。
大量のログメッセージが生成される可能性があるからです。
   </p></div><div class="sect2" id="FUNCTIONS-ADMIN-BACKUP"><div class="titlepage"><div><div><h3 class="title">9.27.3. バックアップ制御関数 <a href="#FUNCTIONS-ADMIN-BACKUP" class="id_link">#</a></h3></div></div></div><!--
   <title>Backup Control Functions</title>
--><a id="id-1.5.8.35.5.2" class="indexterm"></a><a id="id-1.5.8.35.5.3" class="indexterm"></a><p>
<!--
    The functions shown in <xref
    linkend="functions-admin-backup-table"/> assist in making on-line backups.
    These functions cannot be executed during recovery (except
    <function>pg_backup_start</function>,
    <function>pg_backup_stop</function>,
    and <function>pg_wal_lsn_diff</function>).
-->
<a class="xref" href="functions-admin.html#FUNCTIONS-ADMIN-BACKUP-TABLE" title="表9.91 バックアップ制御関数">表 9.91</a>に示されている関数はオンラインバックアップの作成を支援します。
これらの関数はリカバリ中には実行できません(<code class="function">pg_backup_start</code>、<code class="function">pg_backup_stop</code>、<code class="function">pg_wal_lsn_diff</code>を除きます)。
   </p><p>
<!--
    For details about proper usage of these functions, see
    <xref linkend="continuous-archiving"/>.
-->
これらの関数の正しい使用方法については、<a class="xref" href="continuous-archiving.html" title="26.3. 継続的アーカイブとポイントインタイムリカバリ（PITR）">26.3</a>を参照してください。
   </p><div class="table" id="FUNCTIONS-ADMIN-BACKUP-TABLE"><p class="title"><strong>表9.91 バックアップ制御関数</strong></p><div class="table-contents"><!--
    <title>Backup Control Functions</title>
--><table class="table" summary="バックアップ制御関数" border="1"><colgroup><col /></colgroup><thead><tr><th class="func_table_entry"><p class="func_signature">
<!--
        Function
-->
関数
       </p>
       <p>
<!--
        Description
-->
説明
       </p></th></tr></thead><tbody><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.5.6.2.2.1.1.1.1" class="indexterm"></a>
        <code class="function">pg_create_restore_point</code> ( <em class="parameter"><code>name</code></em> <code class="type">text</code> )
        → <code class="returnvalue">pg_lsn</code>
       </p>
       <p>
<!--
        Creates a named marker record in the write-ahead log that can later be
        used as a recovery target, and returns the corresponding write-ahead
        log location.  The given name can then be used with
        <xref linkend="guc-recovery-target-name"/> to specify the point up to
        which recovery will proceed.  Avoid creating multiple restore points
        with the same name, since recovery will stop at the first one whose
        name matches the recovery target.
-->
先行書き込みログ中に後でリカバリターゲットとして使用できる名前付けされたマーカーレコードを作成し、関連する先行書き込みログの位置を返します。
与えられた名前はリカバリをどこまで進めるかを指定するために<a class="xref" href="runtime-config-wal.html#GUC-RECOVERY-TARGET-NAME">recovery_target_name</a>とともに利用できます。
同じ名前で複数のリストアポイントを作成するのは避けてください。リカバリターゲットが一致した最初のところでリカバリが停止するからです。
       </p>
       <p>
<!--
        This function is restricted to superusers by default, but other users
        can be granted EXECUTE to run the function.
-->
この関数はデフォルトではスーパーユーザのみ実施可能ですが、他のユーザにも関数を実行するEXECUTE権限を与えることができます。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.5.6.2.2.2.1.1.1" class="indexterm"></a>
        <code class="function">pg_current_wal_flush_lsn</code> ()
        → <code class="returnvalue">pg_lsn</code>
       </p>
       <p>
<!--
        Returns the current write-ahead log flush location (see notes below).
-->
先行書き込みログの現在のフラッシュ位置を取得します。（下の注釈を参照してください。）
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.5.6.2.2.3.1.1.1" class="indexterm"></a>
        <code class="function">pg_current_wal_insert_lsn</code> ()
        → <code class="returnvalue">pg_lsn</code>
       </p>
       <p>
<!--
        Returns the current write-ahead log insert location (see notes below).
-->
現在の先行書き込みログの挿入位置を取得します。（下の注釈を参照してください。）
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.5.6.2.2.4.1.1.1" class="indexterm"></a>
        <code class="function">pg_current_wal_lsn</code> ()
        → <code class="returnvalue">pg_lsn</code>
       </p>
       <p>
<!--
        Returns the current write-ahead log write location (see notes below).
-->
現在の先行書き込みログの書き込み位置を取得します。（下の注釈を参照してください。）
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.5.6.2.2.5.1.1.1" class="indexterm"></a>
        <code class="function">pg_backup_start</code> (
          <em class="parameter"><code>label</code></em> <code class="type">text</code>
          [<span class="optional">, <em class="parameter"><code>fast</code></em> <code class="type">boolean</code>
          </span>] )
        → <code class="returnvalue">pg_lsn</code>
       </p>
       <p>
<!--
        Prepares the server to begin an on-line backup.  The only required
        parameter is an arbitrary user-defined label for the backup.
        (Typically this would be the name under which the backup dump file
        will be stored.)
        If the optional second parameter is given as <literal>true</literal>,
        it specifies executing <function>pg_backup_start</function> as quickly
        as possible.  This forces an immediate checkpoint which will cause a
        spike in I/O operations, slowing any concurrently executing queries.
-->
サーバがオンラインバックアップを開始するのを準備します。
必須パラメータはユーザが任意に定義したバックアップラベルだけです。
（通常、格納に使用するバックアップダンプファイルにちなんだ名前が付けられます。）
オプションの2番目のパラメータが<code class="literal">true</code>として与えられると、<code class="function">pg_backup_start</code>を可能な限り素早く実行することが指定されます。
これによりI/O操作の急上昇をもたらして同時に実行中のすべての問い合わせを遅くする即時チェックポイントが強制されます。
       </p>
       <p>
<!--
        This function is restricted to superusers by default, but other users
        can be granted EXECUTE to run the function.
-->
この関数はデフォルトではスーパーユーザのみ実施可能ですが、他のユーザにも関数を実行するEXECUTE権限を与えることができます。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.5.6.2.2.6.1.1.1" class="indexterm"></a>
        <code class="function">pg_backup_stop</code> (
          [<span class="optional"><em class="parameter"><code>wait_for_archive</code></em> <code class="type">boolean</code>
          </span>] )
        → <code class="returnvalue">record</code>
        ( <em class="parameter"><code>lsn</code></em> <code class="type">pg_lsn</code>,
        <em class="parameter"><code>labelfile</code></em> <code class="type">text</code>,
        <em class="parameter"><code>spcmapfile</code></em> <code class="type">text</code> )
       </p>
       <p>
<!--
        Finishes performing an on-line backup.  The desired contents of the
        backup label file and the tablespace map file are returned as part of
        the result of the function and must be written to files in the
        backup area.  These files must not be written to the live data directory
        (doing so will cause PostgreSQL to fail to restart in the event of a
        crash).
-->
オンラインバックアップの実行を終了します。
バックアップラベルファイルとテーブル空間マップファイルの必要な内容は関数の結果の一部として返され、バックアップ領域内のファイルに書き込まれなければなりません。
これらのファイルはライブデータディレクトリに書き込まれてはなりません（ライブデータディレクトリに書き込まれるとクラッシュ時にPostgreSQLの再起動に失敗します）。
       </p>
       <p>
<!--
        There is an optional parameter of type <type>boolean</type>.
        If false, the function will return immediately after the backup is
        completed, without waiting for WAL to be archived.  This behavior is
        only useful with backup software that independently monitors WAL
        archiving.  Otherwise, WAL required to make the backup consistent might
        be missing and make the backup useless.  By default or when this
        parameter is true, <function>pg_backup_stop</function> will wait for
        WAL to be archived when archiving is enabled.  (On a standby, this
        means that it will wait only when <varname>archive_mode</varname> =
        <literal>always</literal>.  If write activity on the primary is low,
        it may be useful to run <function>pg_switch_wal</function> on the
        primary in order to trigger an immediate segment switch.)
-->
オプションで<code class="type">boolean</code>型パラメータがあります。
falseの場合、この関数はバックアップの完了後、WALがアーカイブされるのを待たずに、即座に戻ります。
この動作はWALのアーカイブを独立して監視するバックアップソフトウェアに対してのみ有用です。
それ以外の場合、バックアップを一貫性のあるものにするために必要なWALが欠けるためにバックアップが役立たなくなるかもしれません。
省略時あるいはこのパラメータがtrueのとき、アーカイブが有効なら、<code class="function">pg_backup_stop</code>はWALがアーカイブされるまで待機します。
（スタンバイでは、これはつまり<code class="varname">archive_mode</code> = <code class="literal">always</code>のときのみ待機するということです。
プライマリでの書き込み活動が少ないときは、セグメントの変更を即座に起こさせるためにプライマリで<code class="function">pg_switch_wal</code>を実行するのが有効かもしれません。）
       </p>
       <p>
<!--
        When executed on a primary, this function also creates a backup
        history file in the write-ahead log archive area.  The history file
        includes the label given to <function>pg_backup_start</function>, the
        starting and ending write-ahead log locations for the backup, and the
        starting and ending times of the backup.  After recording the ending
        location, the current write-ahead log insertion point is automatically
        advanced to the next write-ahead log file, so that the ending
        write-ahead log file can be archived immediately to complete the
        backup.
-->
プライマリで実行された場合、この関数はまた、先行書き込みログの格納領域にバックアップ履歴ファイルを作成します。
履歴ファイルには<code class="function">pg_backup_start</code>で付与されたラベル、バックアップの先行書き込みログの位置の開始位置、終了位置、バックアップ開始時刻、終了時刻が含まれます。
終了位置を記録した後、現在の先行書き込みログの挿入位置は自動的に、次の先行書き込みログファイルに進みます。
従って、終了先行書き込みログファイルをすぐにアーカイブし、バックアップを完了させることができます。
       </p>
       <p>
<!--
        The result of the function is a single record.
        The <parameter>lsn</parameter> column holds the backup's ending
        write-ahead log location (which again can be ignored).  The second
        column returns the contents of the backup label file, and the third
        column returns the contents of the tablespace map file.  These must be
        stored as part of the backup and are required as part of the restore
        process.
-->
この関数の結果は単一レコードです。
<em class="parameter"><code>lsn</code></em>列はバックアップの終了先行書き込みログの位置です（これもまた無視可能です）。
2番目の列はバックアップラベルファイルの内容を返し、3番目の列はテーブル空間マップファイルの内容を返します。
これらはバックアップの一部として保存されなければならず、リストアプロセスの一部で必要となるものです。
       </p>
       <p>
<!--
        This function is restricted to superusers by default, but other users
        can be granted EXECUTE to run the function.
-->
この関数はデフォルトではスーパーユーザのみ実施可能ですが、他のユーザにも関数を実行するEXECUTE権限を与えることができます。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.5.6.2.2.7.1.1.1" class="indexterm"></a>
        <code class="function">pg_switch_wal</code> ()
        → <code class="returnvalue">pg_lsn</code>
       </p>
       <p>
<!--
        Forces the server to switch to a new write-ahead log file, which
        allows the current file to be archived (assuming you are using
        continuous archiving).  The result is the ending write-ahead log
        location plus 1 within the just-completed write-ahead log file.  If
        there has been no write-ahead log activity since the last write-ahead
        log switch, <function>pg_switch_wal</function> does nothing and
        returns the start location of the write-ahead log file currently in
        use.
-->
サーバに対して新しい先行書き込みログファイルへ強制スイッチを行い、それによってその現在のファイルがアーカイブされるようにします。
（継続的アーカイブを利用中だと仮定します。）
結果は今ちょうど終了した先行書き込みログファイル内の終了先行書き込みログファイルの場所プラス1です。
最後の先行書き込みログファイルのスイッチ以降先行書き込みログファイル活動がなければ、<code class="function">pg_switch_wal</code>は何もせず、現在使用中の先行書き込みログファイルの先頭位置を返します。
       </p>
       <p>
<!--
        This function is restricted to superusers by default, but other users
        can be granted EXECUTE to run the function.
-->
この関数はデフォルトではスーパーユーザのみ実施可能ですが、他のユーザにも関数を実行するEXECUTE権限を与えることができます。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.5.6.2.2.8.1.1.1" class="indexterm"></a>
        <code class="function">pg_walfile_name</code> ( <em class="parameter"><code>lsn</code></em> <code class="type">pg_lsn</code> )
        → <code class="returnvalue">text</code>
       </p>
       <p>
<!--
        Converts a write-ahead log location to the name of the WAL file
        holding that location.
-->
先行書き込みログファイルの位置を、その位置を保持しているWALファイルの名前に変換します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.5.6.2.2.9.1.1.1" class="indexterm"></a>
        <code class="function">pg_walfile_name_offset</code> ( <em class="parameter"><code>lsn</code></em> <code class="type">pg_lsn</code> )
        → <code class="returnvalue">record</code>
        ( <em class="parameter"><code>file_name</code></em> <code class="type">text</code>,
        <em class="parameter"><code>file_offset</code></em> <code class="type">integer</code> )
       </p>
       <p>
<!--
        Converts a write-ahead log location to a WAL file name and byte offset
        within that file.
-->
先行書き込みログファイルの位置を、そのファイルの名前とそのファイル内のバイトオフセットに変換します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.5.6.2.2.10.1.1.1" class="indexterm"></a>
        <code class="function">pg_split_walfile_name</code> ( <em class="parameter"><code>file_name</code></em> <code class="type">text</code> )
        → <code class="returnvalue">record</code>
        ( <em class="parameter"><code>segment_number</code></em> <code class="type">numeric</code>,
        <em class="parameter"><code>timeline_id</code></em> <code class="type">bigint</code> )
       </p>
       <p>
<!--
        Extracts the sequence number and timeline ID from a WAL file
        name.
-->
《機械翻訳》WALシーケンス番号とタイムラインIDをファイル名前から抽出します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.5.6.2.2.11.1.1.1" class="indexterm"></a>
        <code class="function">pg_wal_lsn_diff</code> ( <em class="parameter"><code>lsn1</code></em> <code class="type">pg_lsn</code>, <em class="parameter"><code>lsn2</code></em> <code class="type">pg_lsn</code> )
        → <code class="returnvalue">numeric</code>
       </p>
       <p>
<!--
        Calculates the difference in bytes (<parameter>lsn1</parameter> - <parameter>lsn2</parameter>) between two write-ahead log
        locations.  This can be used
        with <structname>pg_stat_replication</structname> or some of the
        functions shown in <xref linkend="functions-admin-backup-table"/> to
        get the replication lag.
-->
2つの先行書き込みログの位置のバイト単位の差分(<em class="parameter"><code>lsn1</code></em> - <em class="parameter"><code>lsn2</code></em>)を計算します。
これは<code class="structname">pg_stat_replication</code>や<a class="xref" href="functions-admin.html#FUNCTIONS-ADMIN-BACKUP-TABLE" title="表9.91 バックアップ制御関数">表 9.91</a>内の関数でレプリケーションの遅延を取得するために使用することができます。
       </p></td></tr></tbody></table></div></div><br class="table-break" /><p>
<!--
    <function>pg_current_wal_lsn</function> displays the current write-ahead
    log write location in the same format used by the above functions.
    Similarly, <function>pg_current_wal_insert_lsn</function> displays the
    current write-ahead log insertion location
    and <function>pg_current_wal_flush_lsn</function> displays the current
    write-ahead log flush location. The insertion location is
    the <quote>logical</quote> end of the write-ahead log at any instant,
    while the write location is the end of what has actually been written out
    from the server's internal buffers, and the flush location is the last
    location known to be written to durable storage. The write location is the
    end of what can be examined from outside the server, and is usually what
    you want if you are interested in archiving partially-complete write-ahead
    log files.  The insertion and flush locations are made available primarily
    for server debugging purposes.  These are all read-only operations and do
    not require superuser permissions.
-->
<code class="function">pg_current_wal_lsn</code>は、上記の関数で使用されるのと同じ書式で現在の先行書き込みログの書き込み位置を表示します。
同様に<code class="function">pg_current_wal_insert_lsn</code>は、現在の先行書き込みログの挿入位置を表示し、<code class="function">pg_current_wal_flush_lsn</code>はトランザクションログの現在のフラッシュ位置を表示します。
挿入位置は <span class="quote">「<span class="quote">論理的</span>」</span>な任意の時点の先行書き込みログの終了位置です。
一方、書き込み位置は、サーバの内部バッファから書き出された実際の終了位置、またフラッシュ位置は永続的ストレージへの書き込みが保証される位置です。
書き込み位置はサーバ外部から検証可能なものの終端です。通常は、部分的に完了した先行書き込みログファイルのアーカイブ処理を行いたい場合に必要とされるものです。
挿入およびフラッシュ位置はサーバをデバッグする際に主に使用されます。
これらはどちらも読み取りのみの操作であり、スーパーユーザ権限を必要としません。
   </p><p>
<!--
    You can use <function>pg_walfile_name_offset</function> to extract the
    corresponding write-ahead log file name and byte offset from
    a <type>pg_lsn</type> value.  For example:
-->
<code class="function">pg_walfile_name_offset</code>を使用して、<code class="type">pg_lsn</code>値から、対応する先行書き込みログファイル名とバイトオフセットを取り出すことができます。
以下に例を示します。
</p><pre class="programlisting">
postgres=# SELECT * FROM pg_walfile_name_offset((pg_backup_stop()).lsn);
        file_name         | file_offset
--------------------------+-------------
 00000001000000000000000D |     4039624
(1 row)
</pre><p>
<!--
    Similarly, <function>pg_walfile_name</function> extracts just the write-ahead log file name.
    When the given write-ahead log location is exactly at a write-ahead log file boundary, both
    these functions return the name of the preceding write-ahead log file.
    This is usually the desired behavior for managing write-ahead log archiving
    behavior, since the preceding file is the last one that currently
    needs to be archived.
-->
同様に、<code class="function">pg_walfile_name</code>は、先行書き込みログファイル名のみを取り出します。
指定した先行書き込みログの位置が正確に先行書き込みログファイルの境界であった場合、これらの両関数は前の先行書き込みログファイルの名前を返します。
通常これは、先行書き込みログファイルのアーカイブ動作では好まれる動作です。
前のファイルが現在のアーカイブで必要とする最後のファイルであるからです。
   </p><p>
    <code class="function">pg_split_walfile_name</code> is useful to compute a
    <acronym class="acronym">LSN</acronym> from a file offset and WAL file name, for example:
</p><pre class="programlisting">
postgres=# \set file_name '000000010000000100C000AB'
postgres=# \set offset 256
postgres=# SELECT '0/0'::pg_lsn + pd.segment_number * ps.setting::int + :offset AS lsn
  FROM pg_split_walfile_name(:'file_name') pd,
       pg_show_all_settings() ps
  WHERE ps.name = 'wal_segment_size';
      lsn
---------------
 C001/AB000100
(1 row)
</pre><p>
   </p></div><div class="sect2" id="FUNCTIONS-RECOVERY-CONTROL"><div class="titlepage"><div><div><h3 class="title">9.27.4. リカバリ制御関数 <a href="#FUNCTIONS-RECOVERY-CONTROL" class="id_link">#</a></h3></div></div></div><!--
   <title>Recovery Control Functions</title>
--><p>
<!--
    The functions shown in <xref
    linkend="functions-recovery-info-table"/> provide information
    about the current status of a standby server.
    These functions may be executed both during recovery and in normal running.
-->
<a class="xref" href="functions-admin.html#FUNCTIONS-RECOVERY-INFO-TABLE" title="表9.92 リカバリ情報関数">表 9.92</a>に示される関数は、スタンバイサーバの現在のステータス情報を提供します。
これらの関数はリカバリ中、および通常稼働時に実行することができるでしょう。
   </p><div class="table" id="FUNCTIONS-RECOVERY-INFO-TABLE"><p class="title"><strong>表9.92 リカバリ情報関数</strong></p><div class="table-contents"><!--
    <title>Recovery Information Functions</title>
--><table class="table" summary="リカバリ情報関数" border="1"><colgroup><col /></colgroup><thead><tr><th class="func_table_entry"><p class="func_signature">
<!--
        Function
-->
関数
       </p>
       <p>
<!--
        Description
-->
説明
       </p></th></tr></thead><tbody><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.6.3.2.2.1.1.1.1" class="indexterm"></a>
        <code class="function">pg_is_in_recovery</code> ()
        → <code class="returnvalue">boolean</code>
       </p>
       <p>
<!--
        Returns true if recovery is still in progress.
-->
まだリカバリ実施中であれば真を返します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.6.3.2.2.2.1.1.1" class="indexterm"></a>
        <code class="function">pg_last_wal_receive_lsn</code> ()
        → <code class="returnvalue">pg_lsn</code>
       </p>
       <p>
<!--
        Returns the last write-ahead log location that has been received and
        synced to disk by streaming replication. While streaming replication
        is in progress this will increase monotonically. If recovery has
        completed then this will remain static at the location of the last WAL
        record received and synced to disk during recovery. If streaming
        replication is disabled, or if it has not yet started, the function
        returns <literal>NULL</literal>.
-->
ストリーミングレプリケーションにより受信されディスクに同期書き込みされた、先行書き込みログの最後の位置を返します。
ストリーミングレプリケーションがまだ実行中の場合、この関数の戻り値は単調に増加します。
リカバリが完了した場合は、受信されディスクに書き込まれた最後のWALレコードの位置の値のまま変化しません。
ストリーミングレプリケーションが無効、もしくは開始されていない場合、この関数は<code class="literal">NULL</code>を返します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.6.3.2.2.3.1.1.1" class="indexterm"></a>
        <code class="function">pg_last_wal_replay_lsn</code> ()
        → <code class="returnvalue">pg_lsn</code>
       </p>
       <p>
<!--
        Returns the last write-ahead log location that has been replayed
        during recovery.  If recovery is still in progress this will increase
        monotonically.  If recovery has completed then this will remain
        static at the location of the last WAL record applied during recovery.
        When the server has been started normally without recovery, the
        function returns <literal>NULL</literal>.
-->
リカバリ中に再生された最後の先行書き込みログの位置を返します。
リカバリがまだ実行中の場合、この関数の戻り値は単調に増加します。
リカバリが完了した場合は、リカバリ時に適用された最後のWALレコードの値のまま変化しません。
サーバがリカバリ処理無しに正常に開始された場合、この関数は<code class="literal">NULL</code>を返します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.6.3.2.2.4.1.1.1" class="indexterm"></a>
        <code class="function">pg_last_xact_replay_timestamp</code> ()
        → <code class="returnvalue">timestamp with time zone</code>
       </p>
       <p>
<!--
        Returns the time stamp of the last transaction replayed during
        recovery.  This is the time at which the commit or abort WAL record
        for that transaction was generated on the primary.  If no transactions
        have been replayed during recovery, the function
        returns <literal>NULL</literal>.  Otherwise, if recovery is still in
        progress this will increase monotonically.  If recovery has completed
        then this will remain static at the time of the last transaction
        applied during recovery.  When the server has been started normally
        without recovery, the function returns <literal>NULL</literal>.
-->
リカバリ中に再生された最後のトランザクションのタイムスタンプを返します。
このタイムスタンプは、プライマリにて該当するトランザクションがコミット、もしくはアボートされた際のWALレコードが生成された時刻です。
リカバリ中に何のトランザクションも再生されていない場合、この関数は<code class="literal">NULL</code>を返します。
リカバリがまだ実行中の場合、この関数の戻り値は単調に増加します。
リカバリが完了している場合、この関数の戻り値はリカバリ中に再生した最後のトランザクションの時間のまま変化しません。
サーバがリカバリ処理無しに正常に開始された場合、この関数は<code class="literal">NULL</code>を返します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.6.3.2.2.5.1.1.1" class="indexterm"></a>
        <code class="function">pg_get_wal_resource_managers</code> ()
        → <code class="returnvalue">setof record</code>
        ( <em class="parameter"><code>rm_id</code></em> <code class="type">integer</code>,
        <em class="parameter"><code>rm_name</code></em> <code class="type">text</code>,
        <em class="parameter"><code>rm_builtin</code></em> <code class="type">boolean</code> )
       </p>
       <p>
<!--
        Returns the currently-loaded WAL resource managers in the system. The
        column <parameter>rm_builtin</parameter> indicates whether it's a
        built-in resource manager, or a custom resource manager loaded by an
        extension.
-->
システムに現在ロードされているWALリソースマネージャを返します。
列<em class="parameter"><code>rm_builtin</code></em>は、それが組み込みのリソースマネージャか、拡張によってロードされたカスタムリソースマネージャかを示します。
       </p></td></tr></tbody></table></div></div><br class="table-break" /><p>
<!--
    The functions shown in <xref
    linkend="functions-recovery-control-table"/> control the progress of recovery.
    These functions may be executed only during recovery.
-->
<a class="xref" href="functions-admin.html#FUNCTIONS-RECOVERY-CONTROL-TABLE" title="表9.93 リカバリ制御関数">表 9.93</a>に示す関数は、リカバリの進行を制御する関数です。
これらの関数はリカバリ中のみ実行することが可能です。
   </p><div class="table" id="FUNCTIONS-RECOVERY-CONTROL-TABLE"><p class="title"><strong>表9.93 リカバリ制御関数</strong></p><div class="table-contents"><!--
    <title>Recovery Control Functions</title>
--><table class="table" summary="リカバリ制御関数" border="1"><colgroup><col /></colgroup><thead><tr><th class="func_table_entry"><p class="func_signature">
<!--
        Function
-->
関数
       </p>
       <p>
<!--
        Description
-->
説明
       </p></th></tr></thead><tbody><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.6.5.2.2.1.1.1.1" class="indexterm"></a>
        <code class="function">pg_is_wal_replay_paused</code> ()
        → <code class="returnvalue">boolean</code>
       </p>
       <p>
<!--
        Returns true if recovery pause is requested.
-->
リカバリの中断が要求された場合は真を返します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.6.5.2.2.2.1.1.1" class="indexterm"></a>
        <code class="function">pg_get_wal_replay_pause_state</code> ()
        → <code class="returnvalue">text</code>
       </p>
       <p>
<!--
        Returns recovery pause state.  The return values are <literal>
        not paused</literal> if pause is not requested, <literal>
        pause requested</literal> if pause is requested but recovery is
        not yet paused, and <literal>paused</literal> if the recovery is
        actually paused.
-->
リカバリの休止状態を返します。
休止が要求されていないければ、返り値は<code class="literal">not paused</code>です。
休止が要求されていてリカバリがまだ休止していなければ、返り値は<code class="literal">pause requested</code>です。
リカバリが実際に休止していれば、返り値は<code class="literal">paused</code>です。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.6.5.2.2.3.1.1.1" class="indexterm"></a>
        <code class="function">pg_promote</code> ( <em class="parameter"><code>wait</code></em> <code class="type">boolean</code> <code class="literal">DEFAULT</code> <code class="literal">true</code>, <em class="parameter"><code>wait_seconds</code></em> <code class="type">integer</code> <code class="literal">DEFAULT</code> <code class="literal">60</code> )
        → <code class="returnvalue">boolean</code>
       </p>
       <p>
<!--
        Promotes a standby server to primary status.
        With <parameter>wait</parameter> set to <literal>true</literal> (the
        default), the function waits until promotion is completed
        or <parameter>wait_seconds</parameter> seconds have passed, and
        returns <literal>true</literal> if promotion is successful
        and <literal>false</literal> otherwise.
        If <parameter>wait</parameter> is set to <literal>false</literal>, the
        function returns <literal>true</literal> immediately after sending a
        <literal>SIGUSR1</literal> signal to the postmaster to trigger
        promotion.
-->
スタンバイサーバをプライマリ状態に昇格します。
<em class="parameter"><code>wait</code></em>に<code class="literal">true</code>（デフォルト）を設定すると、この関数は昇格が完了するか、<em class="parameter"><code>wait_seconds</code></em>秒が経過するまで待ち、昇格に成功すれば<code class="literal">true</code>、さもなければ<code class="literal">false</code>を返します。
<em class="parameter"><code>wait</code></em>に<code class="literal">false</code>を設定すると、この関数は昇格を起こすためにpostmasterに<code class="literal">SIGUSR1</code>を送信した後、直ちに<code class="literal">true</code>を返します。
       </p>
       <p>
<!--
        This function is restricted to superusers by default, but other users
        can be granted EXECUTE to run the function.
-->
この関数はデフォルトではスーパーユーザのみ実施可能ですが、他のユーザにも関数を実行するEXECUTE権限を与えることができます。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.6.5.2.2.4.1.1.1" class="indexterm"></a>
        <code class="function">pg_wal_replay_pause</code> ()
        → <code class="returnvalue">void</code>
       </p>
       <p>
<!--
        Request to pause recovery.  A request doesn't mean that recovery stops
        right away.  If you want a guarantee that recovery is actually paused,
        you need to check for the recovery pause state returned by
        <function>pg_get_wal_replay_pause_state()</function>.  Note that
        <function>pg_is_wal_replay_paused()</function> returns whether a request
        is made.  While recovery is paused, no further database changes are applied.
        If hot standby is active, all new queries will see the same consistent
        snapshot of the database, and no further query conflicts will be generated
        until recovery is resumed.
-->
リカバリの中断を要求します。
要求しても、それは直ちにリカバリが中断することを意味しません。
リカバリが実際に中断していることを保証したければ、 <code class="function">pg_get_wal_replay_pause_state()</code>が返すリカバリ中断状態をチェックする必要があります。
<code class="function">pg_is_wal_replay_paused()</code>は要求が行われたかどうかを返すことに注意してください。
リカバリが中断している間、データベースへの変更は適用されません。
ホットスタンバイが動作中はすべての新しい問い合わせはデータベースの一貫した同じスナップショットを参照することになり、リカバリが再開するまでそれ以上の問い合わせの衝突は起きません。
       </p>
       <p>
<!--
        This function is restricted to superusers by default, but other users
        can be granted EXECUTE to run the function.
-->
デフォルトではこの関数の実行はスーパーユーザに限定されますが、他のユーザに関数を実行するEXECUTE権限を与えることができます。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.6.5.2.2.5.1.1.1" class="indexterm"></a>
        <code class="function">pg_wal_replay_resume</code> ()
        → <code class="returnvalue">void</code>
       </p>
       <p>
<!--
        Restarts recovery if it was paused.
-->
リカバリが中断中なら再開します。
       </p>
       <p>
<!--
        This function is restricted to superusers by default, but other users
        can be granted EXECUTE to run the function.
-->
デフォルトではこの関数の実行はスーパーユーザに限定されますが、他のユーザに関数を実行するEXECUTE権限を与えることができます。
       </p></td></tr></tbody></table></div></div><br class="table-break" /><p>
<!--
    <function>pg_wal_replay_pause</function> and
    <function>pg_wal_replay_resume</function> cannot be executed while
    a promotion is ongoing. If a promotion is triggered while recovery
    is paused, the paused state ends and promotion continues.
-->
<code class="function">pg_wal_replay_pause</code>と<code class="function">pg_wal_replay_resume</code>は昇格が進行中は実行できません。
リカバリ中断中に昇格が引き起こされると中断状態は終了し、昇格が継続します。
   </p><p>
<!--
    If streaming replication is disabled, the paused state may continue
    indefinitely without a problem. If streaming replication is in
    progress then WAL records will continue to be received, which will
    eventually fill available disk space, depending upon the duration of
    the pause, the rate of WAL generation and available disk space.
-->
ストリーミングレプリケーションが無効の場合、停止状態は特に問題なく永久に継続します。
ストリーミングレプリケーションの進行中は、WALレコードの受信が継続され、停止時間、WALの生成速度、ディスクの残存容量によりますが、ディスク溢れが発生する可能性があります。
   </p></div><div class="sect2" id="FUNCTIONS-SNAPSHOT-SYNCHRONIZATION"><div class="titlepage"><div><div><h3 class="title">9.27.5. スナップショット同期関数 <a href="#FUNCTIONS-SNAPSHOT-SYNCHRONIZATION" class="id_link">#</a></h3></div></div></div><!--
   <title>Snapshot Synchronization Functions</title>
--><p>
<!--
    <productname>PostgreSQL</productname> allows database sessions to synchronize their
    snapshots. A <firstterm>snapshot</firstterm> determines which data is visible to the
    transaction that is using the snapshot. Synchronized snapshots are
    necessary when two or more sessions need to see identical content in the
    database. If two sessions just start their transactions independently,
    there is always a possibility that some third transaction commits
    between the executions of the two <command>START TRANSACTION</command> commands,
    so that one session sees the effects of that transaction and the other
    does not.
-->
<span class="productname">PostgreSQL</span>はデータベースのセッションに対して、それらのスナップショットを同期させることが可能です。
<em class="firstterm">スナップショット</em>は、そのスナップショットを使用しているトランザクションにどのデータが可視かを決定します。
同期スナップショットは、2つ以上のセッションにおいて、全く同じデータベース内容を見たい場合に必要となります。
単に2つのセッションが独立してそれぞれのトランザクションを開始するだけでは、第3のトランザクションのコミットが、2つのトランザクションの<code class="command">START TRANSACTION</code>の狭間で実行され、そのため一方のトランザクションではそのコミット結果が見え、他方では見えないという可能性が常にあります。
   </p><p>
<!--
    To solve this problem, <productname>PostgreSQL</productname> allows a transaction to
    <firstterm>export</firstterm> the snapshot it is using.  As long as the exporting
    transaction remains open, other transactions can <firstterm>import</firstterm> its
    snapshot, and thereby be guaranteed that they see exactly the same view
    of the database that the first transaction sees.  But note that any
    database changes made by any one of these transactions remain invisible
    to the other transactions, as is usual for changes made by uncommitted
    transactions.  So the transactions are synchronized with respect to
    pre-existing data, but act normally for changes they make themselves.
-->
このような問題を解決するため、<span class="productname">PostgreSQL</span>ではトランザクションが使用しているスナップショットを<em class="firstterm">エクスポート</em>できるようになっています。エクスポートしたトランザクションが開かれ続けている限り、他のトランザクションがそれを<em class="firstterm">インポート</em>することができ、
そしてこれにより最初のトランザクションと正確に同じとなるデータベースの可視性を保証されます。ただし、これらの(スナップショットを共有している)トランザクションによって発生したデータベースへの変更は、コミットされていないトランザクションによる変更と同様に、(スナップショットを共有している)他のトランザクションには見えないままです。
つまり、既存データに対しては同期されますが、それら自身による変更については通常の振る舞いをします。
   </p><p>
<!--
    Snapshots are exported with the <function>pg_export_snapshot</function> function,
    shown in <xref linkend="functions-snapshot-synchronization-table"/>, and
    imported with the <xref linkend="sql-set-transaction"/> command.
-->
スナップショットは、<a class="xref" href="functions-admin.html#FUNCTIONS-SNAPSHOT-SYNCHRONIZATION-TABLE" title="表9.94 スナップショット同期関数">表 9.94</a>に示す<code class="function">pg_export_snapshot</code>関数を用いてエクスポートされ、<a class="xref" href="sql-set-transaction.html" title="SET TRANSACTION"><span class="refentrytitle">SET TRANSACTION</span></a>コマンドを用いてインポートされます。
   </p><div class="table" id="FUNCTIONS-SNAPSHOT-SYNCHRONIZATION-TABLE"><p class="title"><strong>表9.94 スナップショット同期関数</strong></p><div class="table-contents"><!--
    <title>Snapshot Synchronization Functions</title>
--><table class="table" summary="スナップショット同期関数" border="1"><colgroup><col /></colgroup><thead><tr><th class="func_table_entry"><p class="func_signature">
<!--
        Function
-->
関数
       </p>
       <p>
<!--
        Description
-->
説明
       </p></th></tr></thead><tbody><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.7.5.2.2.1.1.1.1" class="indexterm"></a>
        <code class="function">pg_export_snapshot</code> ()
        → <code class="returnvalue">text</code>
       </p>
       <p>
<!--
        Saves the transaction's current snapshot and returns
        a <type>text</type> string identifying the snapshot.  This string must
        be passed (outside the database) to clients that want to import the
        snapshot.  The snapshot is available for import only until the end of
        the transaction that exported it.
-->
現在のトランザクションのスナップショットを保存し、それを識別する<code class="type">text</code>文字列を返します。
この文字列は（データベースの外側で）スナップショットを取り込みたいクライアントに渡さなければなりません。
エクスポートしたトランザクションが終わるまでの間のみ、そのスナップショットをインポートすることができます。
       </p>
       <p>
<!--
        A transaction can export more than one snapshot, if needed.  Note that
        doing so is only useful in <literal>READ COMMITTED</literal>
        transactions, since in <literal>REPEATABLE READ</literal> and higher
        isolation levels, transactions use the same snapshot throughout their
        lifetime.  Once a transaction has exported any snapshots, it cannot be
        prepared with <xref linkend="sql-prepare-transaction"/>.
-->
必要ならばトランザクションは複数のスナップショットをエクスポートできます。
これは<code class="literal">READ COMMITTED</code>のトランザクションにおいてのみ有用であることに注意してください。
<code class="literal">REPEATABLE READ</code>およびそれ以上の分離レベルのトランザクションでは終了まで同じスナップショットを使うからです。
一旦スナップショットをエクスポートしたトランザクションでは、<a class="xref" href="sql-prepare-transaction.html" title="PREPARE TRANSACTION"><span class="refentrytitle">PREPARE TRANSACTION</span></a>による準備を使用することができなくなります。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.7.5.2.2.2.1.1.1" class="indexterm"></a>
        <code class="function">pg_log_standby_snapshot</code> ()
        → <code class="returnvalue">pg_lsn</code>
       </p>
       <p>
<!--
        Take a snapshot of running transactions and write it to WAL, without
        having to wait for bgwriter or checkpointer to log one. This is useful
        for logical decoding on standby, as logical slot creation has to wait
        until such a record is replayed on the standby.
-->
《機械翻訳》snapshot 1へのbgwriterやcheckpointerを待たずに、実行中のトランザクションのログを取得し、それをWALに書き込みます。
これは、スタンバイのロジカルデコーディングに対して便利です。
ロジカルのスロットの作成は、このようなレコードがスタンバイで再生されるまで待たなければならないからです。
       </p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="FUNCTIONS-REPLICATION"><div class="titlepage"><div><div><h3 class="title">9.27.6. レプリケーション管理関数 <a href="#FUNCTIONS-REPLICATION" class="id_link">#</a></h3></div></div></div><!--
   <title>Replication Management Functions</title>
--><p>
<!--
    The functions shown
    in <xref linkend="functions-replication-table"/> are for
    controlling and interacting with replication features.
    See <xref linkend="streaming-replication"/>,
    <xref linkend="streaming-replication-slots"/>, and
    <xref linkend="replication-origins"/>
    for information about the underlying features.
    Use of functions for replication origin is only allowed to the
    superuser by default, but may be allowed to other users by using the
    <literal>GRANT</literal> command.
    Use of functions for replication slots is restricted to superusers
    and users having <literal>REPLICATION</literal> privilege.
-->
<a class="xref" href="functions-admin.html#FUNCTIONS-REPLICATION-TABLE" title="表9.95 レプリケーション管理関数">表 9.95</a>に示す関数はレプリケーション機能を制御したり、情報を取得したりするためのものです。
基盤となっている機能の情報に関しては<a class="xref" href="warm-standby.html#STREAMING-REPLICATION" title="27.2.5. ストリーミングレプリケーション">27.2.5</a>、<a class="xref" href="warm-standby.html#STREAMING-REPLICATION-SLOTS" title="27.2.6. レプリケーションスロット">27.2.6</a>、<a class="xref" href="replication-origins.html" title="第50章 レプリケーション進捗の追跡">第50章</a>を参照してください。
これらの関数のレプリケーションオリジンでの使用はデフォルトでスーパーユーザにのみ許可されていますが、<code class="literal">GRANT</code>コマンドを使って他のユーザに許可することもできます。
これらの関数のレプリケーションスロットでの使用はスーパーユーザと<code class="literal">REPLICATION</code>権限を持つユーザに限定されています。
   </p><p>
<!--
    Many of these functions have equivalent commands in the replication
    protocol; see <xref linkend="protocol-replication"/>.
-->
これらの関数の多くには、レプリケーションプロトコルに等価なコマンドがあります。
<a class="xref" href="protocol-replication.html" title="55.4. ストリーミングレプリケーションプロトコル">55.4</a>を参照してください。
   </p><p>
<!--
    The functions described in
    <xref linkend="functions-admin-backup"/>,
    <xref linkend="functions-recovery-control"/>, and
    <xref linkend="functions-snapshot-synchronization"/>
    are also relevant for replication.
-->
<a class="xref" href="functions-admin.html#FUNCTIONS-ADMIN-BACKUP" title="9.27.3. バックアップ制御関数">9.27.3</a>、<a class="xref" href="functions-admin.html#FUNCTIONS-RECOVERY-CONTROL" title="9.27.4. リカバリ制御関数">9.27.4</a>、<a class="xref" href="functions-admin.html#FUNCTIONS-SNAPSHOT-SYNCHRONIZATION" title="9.27.5. スナップショット同期関数">9.27.5</a>に書かれている関数もレプリケーションに関係するものです。
   </p><div class="table" id="FUNCTIONS-REPLICATION-TABLE"><p class="title"><strong>表9.95 レプリケーション管理関数</strong></p><div class="table-contents"><!--
    <title>Replication Management Functions</title>
--><table class="table" summary="レプリケーション管理関数" border="1"><colgroup><col /></colgroup><thead><tr><th class="func_table_entry"><p class="func_signature">
<!--
        Function
-->
関数
       </p>
       <p>
<!--
        Description
-->
説明
       </p></th></tr></thead><tbody><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.8.5.2.2.1.1.1.1" class="indexterm"></a>
        <code class="function">pg_create_physical_replication_slot</code> ( <em class="parameter"><code>slot_name</code></em> <code class="type">name</code> [<span class="optional">, <em class="parameter"><code>immediately_reserve</code></em> <code class="type">boolean</code>, <em class="parameter"><code>temporary</code></em> <code class="type">boolean</code> </span>] )
        → <code class="returnvalue">record</code>
        ( <em class="parameter"><code>slot_name</code></em> <code class="type">name</code>,
        <em class="parameter"><code>lsn</code></em> <code class="type">pg_lsn</code> )
       </p>
       <p>
<!--
        Creates a new physical replication slot named
        <parameter>slot_name</parameter>. The optional second parameter,
        when <literal>true</literal>, specifies that the <acronym>LSN</acronym> for this
        replication slot be reserved immediately; otherwise
        the <acronym>LSN</acronym> is reserved on first connection from a streaming
        replication client. Streaming changes from a physical slot is only
        possible with the streaming-replication protocol &mdash;
        see <xref linkend="protocol-replication"/>. The optional third
        parameter, <parameter>temporary</parameter>, when set to true, specifies that
        the slot should not be permanently stored to disk and is only meant
        for use by the current session. Temporary slots are also
        released upon any error. This function corresponds
        to the replication protocol command <literal>CREATE_REPLICATION_SLOT
        ... PHYSICAL</literal>.
-->
<em class="parameter"><code>slot_name</code></em>という名前の新しい物理レプリケーションスロットを作成します。
2番目のパラメータはオプションで、<code class="literal">true</code>の場合、このレプリケーションスロットの<acronym class="acronym">LSN</acronym>が即座に予約されることを指定します。
それ以外の場合は<acronym class="acronym">LSN</acronym>はストリーミングレプリケーションのクライアントから最初に接続された時に予約されます。
物理スロットからのストリーミングの変更はストリーミングレプリケーションプロトコルでのみ可能です。<a class="xref" href="protocol-replication.html" title="55.4. ストリーミングレプリケーションプロトコル">55.4</a>を参照してください。
3番目のパラメータ<em class="parameter"><code>temporary</code></em>はオプションで、trueに設定されるとそのスロットは永続的にディスクに保存されるものではなく、現在のセッションによってのみ用いられることを意図していることを指定します。
一時的なスロットはエラーが発生したときも解放されます。
この関数の呼び出しは、レプリケーションプロトコルコマンド<code class="literal">CREATE_REPLICATION_SLOT ... PHYSICAL</code>と同じ効果があります。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.8.5.2.2.2.1.1.1" class="indexterm"></a>
        <code class="function">pg_drop_replication_slot</code> ( <em class="parameter"><code>slot_name</code></em> <code class="type">name</code> )
        → <code class="returnvalue">void</code>
       </p>
       <p>
<!--
        Drops the physical or logical replication slot
        named <parameter>slot_name</parameter>. Same as replication protocol
        command <literal>DROP_REPLICATION_SLOT</literal>. For logical slots, this must
        be called while connected to the same database the slot was created on.
-->
<em class="parameter"><code>slot_name</code></em>という名前の物理もしくは論理レプリケーションスロットを削除します。
レプリケーションプロトコルコマンド<code class="literal">DROP_REPLICATION_SLOT</code>と同じです。
論理スロットの場合、この関数はスロットが作成されたのと同じデータベースに接続している時に呼ばなければなりません。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.8.5.2.2.3.1.1.1" class="indexterm"></a>
        <code class="function">pg_create_logical_replication_slot</code> ( <em class="parameter"><code>slot_name</code></em> <code class="type">name</code>, <em class="parameter"><code>plugin</code></em> <code class="type">name</code> [<span class="optional">, <em class="parameter"><code>temporary</code></em> <code class="type">boolean</code>, <em class="parameter"><code>twophase</code></em> <code class="type">boolean</code> </span>] )
        → <code class="returnvalue">record</code>
        ( <em class="parameter"><code>slot_name</code></em> <code class="type">name</code>,
        <em class="parameter"><code>lsn</code></em> <code class="type">pg_lsn</code> )
       </p>
       <p>
<!--
        Creates a new logical (decoding) replication slot named
        <parameter>slot_name</parameter> using the output plugin
        <parameter>plugin</parameter>. The optional third
        parameter, <parameter>temporary</parameter>, when set to true, specifies that
        the slot should not be permanently stored to disk and is only meant
        for use by the current session. Temporary slots are also
        released upon any error. The optional fourth parameter,
        <parameter>twophase</parameter>, when set to true, specifies
        that the decoding of prepared transactions is enabled for this
        slot. A call to this function has the same effect as the replication
        protocol command <literal>CREATE_REPLICATION_SLOT ... LOGICAL</literal>.
-->
出力プラグイン<em class="parameter"><code>plugin</code></em>を使って<em class="parameter"><code>slot_name</code></em>という名前の新しい論理（デコーディング）レプリケーションスロットを作ります。
3番目のオプションパラメータ<em class="parameter"><code>temporary</code></em>をtrueに設定すると、このスロットを永続的にディスクに保存するべきではなく、現在のセッションでのみ使われることを意図します。
また、一時スロットはエラーが起きると解放されます。
オプションの4つ目の引数<em class="parameter"><code>twophase</code></em>がtrueならば、準備されたトランザクションのデコードがこのスロットで可能になります。
この関数の呼び出しはレプリケーションプロトコルコマンドの<code class="literal">CREATE_REPLICATION_SLOT ... LOGICAL</code>と同じ効果があります。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.8.5.2.2.4.1.1.1" class="indexterm"></a>
        <code class="function">pg_copy_physical_replication_slot</code> ( <em class="parameter"><code>src_slot_name</code></em> <code class="type">name</code>, <em class="parameter"><code>dst_slot_name</code></em> <code class="type">name</code> [<span class="optional">, <em class="parameter"><code>temporary</code></em> <code class="type">boolean</code> </span>] )
        → <code class="returnvalue">record</code>
        ( <em class="parameter"><code>slot_name</code></em> <code class="type">name</code>,
        <em class="parameter"><code>lsn</code></em> <code class="type">pg_lsn</code> )
       </p>
       <p>
<!--
        Copies an existing physical replication slot named <parameter>src_slot_name</parameter>
        to a physical replication slot named <parameter>dst_slot_name</parameter>.
        The copied physical slot starts to reserve WAL from the same <acronym>LSN</acronym> as the
        source slot.
        <parameter>temporary</parameter> is optional. If <parameter>temporary</parameter>
        is omitted, the same value as the source slot is used.
-->
<em class="parameter"><code>src_slot_name</code></em>という名前の既存の物理レプリケーションスロットを<em class="parameter"><code>dst_slot_name</code></em>という名前の物理レプリケーションスロットにコピーします。
コピーされた物理スロットはソーススロットと同じ<acronym class="acronym">LSN</acronym>からWALの保存を開始します。
<em class="parameter"><code>temporary</code></em>はオプションです。
<em class="parameter"><code>temporary</code></em>を省略すると、ソーススロットと同じ値を使用します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.8.5.2.2.5.1.1.1" class="indexterm"></a>
        <code class="function">pg_copy_logical_replication_slot</code> ( <em class="parameter"><code>src_slot_name</code></em> <code class="type">name</code>, <em class="parameter"><code>dst_slot_name</code></em> <code class="type">name</code> [<span class="optional">, <em class="parameter"><code>temporary</code></em> <code class="type">boolean</code> [<span class="optional">, <em class="parameter"><code>plugin</code></em> <code class="type">name</code> </span>]</span>] )
        → <code class="returnvalue">record</code>
        ( <em class="parameter"><code>slot_name</code></em> <code class="type">name</code>,
        <em class="parameter"><code>lsn</code></em> <code class="type">pg_lsn</code> )
       </p>
       <p>
<!--
        Copies an existing logical replication slot
        named <parameter>src_slot_name</parameter> to a logical replication
        slot named <parameter>dst_slot_name</parameter>, optionally changing
        the output plugin and persistence.  The copied logical slot starts
        from the same <acronym>LSN</acronym> as the source logical slot.  Both
        <parameter>temporary</parameter> and <parameter>plugin</parameter> are
        optional; if they are omitted, the values of the source slot are used.
-->
<em class="parameter"><code>src_slot_name</code></em>という名前の既存の論理レプリケーションスロットを<em class="parameter"><code>dst_slot_name</code></em>という名前の論理レプリケーションスロットにコピーします。オプションで出力プラグインと永続性を変更します。
コピーされた論理スロットはソース論理スロットと同じ<acronym class="acronym">LSN</acronym>から開始します。
<em class="parameter"><code>temporary</code></em>と<em class="parameter"><code>plugin</code></em>はどちらもオプションです。
省略するとソース論理スロットと同じ値が使用されます。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.8.5.2.2.6.1.1.1" class="indexterm"></a>
        <code class="function">pg_logical_slot_get_changes</code> ( <em class="parameter"><code>slot_name</code></em> <code class="type">name</code>, <em class="parameter"><code>upto_lsn</code></em> <code class="type">pg_lsn</code>, <em class="parameter"><code>upto_nchanges</code></em> <code class="type">integer</code>, <code class="literal">VARIADIC</code> <em class="parameter"><code>options</code></em> <code class="type">text[]</code> )
        → <code class="returnvalue">setof record</code>
        ( <em class="parameter"><code>lsn</code></em> <code class="type">pg_lsn</code>,
        <em class="parameter"><code>xid</code></em> <code class="type">xid</code>,
        <em class="parameter"><code>data</code></em> <code class="type">text</code> )
       </p>
       <p>
<!--
        Returns changes in the slot <parameter>slot_name</parameter>, starting
        from the point from which changes have been consumed last.  If
        <parameter>upto_lsn</parameter>
        and <parameter>upto_nchanges</parameter> are NULL,
        logical decoding will continue until end of WAL.  If
        <parameter>upto_lsn</parameter> is non-NULL, decoding will include only
        those transactions which commit prior to the specified LSN.  If
        <parameter>upto_nchanges</parameter> is non-NULL, decoding will
        stop when the number of rows produced by decoding exceeds
        the specified value.  Note, however, that the actual number of
        rows returned may be larger, since this limit is only checked after
        adding the rows produced when decoding each new transaction commit.
-->
変更が最後に消費された時点から開始して、スロット<em class="parameter"><code>slot_name</code></em>の変更を返します。
<em class="parameter"><code>upto_lsn</code></em>と<em class="parameter"><code>upto_nchanges</code></em>がNULLならば論理デコードはWALの最後まで続きます。
<em class="parameter"><code>upto_lsn</code></em>が非NULLであれば、デコードは指定されたLSNより前にコミットされたトランザクションのみを含みます。
<em class="parameter"><code>upto_nchanges</code></em>が非NULLであれば、デコードにより生成された行の数が指定された値を越えたときに、デコードは止まります。
しかしながら、新しいトランザクションの各コミットをデコードして生成された行を追加した後でしかこの制限は確認されませんので、実際に返される行の数は大きいかもしれないことに注意してください。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.8.5.2.2.7.1.1.1" class="indexterm"></a>
        <code class="function">pg_logical_slot_peek_changes</code> ( <em class="parameter"><code>slot_name</code></em> <code class="type">name</code>, <em class="parameter"><code>upto_lsn</code></em> <code class="type">pg_lsn</code>, <em class="parameter"><code>upto_nchanges</code></em> <code class="type">integer</code>, <code class="literal">VARIADIC</code> <em class="parameter"><code>options</code></em> <code class="type">text[]</code> )
        → <code class="returnvalue">setof record</code>
        ( <em class="parameter"><code>lsn</code></em> <code class="type">pg_lsn</code>,
        <em class="parameter"><code>xid</code></em> <code class="type">xid</code>,
         <em class="parameter"><code>data</code></em> <code class="type">text</code> )
       </p>
       <p>
<!--
        Behaves just like
        the <function>pg_logical_slot_get_changes()</function> function,
        except that changes are not consumed; that is, they will be returned
        again on future calls.
-->
変更が消費されないということを除いて、<code class="function">pg_logical_slot_get_changes()</code>関数と同じように振る舞います。すなわち、将来の呼び出しでは再び同じものが返ります。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.8.5.2.2.8.1.1.1" class="indexterm"></a>
        <code class="function">pg_logical_slot_get_binary_changes</code> ( <em class="parameter"><code>slot_name</code></em> <code class="type">name</code>, <em class="parameter"><code>upto_lsn</code></em> <code class="type">pg_lsn</code>, <em class="parameter"><code>upto_nchanges</code></em> <code class="type">integer</code>, <code class="literal">VARIADIC</code> <em class="parameter"><code>options</code></em> <code class="type">text[]</code> )
        → <code class="returnvalue">setof record</code>
        ( <em class="parameter"><code>lsn</code></em> <code class="type">pg_lsn</code>,
        <em class="parameter"><code>xid</code></em> <code class="type">xid</code>,
        <em class="parameter"><code>data</code></em> <code class="type">bytea</code> )
       </p>
       <p>
<!--
        Behaves just like
        the <function>pg_logical_slot_get_changes()</function> function,
        except that changes are returned as <type>bytea</type>.
-->
変更は<code class="type">bytea</code>として返されるということを除いて<code class="function">pg_logical_slot_get_changes()</code>関数と同じように振る舞います。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.8.5.2.2.9.1.1.1" class="indexterm"></a>
        <code class="function">pg_logical_slot_peek_binary_changes</code> ( <em class="parameter"><code>slot_name</code></em> <code class="type">name</code>, <em class="parameter"><code>upto_lsn</code></em> <code class="type">pg_lsn</code>, <em class="parameter"><code>upto_nchanges</code></em> <code class="type">integer</code>, <code class="literal">VARIADIC</code> <em class="parameter"><code>options</code></em> <code class="type">text[]</code> )
        → <code class="returnvalue">setof record</code>
        ( <em class="parameter"><code>lsn</code></em> <code class="type">pg_lsn</code>,
        <em class="parameter"><code>xid</code></em> <code class="type">xid</code>,
        <em class="parameter"><code>data</code></em> <code class="type">bytea</code> )
       </p>
       <p>
<!--
        Behaves just like
        the <function>pg_logical_slot_peek_changes()</function> function,
        except that changes are returned as <type>bytea</type>.
-->
変更は<code class="type">bytea</code>として返されることを除いて<code class="function">pg_logical_slot_peek_changes()</code>関数と同じように振る舞います。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.8.5.2.2.10.1.1.1" class="indexterm"></a>
        <code class="function">pg_replication_slot_advance</code> ( <em class="parameter"><code>slot_name</code></em> <code class="type">name</code>, <em class="parameter"><code>upto_lsn</code></em> <code class="type">pg_lsn</code> )
        → <code class="returnvalue">record</code>
        ( <em class="parameter"><code>slot_name</code></em> <code class="type">name</code>,
        <em class="parameter"><code>end_lsn</code></em> <code class="type">pg_lsn</code> )
       </p>
       <p>
<!--
        Advances the current confirmed position of a replication slot named
        <parameter>slot_name</parameter>. The slot will not be moved backwards,
        and it will not be moved beyond the current insert location. Returns
        the name of the slot and the actual position that it was advanced to.
        The updated slot position information is written out at the next
        checkpoint if any advancing is done. So in the event of a crash, the
        slot may return to an earlier position.
-->
<em class="parameter"><code>slot_name</code></em>という名前のレプリケーションスロットの現在の確認された位置を進めます。
スロットは後方には動きませんし、現在の挿入位置を超えて進むこともありません。
スロットの名前と前に進んだ実際の位置を返します。
前に進んだ場合は更新されたスロットに関する情報がこの後のチェックポイントで書き出されます。
クラッシュが発生すると、そのスロットは以前の位置に戻るかもしれません。
       </p></td></tr><tr><td id="PG-REPLICATION-ORIGIN-CREATE" class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.8.5.2.2.11.1.1.1" class="indexterm"></a>
        <code class="function">pg_replication_origin_create</code> ( <em class="parameter"><code>node_name</code></em> <code class="type">text</code> )
        → <code class="returnvalue">oid</code>
       </p>
       <p>
<!--
        Creates a replication origin with the given external
        name, and returns the internal ID assigned to it.
-->
指定した外部名でレプリケーション起点を作成し、割り当てられた内部IDを返します。
       </p></td></tr><tr><td id="PG-REPLICATION-ORIGIN-DROP" class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.8.5.2.2.12.1.1.1" class="indexterm"></a>
        <code class="function">pg_replication_origin_drop</code> ( <em class="parameter"><code>node_name</code></em> <code class="type">text</code> )
        → <code class="returnvalue">void</code>
       </p>
       <p>
<!--
        Deletes a previously-created replication origin, including any
        associated replay progress.
-->
以前に作成されたレプリケーション起点を、それに関連するすべての再生の進捗も含めて削除します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.8.5.2.2.13.1.1.1" class="indexterm"></a>
        <code class="function">pg_replication_origin_oid</code> ( <em class="parameter"><code>node_name</code></em> <code class="type">text</code> )
        → <code class="returnvalue">oid</code>
       </p>
       <p>
<!--
        Looks up a replication origin by name and returns the internal ID. If
        no such replication origin is found, <literal>NULL</literal> is
        returned.
-->
レプリケーション起点を名前で検索し、内部IDを返します。
相当するレプリケーション起点が見つからない場合は<code class="literal">NULL</code>を返します。
       </p></td></tr><tr><td id="PG-REPLICATION-ORIGIN-SESSION-SETUP" class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.8.5.2.2.14.1.1.1" class="indexterm"></a>
        <code class="function">pg_replication_origin_session_setup</code> ( <em class="parameter"><code>node_name</code></em> <code class="type">text</code> )
        → <code class="returnvalue">void</code>
       </p>
       <p>
<!--
        Marks the current session as replaying from the given
        origin, allowing replay progress to be tracked.
        Can only be used if no origin is currently selected.
        Use <function>pg_replication_origin_session_reset</function> to undo.
-->
現在のセッションに、指定の起点から再生中であると印を付け、再生の進捗が追跡できるようにします。
起点が選択されていない場合にのみ使うことができます。
元に戻すには<code class="function">pg_replication_origin_session_reset</code>を使って下さい。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.8.5.2.2.15.1.1.1" class="indexterm"></a>
        <code class="function">pg_replication_origin_session_reset</code> ()
        → <code class="returnvalue">void</code>
       </p>
       <p>
<!--
        Cancels the effects
        of <function>pg_replication_origin_session_setup()</function>.
-->
<code class="function">pg_replication_origin_session_setup()</code>の効果を取り消します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.8.5.2.2.16.1.1.1" class="indexterm"></a>
        <code class="function">pg_replication_origin_session_is_setup</code> ()
        → <code class="returnvalue">boolean</code>
       </p>
       <p>
<!--
        Returns true if a replication origin has been selected in the
        current session.
-->
現在のセッションでレプリケーション起点が選択されていれば真を返します。
       </p></td></tr><tr><td id="PG-REPLICATION-ORIGIN-SESSION-PROGRESS" class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.8.5.2.2.17.1.1.1" class="indexterm"></a>
        <code class="function">pg_replication_origin_session_progress</code> ( <em class="parameter"><code>flush</code></em> <code class="type">boolean</code> )
        → <code class="returnvalue">pg_lsn</code>
       </p>
       <p>
<!--
        Returns the replay location for the replication origin selected in
        the current session. The parameter <parameter>flush</parameter>
        determines whether the corresponding local transaction will be
        guaranteed to have been flushed to disk or not.
-->
現在のセッションで設定されたレプリケーション起点の再生位置を返します。
パラメータ<em class="parameter"><code>flush</code></em>により、対応するローカルトランザクションがディスクにフラッシュされていることが保証されるかどうかを決定します。
       </p></td></tr><tr><td id="PG-REPLICATION-ORIGIN-XACT-SETUP" class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.8.5.2.2.18.1.1.1" class="indexterm"></a>
        <code class="function">pg_replication_origin_xact_setup</code> ( <em class="parameter"><code>origin_lsn</code></em> <code class="type">pg_lsn</code>, <em class="parameter"><code>origin_timestamp</code></em> <code class="type">timestamp with time zone</code> )
        → <code class="returnvalue">void</code>
       </p>
       <p>
<!--
        Marks the current transaction as replaying a transaction that has
        committed at the given <acronym>LSN</acronym> and timestamp. Can
        only be called when a replication origin has been selected
        using <function>pg_replication_origin_session_setup</function>.
-->
現在のトランザクションに、指定の<acronym class="acronym">LSN</acronym>およびタイムスタンプでコミットしたトランザクションを再生中であると印をつけます。
事前にレプリケーション起点が<code class="function">pg_replication_origin_session_setup</code>を使って選択されている場合にのみ呼び出せます。
       </p></td></tr><tr><td id="PG-REPLICATION-ORIGIN-XACT-RESET" class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.8.5.2.2.19.1.1.1" class="indexterm"></a>
        <code class="function">pg_replication_origin_xact_reset</code> ()
        → <code class="returnvalue">void</code>
       </p>
       <p>
<!--
        Cancels the effects of
        <function>pg_replication_origin_xact_setup()</function>.
-->
<code class="function">pg_replication_origin_xact_setup()</code>の効果を取り消します。
       </p></td></tr><tr><td id="PG-REPLICATION-ORIGIN-ADVANCE" class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.8.5.2.2.20.1.1.1" class="indexterm"></a>
        <code class="function">pg_replication_origin_advance</code> ( <em class="parameter"><code>node_name</code></em> <code class="type">text</code>, <em class="parameter"><code>lsn</code></em> <code class="type">pg_lsn</code> )
        → <code class="returnvalue">void</code>
       </p>
       <p>
<!--
        Sets replication progress for the given node to the given
        location. This is primarily useful for setting up the initial
        location, or setting a new location after configuration changes and
        similar. Be aware that careless use of this function can lead to
        inconsistently replicated data.
-->
指定したノードのレプリケーションの進捗を、指定の位置に設定します。
これは主に設定変更の後で初期位置や新しい位置を設定するときなどに役立ちます。
この関数を不注意に使うと、レプリケーションデータが一貫性を失うかもしれないことに注意して下さい。
       </p></td></tr><tr><td id="PG-REPLICATION-ORIGIN-PROGRESS" class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.8.5.2.2.21.1.1.1" class="indexterm"></a>
        <code class="function">pg_replication_origin_progress</code> ( <em class="parameter"><code>node_name</code></em> <code class="type">text</code>, <em class="parameter"><code>flush</code></em> <code class="type">boolean</code> )
        → <code class="returnvalue">pg_lsn</code>
       </p>
       <p>
<!--
        Returns the replay location for the given replication origin. The
        parameter <parameter>flush</parameter> determines whether the
        corresponding local transaction will be guaranteed to have been
        flushed to disk or not.
-->
指定したレプリケーション起点の再生位置を返します。
パラメータ<em class="parameter"><code>flush</code></em>により、対応するローカルトランザクションがディスクにフラッシュされていることが保証されるかどうかを決定します。
       </p></td></tr><tr><td id="PG-LOGICAL-EMIT-MESSAGE" class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.8.5.2.2.22.1.1.1" class="indexterm"></a>
        <code class="function">pg_logical_emit_message</code> ( <em class="parameter"><code>transactional</code></em> <code class="type">boolean</code>, <em class="parameter"><code>prefix</code></em> <code class="type">text</code>, <em class="parameter"><code>content</code></em> <code class="type">text</code> )
        → <code class="returnvalue">pg_lsn</code>
       </p>
       <p class="func_signature">
        <code class="function">pg_logical_emit_message</code> ( <em class="parameter"><code>transactional</code></em> <code class="type">boolean</code>, <em class="parameter"><code>prefix</code></em> <code class="type">text</code>, <em class="parameter"><code>content</code></em> <code class="type">bytea</code> )
        → <code class="returnvalue">pg_lsn</code>
       </p>
       <p>
<!--
        Emits a logical decoding message. This can be used to pass generic
        messages to logical decoding plugins through
        WAL. The <parameter>transactional</parameter> parameter specifies if
        the message should be part of the current transaction, or if it should
        be written immediately and decoded as soon as the logical decoder
        reads the record. The <parameter>prefix</parameter> parameter is a
        textual prefix that can be used by logical decoding plugins to easily
        recognize messages that are interesting for them.
        The <parameter>content</parameter> parameter is the content of the
        message, given either in text or binary form.
-->
論理デコードのメッセージを送出します
これは汎用的なメッセージをWALを通して論理デコードのプラグインに渡すのに使うことができます。
パラメータ<em class="parameter"><code>transactional</code></em>は、メッセージが現在のトランザクションの一部なのか、あるいはすぐに書き込み、論理デコードがレコードを読んだらすぐにデコードされるべきものなのかを指定します。
<em class="parameter"><code>prefix</code></em>パラメータは文字通りの接頭辞で、論理デコードのプラグインが、自分にとって関心のあるメッセージを容易に認識できるように使われます。
<em class="parameter"><code>content</code></em>パラメータはメッセージの内容で、テキストまたはバイナリ形式で与えられます。
       </p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="FUNCTIONS-ADMIN-DBOBJECT"><div class="titlepage"><div><div><h3 class="title">9.27.7. データベースオブジェクト管理関数 <a href="#FUNCTIONS-ADMIN-DBOBJECT" class="id_link">#</a></h3></div></div></div><!--
   <title>Database Object Management Functions</title>
--><p>
<!--
    The functions shown in <xref linkend="functions-admin-dbsize"/> calculate
    the disk space usage of database objects, or assist in presentation
    or understanding of usage results.  <literal>bigint</literal> results
    are measured in bytes.  If an OID that does
    not represent an existing object is passed to one of these
    functions, <literal>NULL</literal> is returned.
-->
<a class="xref" href="functions-admin.html#FUNCTIONS-ADMIN-DBSIZE" title="表9.96 データベースオブジェクトサイズ関数">表 9.96</a>で示された関数はデータベースオブジェクトのディスク領域の使用状況を計算したり、使用結果の表示あるいは理解を補助します。
<code class="literal">bigint</code>の結果はバイト単位の大きさです。
関数に存在するオブジェクト以外のOIDが渡されると<code class="literal">NULL</code>が返ります。
   </p><div class="table" id="FUNCTIONS-ADMIN-DBSIZE"><p class="title"><strong>表9.96 データベースオブジェクトサイズ関数</strong></p><div class="table-contents"><!--
    <title>Database Object Size Functions</title>
--><table class="table" summary="データベースオブジェクトサイズ関数" border="1"><colgroup><col /></colgroup><thead><tr><th class="func_table_entry"><p class="func_signature">
<!--
        Function
-->
関数
       </p>
       <p>
<!--
        Description
-->
説明
       </p></th></tr></thead><tbody><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.9.3.2.2.1.1.1.1" class="indexterm"></a>
        <code class="function">pg_column_size</code> ( <code class="type">"any"</code> )
        → <code class="returnvalue">integer</code>
       </p>
       <p>
<!--
        Shows the number of bytes used to store any individual data value.  If
        applied directly to a table column value, this reflects any
        compression that was done.
-->
個々のデータ値を格納するのに使用されるバイト数を表示します。
テーブルの列の値に直接適用すると、圧縮が行われていればそれを反映します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.9.3.2.2.2.1.1.1" class="indexterm"></a>
        <code class="function">pg_column_compression</code> ( <code class="type">"any"</code> )
        → <code class="returnvalue">text</code>
       </p>
       <p>
<!--
        Shows the compression algorithm that was used to compress
        an individual variable-length value. Returns <literal>NULL</literal>
        if the value is not compressed.
-->
個々の可変長値で使われた圧縮アルゴリズムを表示します。
値が圧縮されていなければ、<code class="literal">NULL</code>を返します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.9.3.2.2.3.1.1.1" class="indexterm"></a>
        <code class="function">pg_database_size</code> ( <code class="type">name</code> )
        → <code class="returnvalue">bigint</code>
       </p>
       <p class="func_signature">
        <code class="function">pg_database_size</code> ( <code class="type">oid</code> )
        → <code class="returnvalue">bigint</code>
       </p>
       <p>
<!--
        Computes the total disk space used by the database with the specified
        name or OID.  To use this function, you must
        have <literal>CONNECT</literal> privilege on the specified database
        (which is granted by default) or have privileges of
        the <literal>pg_read_all_stats</literal> role.
-->
名前あるいはOIDで指定したデータベースによって使われている全ディスクスペースを計算します。
この関数を使うには、指定したデータベースに<code class="literal">CONNECT</code>権限（デフォルトで付与されています）を持っているか、<code class="literal">pg_read_all_stats</code>ロールの権限を持っていなければいけません。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.9.3.2.2.4.1.1.1" class="indexterm"></a>
        <code class="function">pg_indexes_size</code> ( <code class="type">regclass</code> )
        → <code class="returnvalue">bigint</code>
       </p>
       <p>
<!--
        Computes the total disk space used by indexes attached to the
        specified table.
-->
指定したテーブルに付与されたインデックスで使用されている全ディスクスペースを計算します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.9.3.2.2.5.1.1.1" class="indexterm"></a>
        <code class="function">pg_relation_size</code> ( <em class="parameter"><code>relation</code></em> <code class="type">regclass</code> [<span class="optional">, <em class="parameter"><code>fork</code></em> <code class="type">text</code> </span>] )
        → <code class="returnvalue">bigint</code>
       </p>
       <p>
<!--
        Computes the disk space used by one <quote>fork</quote> of the
        specified relation.  (Note that for most purposes it is more
        convenient to use the higher-level
        functions <function>pg_total_relation_size</function>
        or <function>pg_table_size</function>, which sum the sizes of all
        forks.)  With one argument, this returns the size of the main data
        fork of the relation.  The second argument can be provided to specify
        which fork to examine:
-->
指定したリレーションの一つの<span class="quote">「<span class="quote">fork</span>」</span>で使用されているディスクスペースを計算します。
（大抵の目的には、すべてのフォークのサイズを合計する高レベルの<code class="function">pg_total_relation_size</code>あるいは<code class="function">pg_table_size</code>を使う方が便利です。）
引数1つではリレーションの主データフォークのサイズを返します。
2番目の引数で対象となるのがどのフォークであるかを指定できます。
        </p><div class="itemizedlist"><ul class="itemizedlist compact" style="list-style-type: disc; "><li class="listitem"><p>
<!--
           <literal>main</literal> returns the size of the main
           data fork of the relation.
-->
<code class="literal">main</code>はリレーションの主データフォークのサイズを返します。
          </p></li><li class="listitem"><p>
<!--
           <literal>fsm</literal> returns the size of the Free Space Map
           (see <xref linkend="storage-fsm"/>) associated with the relation.
-->
<code class="literal">fsm</code>を指定すると、リレーションに関連した空き領域マップ(<a class="xref" href="storage-fsm.html" title="73.3. 空き領域マップ">73.3</a>を参照)のサイズを返します。
          </p></li><li class="listitem"><p>
<!--
           <literal>vm</literal> returns the size of the Visibility Map
           (see <xref linkend="storage-vm"/>) associated with the relation.
-->
<code class="literal">vm</code>を指定すると、リレーションに関連した可視性マップ(<a class="xref" href="storage-vm.html" title="73.4. 可視性マップ">73.4</a>を参照)のサイズを返します。
          </p></li><li class="listitem"><p>
<!--
           <literal>init</literal> returns the size of the initialization
           fork, if any, associated with the relation.
-->
<code class="literal">init</code>を指定すると、あれば、リレーションに関連した初期化フォークのサイズを返します。
          </p></li></ul></div><p>
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.9.3.2.2.6.1.1.1" class="indexterm"></a>
        <code class="function">pg_size_bytes</code> ( <code class="type">text</code> )
        → <code class="returnvalue">bigint</code>
       </p>
       <p>
<!--
        Converts a size in human-readable format (as returned
        by <function>pg_size_pretty</function>) into bytes.  Valid units are
        <literal>bytes</literal>, <literal>B</literal>, <literal>kB</literal>,
        <literal>MB</literal>, <literal>GB</literal>, <literal>TB</literal>,
        and <literal>PB</literal>.
-->
《マッチ度[50.694444]》16進数の桁とは<code class="literal">0</code>-<code class="literal">9</code>、<code class="literal">a</code>-<code class="literal">f</code>、<code class="literal">A</code>-<code class="literal">F</code>です。
8進数の桁とは<code class="literal">0</code>-<code class="literal">7</code>です。
《機械翻訳》(<code class="function">pg_サイズ_pretty</code>が返す人間が読めるフォーマットのサイズをバイトに変換します。
有効な値は、<code class="literal">bytes</code>,<code class="literal">B</code>,<code class="literal">キロバイト</code>,<code class="literal">メガバイト</code>,<code class="literal">ギガバイト</code>,<code class="literal">TB</code>,<code class="literal">PB</code>です。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.9.3.2.2.7.1.1.1" class="indexterm"></a>
        <code class="function">pg_size_pretty</code> ( <code class="type">bigint</code> )
        → <code class="returnvalue">text</code>
       </p>
       <p class="func_signature">
        <code class="function">pg_size_pretty</code> ( <code class="type">numeric</code> )
        → <code class="returnvalue">text</code>
       </p>
       <p>
<!--
        Converts a size in bytes into a more easily human-readable format with
        size units (bytes, kB, MB, GB, TB, or PB as appropriate).  Note that the
        units are powers of 2 rather than powers of 10, so 1kB is 1024 bytes,
        1MB is 1024<superscript>2</superscript> = 1048576 bytes, and so on.
-->
バイトサイズを、サイズ単位(バイト、kB、MB、GB、TB、PBのうちの適切なもの)を使った、より人間が読みやすい形式に変換します。
単位は10のべき乗ではなく、2のべき乗であることに注意してください。ですから1kBは1024バイトで、1MBは1024<sup>2</sup> = 1048576バイト、などとなります。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.9.3.2.2.8.1.1.1" class="indexterm"></a>
        <code class="function">pg_table_size</code> ( <code class="type">regclass</code> )
        → <code class="returnvalue">bigint</code>
       </p>
       <p>
<!--
        Computes the disk space used by the specified table, excluding indexes
        (but including its TOAST table if any, free space map, and visibility
        map).
-->
指定テーブルが使用している、インデックスを含まないディスクスペースを計算します。（ただしあればTOASTテーブル、空き領域マップ、可視性マップを含みます。）
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.9.3.2.2.9.1.1.1" class="indexterm"></a>
        <code class="function">pg_tablespace_size</code> ( <code class="type">name</code> )
        → <code class="returnvalue">bigint</code>
       </p>
       <p class="func_signature">
        <code class="function">pg_tablespace_size</code> ( <code class="type">oid</code> )
        → <code class="returnvalue">bigint</code>
       </p>
       <p>
<!--
        Computes the total disk space used in the tablespace with the
        specified name or OID. To use this function, you must
        have <literal>CREATE</literal> privilege on the specified tablespace
        or have privileges of the <literal>pg_read_all_stats</literal> role,
        unless it is the default tablespace for the current database.
-->
名前あるいはOIDで指定されたテーブル空間で使用されているディスクスペースを計算します。
現在のデータベースのデフォルトテーブル空間でない限り、この関数を使うには、指定したテーブル空間に<code class="literal">CREATE</code>権限を持っているか、<code class="literal">pg_read_all_stats</code>ロールの権限を持っていなければいけません。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.9.3.2.2.10.1.1.1" class="indexterm"></a>
        <code class="function">pg_total_relation_size</code> ( <code class="type">regclass</code> )
        → <code class="returnvalue">bigint</code>
       </p>
       <p>
<!--
        Computes the total disk space used by the specified table, including
        all indexes and <acronym>TOAST</acronym> data.  The result is
        equivalent to <function>pg_table_size</function>
        <literal>+</literal> <function>pg_indexes_size</function>.
-->
指定テーブルが使用している、インデックスと<acronym class="acronym">TOAST</acronym>データを含む全ディスクスペースを計算します。
結果は<code class="function">pg_table_size</code> <code class="literal">+</code> <code class="function">pg_indexes_size</code>と等価です。
       </p></td></tr></tbody></table></div></div><br class="table-break" /><p>
<!--
    The functions above that operate on tables or indexes accept a
    <type>regclass</type> argument, which is simply the OID of the table or index
    in the <structname>pg_class</structname> system catalog.  You do not have to look up
    the OID by hand, however, since the <type>regclass</type> data type's input
    converter will do the work for you.  See <xref linkend="datatype-oid"/>
    for details.
-->
上記の関数において、テーブルやインデックスを<code class="type">regclass</code>引数として受け取って処理するものがありますが、この引数は単に<code class="structname">pg_class</code>システムカタログにあるテーブルやインデックスのOIDです。
ただし、<code class="type">regclass</code>データ型が自動で入力変換を行うため、ユーザが手動で該当するOIDを調べる必要はありません。
詳細は<a class="xref" href="datatype-oid.html" title="8.19. オブジェクト識別子データ型">8.19</a>を参照ください。
   </p><p>
<!--
    The functions shown in <xref linkend="functions-admin-dblocation"/> assist
    in identifying the specific disk files associated with database objects.
-->
<a class="xref" href="functions-admin.html#FUNCTIONS-ADMIN-DBLOCATION" title="表9.97 データベースオブジェクト位置関数">表 9.97</a> に示される関数は、データベースオブジェクトに関連する特定のディスクファイルを確認する際の手助けとなります。
   </p><div class="table" id="FUNCTIONS-ADMIN-DBLOCATION"><p class="title"><strong>表9.97 データベースオブジェクト位置関数</strong></p><div class="table-contents"><!--
    <title>Database Object Location Functions</title>
--><table class="table" summary="データベースオブジェクト位置関数" border="1"><colgroup><col /></colgroup><thead><tr><th class="func_table_entry"><p class="func_signature">
<!--
        Function
-->
関数
       </p>
       <p>
<!--
        Description
-->
説明
       </p></th></tr></thead><tbody><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.9.6.2.2.1.1.1.1" class="indexterm"></a>
        <code class="function">pg_relation_filenode</code> ( <em class="parameter"><code>relation</code></em> <code class="type">regclass</code> )
        → <code class="returnvalue">oid</code>
       </p>
       <p>
<!--
        Returns the <quote>filenode</quote> number currently assigned to the
        specified relation.  The filenode is the base component of the file
        name(s) used for the relation (see
        <xref linkend="storage-file-layout"/> for more information).
        For most relations the result is the same as
        <structname>pg_class</structname>.<structfield>relfilenode</structfield>,
        but for certain system catalogs <structfield>relfilenode</structfield>
        is zero and this function must be used to get the correct value.  The
        function returns NULL if passed a relation that does not have storage,
        such as a view.
-->
指定されたリレーションに現在割り当てられている<span class="quote">「<span class="quote">ファイルノード</span>」</span>番号を返します。
ファイルノードは、リレーションに使用しているファイル名の基本要素です。(詳しくは<a class="xref" href="storage-file-layout.html" title="73.1. データベースファイルのレイアウト">73.1</a>を参照して下さい。)
ほとんどのリレーションについては、結果は<code class="structname">pg_class</code>.<code class="structfield">relfilenode</code>と同じになります。ただし、いくつかのシステムカタログでは<code class="structfield">relfilenode</code>がゼロになるため、これらのシステムカタログの正しいファイルノードを取得するには、この関数を使用しなければなりません。
この関数は、ビューの様にストレージに格納されないリレーションが指定された場合はNULLを返します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.9.6.2.2.2.1.1.1" class="indexterm"></a>
        <code class="function">pg_relation_filepath</code> ( <em class="parameter"><code>relation</code></em> <code class="type">regclass</code> )
        → <code class="returnvalue">text</code>
       </p>
       <p>
<!--
        Returns the entire file path name (relative to the database cluster's
        data directory, <varname>PGDATA</varname>) of the relation.
-->
リレーションのファイルパス名全体（データベースクラスタのデータディレクトリ、<code class="varname">PGDATA</code>からの相対）を返します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.9.6.2.2.3.1.1.1" class="indexterm"></a>
        <code class="function">pg_filenode_relation</code> ( <em class="parameter"><code>tablespace</code></em> <code class="type">oid</code>, <em class="parameter"><code>filenode</code></em> <code class="type">oid</code> )
        → <code class="returnvalue">regclass</code>
       </p>
       <p>
<!--
        Returns a relation's OID given the tablespace OID and filenode it is
        stored under.  This is essentially the inverse mapping of
        <function>pg_relation_filepath</function>.  For a relation in the
        database's default tablespace, the tablespace can be specified as zero.
        Returns <literal>NULL</literal> if no relation in the current database
        is associated with the given values.
-->
与えられたテーブル空間OIDとファイルノードに格納されているリレーションのOIDを返します。
これは本質的に<code class="function">pg_relation_filepath</code>の逆マッピングです。
データベースのデフォルトテーブル空間内のテーブルに対しては、テーブル空間は0と指定できます。
当たられた値に対応する現在のデータベースにリレーションがなければ<code class="literal">NULL</code>を返します。
       </p></td></tr></tbody></table></div></div><br class="table-break" /><p>
<!--
    <xref linkend="functions-admin-collation"/> lists functions used to manage
    collations.
-->
<a class="xref" href="functions-admin.html#FUNCTIONS-ADMIN-COLLATION" title="表9.98 照合順序管理関数">表 9.98</a>に照合順序の管理に使用される関数の一覧を示します。
   </p><div class="table" id="FUNCTIONS-ADMIN-COLLATION"><p class="title"><strong>表9.98 照合順序管理関数</strong></p><div class="table-contents"><!--
    <title>Collation Management Functions</title>
--><table class="table" summary="照合順序管理関数" border="1"><colgroup><col /></colgroup><thead><tr><th class="func_table_entry"><p class="func_signature">
<!--
        Function
-->
関数
       </p>
       <p>
<!--
        Description
-->
説明
       </p></th></tr></thead><tbody><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.9.8.2.2.1.1.1.1" class="indexterm"></a>
        <code class="function">pg_collation_actual_version</code> ( <code class="type">oid</code> )
        → <code class="returnvalue">text</code>
       </p>
       <p>
<!--
        Returns the actual version of the collation object as it is currently
        installed in the operating system.  If this is different from the
        value in
        <structname>pg_collation</structname>.<structfield>collversion</structfield>,
        then objects depending on the collation might need to be rebuilt.  See
        also <xref linkend="sql-altercollation"/>.
-->
オペレーティングシステムに現在インストールされている照合順序オブジェクトの実際のバージョンを返します。
これが<code class="structname">pg_collation</code>.<code class="structfield">collversion</code>と異なると、その照合順序に依存しているオブジェクトは再構築の必要があるかも知れません。
<a class="xref" href="sql-altercollation.html" title="ALTER COLLATION"><span class="refentrytitle">ALTER COLLATION</span></a>も参照してください。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.9.8.2.2.2.1.1.1" class="indexterm"></a>
        <code class="function">pg_database_collation_actual_version</code> ( <code class="type">oid</code> )
        → <code class="returnvalue">text</code>
       </p>
       <p>
<!--
        Returns the actual version of the database's collation as it is currently
        installed in the operating system.  If this is different from the
        value in
        <structname>pg_database</structname>.<structfield>datcollversion</structfield>,
        then objects depending on the collation might need to be rebuilt.  See
        also <xref linkend="sql-alterdatabase"/>.
-->
オペレーティングシステムに現在インストールされている照合順序オブジェクトの実際のバージョンを返します。
これが<code class="structname">pg_database</code>.<code class="structfield">datcollversion</code>と異なると、その照合順序に依存しているオブジェクトは再構築の必要があるかも知れません。
<a class="xref" href="sql-alterdatabase.html" title="ALTER DATABASE"><span class="refentrytitle">ALTER DATABASE</span></a>も参照してください。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.9.8.2.2.3.1.1.1" class="indexterm"></a>
        <code class="function">pg_import_system_collations</code> ( <em class="parameter"><code>schema</code></em> <code class="type">regnamespace</code> )
        → <code class="returnvalue">integer</code>
       </p>
       <p>
<!--
        Adds collations to the system
        catalog <structname>pg_collation</structname> based on all the locales
        it finds in the operating system.  This is
        what <command>initdb</command> uses; see
        <xref linkend="collation-managing"/> for more details.  If additional
        locales are installed into the operating system later on, this
        function can be run again to add collations for the new locales.
        Locales that match existing entries
        in <structname>pg_collation</structname> will be skipped.  (But
        collation objects based on locales that are no longer present in the
        operating system are not removed by this function.)
        The <parameter>schema</parameter> parameter would typically
        be <literal>pg_catalog</literal>, but that is not a requirement; the
        collations could be installed into some other schema as well.  The
        function returns the number of new collation objects it created.
        Use of this function is restricted to superusers.
-->
オペレーティングシステム上にあるすべてのロケールに基づき、システムカタログ<code class="structname">pg_collation</code>に照合順序を追加します。
これは<code class="command">initdb</code>が使用しているもので、より詳細については<a class="xref" href="collation.html#COLLATION-MANAGING" title="24.2.2. 照合順序の管理">24.2.2</a>を参照してください。
その後にオペレーティングシステムに追加のロケールをインストールした場合、この関数を再度実行して、その新しいロケールの照合順序を追加することができます。
<code class="structname">pg_collation</code>の既存のエントリにマッチするロケールはスキップされます。
（しかし、オペレーティングシステム上にもはや存在しなくなったロケールに基づく照合順序オブジェクトはこの関数では削除されません。）
<em class="parameter"><code>schema</code></em>パラメータは通常は<code class="literal">pg_catalog</code>ですが、必ずしもそうでなければならないわけではなく、照合順序をどれか他のスキーマにインストールすることもできます。
この関数は新しく作成された照合順序オブジェクトの数を返します。
この関数の利用はスーパーユーザにのみ限定されています。
       </p></td></tr></tbody></table></div></div><br class="table-break" /><p>
<!--
    <xref linkend="functions-info-partition"/> lists functions that provide
    information about the structure of partitioned tables.
-->
<a class="xref" href="functions-admin.html#FUNCTIONS-INFO-PARTITION" title="表9.99 パーティション情報関数">表 9.99</a>にパーティション化テーブルの構造に関する情報を提供する関数を示します。
   </p><div class="table" id="FUNCTIONS-INFO-PARTITION"><p class="title"><strong>表9.99 パーティション情報関数</strong></p><div class="table-contents"><!--
    <title>Partitioning Information Functions</title>
--><table class="table" summary="パーティション情報関数" border="1"><colgroup><col /></colgroup><thead><tr><th class="func_table_entry"><p class="func_signature">
<!--
        Function
-->
関数
       </p>
       <p>
<!--
        Description
-->
説明
       </p></th></tr></thead><tbody><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.9.10.2.2.1.1.1.1" class="indexterm"></a>
        <code class="function">pg_partition_tree</code> ( <code class="type">regclass</code> )
        → <code class="returnvalue">setof record</code>
        ( <em class="parameter"><code>relid</code></em> <code class="type">regclass</code>,
        <em class="parameter"><code>parentrelid</code></em> <code class="type">regclass</code>,
        <em class="parameter"><code>isleaf</code></em> <code class="type">boolean</code>,
        <em class="parameter"><code>level</code></em> <code class="type">integer</code> )
       </p>
       <p>
<!--
        Lists the tables or indexes in the partition tree of the
        given partitioned table or partitioned index, with one row for each
        partition.  Information provided includes the OID of the partition,
        the OID of its immediate parent, a boolean value telling if the
        partition is a leaf, and an integer telling its level in the hierarchy.
        The level value is 0 for the input table or index, 1 for its
        immediate child partitions, 2 for their partitions, and so on.
        Returns no rows if the relation does not exist or is not a partition
        or partitioned table.
-->
1行1パーティションで与えられたパーティション化テーブルあるいはパーティション化インデックスのパーティションツリー内のテーブルあるいはインデックスの情報を表示します。
提供される情報にはパーティションOID、その直接の親のOID、パーティションが葉かどうかを示す真偽値、階層内のレベルを表す整数が含まれます。
レベル値は与えられたテーブルあるいはインデックスがパーティションツリーの根としての役割を持つことを表す0で始まり、1ならその直下のパーティション、2ならそのまた下のパーティションなどとなります。
リレーションが存在しない、あるいはパーティションでない、もしくはパーティション化テーブルでない場合は行を返しません。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.9.10.2.2.2.1.1.1" class="indexterm"></a>
        <code class="function">pg_partition_ancestors</code> ( <code class="type">regclass</code> )
        → <code class="returnvalue">setof regclass</code>
       </p>
       <p>
<!--
        Lists the ancestor relations of the given partition,
        including the relation itself.  Returns no rows if the relation
        does not exist or is not a partition or partitioned table.
-->
パーティション自身を含む、与えられたパーティションの先祖リレーションを列挙します。
リレーションが存在しない、あるいはパーティションでない、もしくはパーティション化テーブルでない場合は行を返しません。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.9.10.2.2.3.1.1.1" class="indexterm"></a>
        <code class="function">pg_partition_root</code> ( <code class="type">regclass</code> )
        → <code class="returnvalue">regclass</code>
       </p>
       <p>
<!--
        Returns the top-most parent of the partition tree to which the given
        relation belongs.  Returns <literal>NULL</literal> if the relation
        does not exist or is not a partition or partitioned table.
-->
与えられたリレーションが所属するパーティションツリーの最上位の親を返します。
リレーションが存在しない、あるいはパーティションでない、もしくはパーティション化テーブルでない場合は<code class="literal">NULL</code>を返します。
       </p></td></tr></tbody></table></div></div><br class="table-break" /><p>
<!--
    For example, to check the total size of the data contained in a
    partitioned table <structname>measurement</structname>, one could use the
    following query:
-->
たとえばパーティション化テーブル<code class="structname">measurement</code>に含まれるデータの全体サイズを確認するには、次の問い合わせが利用できます。
</p><pre class="programlisting">
SELECT pg_size_pretty(sum(pg_relation_size(relid))) AS total_size
  FROM pg_partition_tree('measurement');
</pre><p>
   </p></div><div class="sect2" id="FUNCTIONS-ADMIN-INDEX"><div class="titlepage"><div><div><h3 class="title">9.27.8. インデックス保守関数 <a href="#FUNCTIONS-ADMIN-INDEX" class="id_link">#</a></h3></div></div></div><!--
   <title>Index Maintenance Functions</title>
--><p>
<!--
    <xref linkend="functions-admin-index-table"/> shows the functions
    available for index maintenance tasks.  (Note that these maintenance
    tasks are normally done automatically by autovacuum; use of these
    functions is only required in special cases.)
    These functions cannot be executed during recovery.
    Use of these functions is restricted to superusers and the owner
    of the given index.
-->
<a class="xref" href="functions-admin.html#FUNCTIONS-ADMIN-INDEX-TABLE" title="表9.100 インデックス保守関数">表 9.100</a>にインデックスの保守タスクに使用可能な関数を示します。
（これらの保守業務は通常自動バキュームが自動的に行うことに注意してください。これらの関数は特別な場合にのみ必要になります。）
これらの関数はリカバリ中は実行できません。
これらの関数の使用はスーパーユーザと対象のインデックスの所有者に限定されます。
   </p><div class="table" id="FUNCTIONS-ADMIN-INDEX-TABLE"><p class="title"><strong>表9.100 インデックス保守関数</strong></p><div class="table-contents"><!--
    <title>Index Maintenance Functions</title>
--><table class="table" summary="インデックス保守関数" border="1"><colgroup><col /></colgroup><thead><tr><th class="func_table_entry"><p class="func_signature">
<!--
        Function
-->
関数
       </p>
       <p>
<!--
        Description
-->
説明
       </p></th></tr></thead><tbody><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.10.3.2.2.1.1.1.1" class="indexterm"></a>
        <code class="function">brin_summarize_new_values</code> ( <em class="parameter"><code>index</code></em> <code class="type">regclass</code> )
        → <code class="returnvalue">integer</code>
       </p>
       <p>
<!--
        Scans the specified BRIN index to find page ranges in the base table
        that are not currently summarized by the index; for any such range it
        creates a new summary index tuple by scanning those table pages.
        Returns the number of new page range summaries that were inserted
        into the index.
-->
指定されたBRINインデックスを検査してベーステーブル内のインデックスによって現在要約されていないページ範囲を探します。
そのような範囲があれば、テーブルのページをスキャンして新しい要約インデックスタプルを作成します。
インデックスに挿入された新しいページ範囲要約の数を返します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.10.3.2.2.2.1.1.1" class="indexterm"></a>
        <code class="function">brin_summarize_range</code> ( <em class="parameter"><code>index</code></em> <code class="type">regclass</code>, <em class="parameter"><code>blockNumber</code></em> <code class="type">bigint</code> )
        → <code class="returnvalue">integer</code>
       </p>
       <p>
<!--
        Summarizes the page range covering the given block, if not already
        summarized.  This is
        like <function>brin_summarize_new_values</function> except that it
        only processes the page range that covers the given table block number.
-->
指定のブロックを含むページ範囲が、まだ要約されていなければ、要約します。
これは<code class="function">brin_summarize_new_values</code>と似ていますが、指定されたテーブルブロック番号のみを対象としてページ範囲を処理するところだけが異なります。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.10.3.2.2.3.1.1.1" class="indexterm"></a>
        <code class="function">brin_desummarize_range</code> ( <em class="parameter"><code>index</code></em> <code class="type">regclass</code>, <em class="parameter"><code>blockNumber</code></em> <code class="type">bigint</code> )
        → <code class="returnvalue">void</code>
       </p>
       <p>
<!--
        Removes the BRIN index tuple that summarizes the page range covering
        the given table block, if there is one.
-->
指定のブロックを含むページ範囲が要約されていれば、それを含むページ範囲を要約するBRINインデックスタプルを削除します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.10.3.2.2.4.1.1.1" class="indexterm"></a>
        <code class="function">gin_clean_pending_list</code> ( <em class="parameter"><code>index</code></em> <code class="type">regclass</code> )
        → <code class="returnvalue">bigint</code>
       </p>
       <p>
<!--
        Cleans up the <quote>pending</quote> list of the specified GIN index
        by moving entries in it, in bulk, to the main GIN data structure.
        Returns the number of pages removed from the pending list.
        If the argument is a GIN index built with
        the <literal>fastupdate</literal> option disabled, no cleanup happens
        and the result is zero, because the index doesn't have a pending list.
        See <xref linkend="gin-fast-update"/> and <xref linkend="gin-tips"/>
        for details about the pending list and <literal>fastupdate</literal>
        option.
-->
指定GINインデックスの<span class="quote">「<span class="quote">処理待ち</span>」</span>リストのエントリをメインのインデックスデータ構造に一括で移動します。
処理待ちリストから削除されたページ数を返します。
<code class="literal">fastupdate</code>オプションが無効で作成されたGINインデックスが引数なら、削除は起こらず結果がゼロになります。そのインデックスには処理待ちリストがないからです。
処理待ちリストと<code class="literal">fastupdate</code>オプションの詳細については<a class="xref" href="gin-implementation.html#GIN-FAST-UPDATE" title="70.4.1. GIN高速更新手法">70.4.1</a>と<a class="xref" href="gin-tips.html" title="70.5. GINの小技">70.5</a>をご覧ください。
       </p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="FUNCTIONS-ADMIN-GENFILE"><div class="titlepage"><div><div><h3 class="title">9.27.9. 汎用ファイルアクセス関数 <a href="#FUNCTIONS-ADMIN-GENFILE" class="id_link">#</a></h3></div></div></div><!--
   <title>Generic File Access Functions</title>
--><p>
<!--
    The functions shown in <xref
    linkend="functions-admin-genfile-table"/> provide native access to
    files on the machine hosting the server. Only files within the
    database cluster directory and the <varname>log_directory</varname> can be
    accessed, unless the user is a superuser or is granted the role
    <literal>pg_read_server_files</literal>.  Use a relative path for files in
    the cluster directory, and a path matching the <varname>log_directory</varname>
    configuration setting for log files.
-->
<a class="xref" href="functions-admin.html#FUNCTIONS-ADMIN-GENFILE-TABLE" title="表9.101 汎用ファイルアクセス関数">表 9.101</a>で示されている関数はサーバをホスティングしているマシン上のファイルに対し、ネイティブのアクセスを提供します。
ユーザが<code class="literal">pg_read_server_files</code>ロールを与えられていない限り、データベースクラスタディレクトリと<code class="varname">log_directory</code>に存在するファイルのみがアクセス可能です。
クラスタディレクトリ内のファイルに対して相対パスを、そしてログファイルに対しては<code class="varname">log_directory</code>構成設定に一致するパスを使用してください。
   </p><p>
<!--
    Note that granting users the EXECUTE privilege on
    <function>pg_read_file()</function>, or related functions, allows them the
    ability to read any file on the server that the database server process can
    read; these functions bypass all in-database privilege checks.  This means
    that, for example, a user with such access is able to read the contents of
    the <structname>pg_authid</structname> table where authentication
    information is stored, as well as read any table data in the database.
    Therefore, granting access to these functions should be carefully
    considered.
-->
ユーザに対してEXECUTE権限を<code class="function">pg_read_file()</code>あるいは関連する関数に与えることは、サーバの上データベースサーバプロセスが読めるすべてのファイルを読めるようにすることになることに注意してください。これらの関数はデータベース内のすべての権限チェックをすり抜けます。
このことは、たとえばそのようなアクセス権を持つユーザは、認証情報が格納された<code class="structname">pg_authid</code>テーブルの中身を読むことができますし、同様にデータベース内のすべてのテーブルデータを読むことができるということを意味します。
ですからこれらの関数にアクセス権限を与えるのは慎重に考慮したほうが良いでしょう。
   </p><p>
<!--
    When granting privilege on these functions, note that the table entries
    showing optional parameters are mostly implemented as several physical
    functions with different parameter lists.  Privilege must be granted
    separately on each such function, if it is to be
    used.  <application>psql</application>'s <command>\df</command> command
    can be useful to check what the actual function signatures are.
-->
《機械翻訳》これらの関数に権限を付与する場合、オプションパラメータを示すテーブルエントリのノートは、ほとんどの場合、異なる物理的リストを持ついくつかのパラメータ関数として実装されます。
権限を使用する場合は、各関数に対して個別に付与する必要があります。
<span class="application">psql</span>の<code class="command">\df</code>コマンドは、実際の関数署名が何であるかをチェックに提供するのに役立ちます。
   </p><p>
<!--
    Some of these functions take an optional <parameter>missing_ok</parameter>
    parameter, which specifies the behavior when the file or directory does
    not exist.  If <literal>true</literal>, the function
    returns <literal>NULL</literal> or an empty result set, as appropriate.
    If <literal>false</literal>, an error is raised.  (Failure conditions
    other than <quote>file not found</quote> are reported as errors in any
    case.)  The default is <literal>false</literal>.
-->
《マッチ度[74.017467]》これらの関数の一部はオプションで<em class="parameter"><code>missing_ok</code></em>パラメータをとり、ファイルまたはディレクトリが存在しない場合の動作を指定できます。
<code class="literal">true</code>の場合、関数は<code class="literal">NULL</code>を返すか、適切な場合には空の結果集合を返します。
<code class="literal">false</code>の場合はエラーが発生します。
デフォルトは<code class="literal">false</code>です。
《機械翻訳》これらの関数の中には、オプショナルまたはパラメータが存在しない場合の動作を指定するファイル<em class="parameter"><code>missing_ok</code></em>ディレクトリを取るものがあります。
<code class="literal">真</code>の場合、関数は<code class="literal">null</code>または空の結果セットを適宜戻します。
<code class="literal">偽</code>の場合、エラーが発生します。
(<span class="quote">「<span class="quote">ファイルが見つかりません</span>」</span>以外の失敗条件は、どのケースでもエラーとして報告されます。
)デフォルトは<code class="literal">偽</code>です。
   </p><div class="table" id="FUNCTIONS-ADMIN-GENFILE-TABLE"><p class="title"><strong>表9.101 汎用ファイルアクセス関数</strong></p><div class="table-contents"><!--
    <title>Generic File Access Functions</title>
--><table class="table" summary="汎用ファイルアクセス関数" border="1"><colgroup><col /></colgroup><thead><tr><th class="func_table_entry"><p class="func_signature">
<!--
        Function
-->
関数
       </p>
       <p>
<!--
        Description
-->
説明
       </p></th></tr></thead><tbody><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.11.6.2.2.1.1.1.1" class="indexterm"></a>
        <code class="function">pg_ls_dir</code> ( <em class="parameter"><code>dirname</code></em> <code class="type">text</code> [<span class="optional">, <em class="parameter"><code>missing_ok</code></em> <code class="type">boolean</code>, <em class="parameter"><code>include_dot_dirs</code></em> <code class="type">boolean</code> </span>] )
        → <code class="returnvalue">setof text</code>
       </p>
       <p>
<!--
        Returns the names of all files (and directories and other special
        files) in the specified
        directory. The <parameter>include_dot_dirs</parameter> parameter
        indicates whether <quote>.</quote> and <quote>..</quote> are to be
        included in the result set; the default is to exclude them.  Including
        them can be useful when <parameter>missing_ok</parameter>
        is <literal>true</literal>, to distinguish an empty directory from a
        non-existent directory.
-->
指定されたディレクトリ内のすべてのファイル（およびディレクトリと他の特殊ファイル）の名前を返します。
<em class="parameter"><code>include_dot_dirs</code></em>は<span class="quote">「<span class="quote">.</span>」</span>と<span class="quote">「<span class="quote">..</span>」</span>が結果集合に含まれるかどうかを指定します。
デフォルト(<code class="literal">false</code>)ではそれらを除外しますが、それらを含めると、<em class="parameter"><code>missing_ok</code></em>が<code class="literal">true</code>の場合は、空のディレクトリと存在しないディレクトリを区別するために役立つでしょう。
       </p>
       <p>
<!--
        This function is restricted to superusers by default, but other users
        can be granted EXECUTE to run the function.
-->
デフォルトではこの関数の実行はスーパーユーザに限定されますが、他のユーザに関数を実行するEXECUTE権限を与えることができます。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.11.6.2.2.2.1.1.1" class="indexterm"></a>
        <code class="function">pg_ls_logdir</code> ()
        → <code class="returnvalue">setof record</code>
        ( <em class="parameter"><code>name</code></em> <code class="type">text</code>,
        <em class="parameter"><code>size</code></em> <code class="type">bigint</code>,
        <em class="parameter"><code>modification</code></em> <code class="type">timestamp with time zone</code> )
       </p>
       <p>
<!--
        Returns the name, size, and last modification time (mtime) of each
        ordinary file in the server's log directory.  Filenames beginning with
        a dot, directories, and other special files are excluded.
-->
サーバのログディレクトリ内の各通常ファイルについて、名前、サイズ、最終更新時刻（mtime）を返します。
ドットで始まるファイル名、ディレクトリ名その他の特殊なファイルは含まれません。
       </p>
       <p>
<!--
        This function is restricted to superusers and roles with privileges of
        the <literal>pg_monitor</literal> role by default, but other users can
        be granted EXECUTE to run the function.
-->
デフォルトではこの関数の実行はスーパーユーザと<code class="literal">pg_monitor</code>ロールの権限を持つロールに限定されますが、他のユーザに関数を実行するEXECUTE権限を与えることができます。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.11.6.2.2.3.1.1.1" class="indexterm"></a>
        <code class="function">pg_ls_waldir</code> ()
        → <code class="returnvalue">setof record</code>
        ( <em class="parameter"><code>name</code></em> <code class="type">text</code>,
        <em class="parameter"><code>size</code></em> <code class="type">bigint</code>,
        <em class="parameter"><code>modification</code></em> <code class="type">timestamp with time zone</code> )
       </p>
       <p>
<!--
        Returns the name, size, and last modification time (mtime) of each
        ordinary file in the server's write-ahead log (WAL) directory.
        Filenames beginning with a dot, directories, and other special files
        are excluded.
-->
先行書き込みログ（WAL）ディレクトリ内の各ファイルについて、名前、サイズ、最終更新時刻（mtime）を返します。
ドットで始まるファイル名、ディレクトリ名その他の特殊なファイルは含まれません。
       </p>
       <p>
<!--
        This function is restricted to superusers and roles with privileges of
        the <literal>pg_monitor</literal> role by default, but other users can
        be granted EXECUTE to run the function.
-->
デフォルトではこの関数の実行はスーパーユーザと<code class="literal">pg_monitor</code>ロールの権限を持つロールに限定されますが、他のユーザに関数を実行するEXECUTE権限を与えることができます。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.11.6.2.2.4.1.1.1" class="indexterm"></a>
        <code class="function">pg_ls_logicalmapdir</code> ()
        → <code class="returnvalue">setof record</code>
        ( <em class="parameter"><code>name</code></em> <code class="type">text</code>,
        <em class="parameter"><code>size</code></em> <code class="type">bigint</code>,
        <em class="parameter"><code>modification</code></em> <code class="type">timestamp with time zone</code> )
       </p>
       <p>
<!--
        Returns the name, size, and last modification time (mtime) of each
        ordinary file in the server's <filename>pg_logical/mappings</filename>
        directory. Filenames beginning with a dot, directories, and other
        special files are excluded.
-->
サーバの<code class="filename">pg_logical/mappings</code>ディレクトリ内の各通常ファイルについて、名前、サイズ、最終更新時刻（mtime）を返します。
ドットで始まるファイル名、ディレクトリ名その他の特殊なファイルは含まれません。
       </p>
       <p>
<!--
        This function is restricted to superusers and members of
        the <literal>pg_monitor</literal> role by default, but other users can
        be granted EXECUTE to run the function.
-->
デフォルトではこの関数の実行はスーパーユーザと<code class="literal">pg_monitor</code>ロールのメンバーに限定されますが、他のユーザに関数を実行するEXECUTE権限を与えることができます。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.11.6.2.2.5.1.1.1" class="indexterm"></a>
        <code class="function">pg_ls_logicalsnapdir</code> ()
        → <code class="returnvalue">setof record</code>
        ( <em class="parameter"><code>name</code></em> <code class="type">text</code>,
        <em class="parameter"><code>size</code></em> <code class="type">bigint</code>,
        <em class="parameter"><code>modification</code></em> <code class="type">timestamp with time zone</code> )
       </p>
       <p>
<!--
        Returns the name, size, and last modification time (mtime) of each
        ordinary file in the server's <filename>pg_logical/snapshots</filename>
        directory. Filenames beginning with a dot, directories, and other
        special files are excluded.
-->
サーバの<code class="filename">pg_logical/snapshots</code>ディレクトリ内の各通常ファイルについて、名前、サイズ、最終更新時刻（mtime）を返します。
ドットで始まるファイル名、ディレクトリ名その他の特殊なファイルは含まれません。
       </p>
       <p>
<!--
        This function is restricted to superusers and members of
        the <literal>pg_monitor</literal> role by default, but other users can
        be granted EXECUTE to run the function.
-->
デフォルトではこの関数の実行はスーパーユーザと<code class="literal">pg_monitor</code>ロールのメンバーに限定されますが、他のユーザに関数を実行するEXECUTE権限を与えることができます。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.11.6.2.2.6.1.1.1" class="indexterm"></a>
        <code class="function">pg_ls_replslotdir</code> ( <em class="parameter"><code>slot_name</code></em> <code class="type">text</code> )
        → <code class="returnvalue">setof record</code>
        ( <em class="parameter"><code>name</code></em> <code class="type">text</code>,
        <em class="parameter"><code>size</code></em> <code class="type">bigint</code>,
        <em class="parameter"><code>modification</code></em> <code class="type">timestamp with time zone</code> )
       </p>
       <p>
<!--
        Returns the name, size, and last modification time (mtime) of each
        ordinary file in the server's <filename>pg_replslot/slot_name</filename>
        directory, where <parameter>slot_name</parameter> is the name of the
        replication slot provided as input of the function. Filenames beginning
        with a dot, directories, and other special files are excluded.
-->
サーバの<code class="filename">pg_replslot/slot_name</code>内の各ファイルについて、名前、サイズ、最終更新時刻（mtime）を返します。
<em class="parameter"><code>slot_name</code></em>は、関数の入力として提供されているレプリケーションスロットの名前です。
ドットで始まるファイル名、ディレクトリ名その他の特殊なファイルは含まれません。
       </p>
       <p>
<!--
        This function is restricted to superusers and members of
        the <literal>pg_monitor</literal> role by default, but other users can
        be granted EXECUTE to run the function.
-->
デフォルトではこの関数の実行はスーパーユーザと<code class="literal">pg_monitor</code>ロールに限定されますが、他のユーザに関数を実行するEXECUTE権限を与えることができます。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.11.6.2.2.7.1.1.1" class="indexterm"></a>
        <code class="function">pg_ls_archive_statusdir</code> ()
        → <code class="returnvalue">setof record</code>
        ( <em class="parameter"><code>name</code></em> <code class="type">text</code>,
        <em class="parameter"><code>size</code></em> <code class="type">bigint</code>,
        <em class="parameter"><code>modification</code></em> <code class="type">timestamp with time zone</code> )
       </p>
       <p>
<!--
        Returns the name, size, and last modification time (mtime) of each
        ordinary file in the server's WAL archive status directory
        (<filename>pg_wal/archive_status</filename>).  Filenames beginning
        with a dot, directories, and other special files are excluded.
-->
WALアーカイブステータスディレクトリ(<code class="filename">pg_wal/archive_status</code>)内の各ファイルについて、名前、サイズ、最終更新時刻（mtime）を返します。
ドットで始まるファイル名、ディレクトリ名その他の特殊なファイルは含まれません。
       </p>
       <p>
<!--
        This function is restricted to superusers and members of
        the <literal>pg_monitor</literal> role by default, but other users can
        be granted EXECUTE to run the function.
-->
デフォルトではこの関数の実行はスーパーユーザと<code class="literal">pg_monitor</code>ロールのメンバーに限定されますが、他のユーザに関数を実行するEXECUTE権限を与えることができます。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">

        <a id="id-1.5.8.35.11.6.2.2.8.1.1.1" class="indexterm"></a>
        <code class="function">pg_ls_tmpdir</code> ( [<span class="optional"> <em class="parameter"><code>tablespace</code></em> <code class="type">oid</code> </span>] )
        → <code class="returnvalue">setof record</code>
        ( <em class="parameter"><code>name</code></em> <code class="type">text</code>,
        <em class="parameter"><code>size</code></em> <code class="type">bigint</code>,
        <em class="parameter"><code>modification</code></em> <code class="type">timestamp with time zone</code> )
       </p>
       <p>
<!--
        Returns the name, size, and last modification time (mtime) of each
        ordinary file in the temporary file directory for the
        specified <parameter>tablespace</parameter>.
        If <parameter>tablespace</parameter> is not provided,
        the <literal>pg_default</literal> tablespace is examined.  Filenames
        beginning with a dot, directories, and other special files are
        excluded.
-->
指定された<em class="parameter"><code>tablespace</code></em>内の一時ファイルディレクトリ内の各ファイルについて、名前、サイズ、最終更新時刻（mtime）を返します。
<em class="parameter"><code>tablespace</code></em>が与えられなければ<code class="literal">pg_default</code>テーブル空間が検査されます。
ドットで始まるファイル名、ディレクトリ名その他の特殊なファイルは含まれません。
       </p>
       <p>
<!--
        This function is restricted to superusers and members of
        the <literal>pg_monitor</literal> role by default, but other users can
        be granted EXECUTE to run the function.
-->
デフォルトではこの関数の実行はスーパーユーザと<code class="literal">pg_monitor</code>ロールのメンバーに限定されますが、他のユーザに関数を実行するEXECUTE権限を与えることができます。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.11.6.2.2.9.1.1.1" class="indexterm"></a>
        <code class="function">pg_read_file</code> ( <em class="parameter"><code>filename</code></em> <code class="type">text</code> [<span class="optional">, <em class="parameter"><code>offset</code></em> <code class="type">bigint</code>, <em class="parameter"><code>length</code></em> <code class="type">bigint</code> </span>] [<span class="optional">, <em class="parameter"><code>missing_ok</code></em> <code class="type">boolean</code> </span>] )
        → <code class="returnvalue">text</code>
       </p>
       <p>
<!--
        Returns all or part of a text file, starting at the
        given byte <parameter>offset</parameter>, returning at
        most <parameter>length</parameter> bytes (less if the end of file is
        reached first).  If <parameter>offset</parameter> is negative, it is
        relative to the end of the file.  If <parameter>offset</parameter>
        and <parameter>length</parameter> are omitted, the entire file is
        returned.  The bytes read from the file are interpreted as a string in
        the database's encoding; an error is thrown if they are not valid in
        that encoding.
-->
与えられた<em class="parameter"><code>offset</code></em>から始まり、最大<em class="parameter"><code>length</code></em>バイト（先にファイルの終りに到達すればこれより少なくなります）テキストファイルの全部または一部分を返します。
<em class="parameter"><code>offset</code></em>が負の場合にはファイルの終りから数えた位置から読み出します。
<em class="parameter"><code>offset</code></em>と<em class="parameter"><code>length</code></em>が省略された場合、ファイル全体が返されます。
ファイルから読み込まれたバイトは、そのサーバの符号化方式での文字列として解釈されます。
読み込んだバイト列がその符号化方式において有効でない場合にはエラーが投げられます。
       </p>
       <p>
<!--
        This function is restricted to superusers by default, but other users
        can be granted EXECUTE to run the function.
-->
デフォルトではこの関数の実行はスーパーユーザに限定されますが、他のユーザに関数を実行するEXECUTE権限を与えることができます。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.11.6.2.2.10.1.1.1" class="indexterm"></a>
        <code class="function">pg_read_binary_file</code> ( <em class="parameter"><code>filename</code></em> <code class="type">text</code> [<span class="optional">, <em class="parameter"><code>offset</code></em> <code class="type">bigint</code>, <em class="parameter"><code>length</code></em> <code class="type">bigint</code> </span>] [<span class="optional">, <em class="parameter"><code>missing_ok</code></em> <code class="type">boolean</code> </span>] )
        → <code class="returnvalue">bytea</code>
       </p>
       <p>
<!--
        Returns all or part of a file.  This function is identical to
        <function>pg_read_file</function> except that it can read arbitrary
        binary data, returning the result as <type>bytea</type>
        not <type>text</type>; accordingly, no encoding checks are performed.
-->
ファイルの一部あるいは全部を返します。
結果が<code class="type">text</code>ではなくて<code class="type">bytea</code>値となり、任意のバイナリデータを読み出すことができることを除き、<code class="function">pg_read_file</code>と同じです。
従って符号化方式の検査は行われません。
       </p>
       <p>
<!--
        This function is restricted to superusers by default, but other users
        can be granted EXECUTE to run the function.
-->
デフォルトではこの関数の実行はスーパーユーザに限定されますが、他のユーザに関数を実行するEXECUTE権限を与えることができます。
       </p>
       <p>
<!--
        In combination with the <function>convert_from</function> function,
        this function can be used to read a text file in a specified encoding
        and convert to the database's encoding:
-->
<code class="function">convert_from</code>関数と組み合わせることで、この関数を、指定した符号化方式でファイルを読み込んでデータベース符号化方式に変換することができます。
</p><pre class="programlisting">
SELECT convert_from(pg_read_binary_file('file_in_utf8.txt'), 'UTF8');
</pre><p>
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.11.6.2.2.11.1.1.1" class="indexterm"></a>
        <code class="function">pg_stat_file</code> ( <em class="parameter"><code>filename</code></em> <code class="type">text</code> [<span class="optional">, <em class="parameter"><code>missing_ok</code></em> <code class="type">boolean</code> </span>] )
        → <code class="returnvalue">record</code>
        ( <em class="parameter"><code>size</code></em> <code class="type">bigint</code>,
        <em class="parameter"><code>access</code></em> <code class="type">timestamp with time zone</code>,
        <em class="parameter"><code>modification</code></em> <code class="type">timestamp with time zone</code>,
        <em class="parameter"><code>change</code></em> <code class="type">timestamp with time zone</code>,
        <em class="parameter"><code>creation</code></em> <code class="type">timestamp with time zone</code>,
        <em class="parameter"><code>isdir</code></em> <code class="type">boolean</code> )
       </p>
       <p>
<!--
        Returns a record containing the file's size, last access time stamp,
        last modification time stamp, last file status change time stamp (Unix
        platforms only), file creation time stamp (Windows only), and a flag
        indicating if it is a directory.
-->
ファイル容量、最終アクセス時刻、最終更新時刻、最後にファイルステータスを変更した時刻（これはUnixプラットフォームのみ）、ファイル作成時刻（Windowsのみ）および、ディレクトリかどうかを示すフラグを返します。
       </p>
       <p>
<!--
        This function is restricted to superusers by default, but other users
        can be granted EXECUTE to run the function.
-->
デフォルトではこの関数の実行はスーパーユーザに限定されますが、他のユーザに関数を実行するEXECUTE権限を与えることができます。
       </p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="FUNCTIONS-ADVISORY-LOCKS"><div class="titlepage"><div><div><h3 class="title">9.27.10. 勧告的ロック用関数 <a href="#FUNCTIONS-ADVISORY-LOCKS" class="id_link">#</a></h3></div></div></div><!--
   <title>Advisory Lock Functions</title>
--><p>
<!--
    The functions shown in <xref linkend="functions-advisory-locks-table"/>
    manage advisory locks.  For details about proper use of these functions,
    see <xref linkend="advisory-locks"/>.
-->
<a class="xref" href="functions-admin.html#FUNCTIONS-ADVISORY-LOCKS-TABLE" title="表9.102 勧告的ロック用関数">表 9.102</a>に示す関数は勧告的ロックを管理します。
これらの関数の適切な使用方法についての詳細は、<a class="xref" href="explicit-locking.html#ADVISORY-LOCKS" title="13.3.5. 勧告的ロック">13.3.5</a>を参照してください。
   </p><p>
<!--
    All these functions are intended to be used to lock application-defined
    resources, which can be identified either by a single 64-bit key value or
    two 32-bit key values (note that these two key spaces do not overlap).
    If another session already holds a conflicting lock on the same resource
    identifier, the functions will either wait until the resource becomes
    available, or return a <literal>false</literal> result, as appropriate for
    the function.
    Locks can be either shared or exclusive: a shared lock does not conflict
    with other shared locks on the same resource, only with exclusive locks.
    Locks can be taken at session level (so that they are held until released
    or the session ends) or at transaction level (so that they are held until
    the current transaction ends; there is no provision for manual release).
    Multiple session-level lock requests stack, so that if the same resource
    identifier is locked three times there must then be three unlock requests
    to release the resource in advance of session end.
-->
これらの関数はすべて単一の64ビットキー値か2つの32ビットキー値（これらのキー空間は重なり合わないことに注意してください）で識別されるアプリケーション定義のリソースをロックするために使うことを意図しています。
他のセッションがすでに同じリソース識別子とコンフリクトするロックを保持していたら、関数はリソースが利用可能になるまで待つか、その関数にとって適切ならば<code class="literal">false</code>を結果として返します。
ロックは共有はあるいは排他のどちらも可能です。共有ロックは同じリソースに対して他の共有ロックとコンフリクトしません。排他ロックとだけコンフリクトします。
ロックはセッションレベル（ロックは解放されるまで保持するかセッションの終了まで保持します）あるいはトランザクションレベル（ロックは現在のトランザクションが終了するまで保持します。手動で解放する方法はありません）で取得できます。
複数のセッションレベルロック要求は積み重ねられます。これにより、同じリソース識別子が3回ロックされると、セッション終了前にそのリソースを解放するアンロック要求が3回発行されなければならなくなります。
   </p><div class="table" id="FUNCTIONS-ADVISORY-LOCKS-TABLE"><p class="title"><strong>表9.102 勧告的ロック用関数</strong></p><div class="table-contents"><!--
    <title>Advisory Lock Functions</title>
--><table class="table" summary="勧告的ロック用関数" border="1"><colgroup><col /></colgroup><thead><tr><th class="func_table_entry"><p class="func_signature">
<!--
        Function
-->
関数
       </p>
       <p>
<!--
        Description
-->
説明
       </p></th></tr></thead><tbody><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.12.4.2.2.1.1.1.1" class="indexterm"></a>
        <code class="function">pg_advisory_lock</code> ( <em class="parameter"><code>key</code></em> <code class="type">bigint</code> )
        → <code class="returnvalue">void</code>
       </p>
       <p class="func_signature">
        <code class="function">pg_advisory_lock</code> ( <em class="parameter"><code>key1</code></em> <code class="type">integer</code>, <em class="parameter"><code>key2</code></em> <code class="type">integer</code> )
        → <code class="returnvalue">void</code>
       </p>
       <p>
<!--
        Obtains an exclusive session-level advisory lock, waiting if necessary.
-->
必要なら待ってからセッションレベルの排他勧告的ロックを獲得します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.12.4.2.2.2.1.1.1" class="indexterm"></a>
        <code class="function">pg_advisory_lock_shared</code> ( <em class="parameter"><code>key</code></em> <code class="type">bigint</code> )
        → <code class="returnvalue">void</code>
       </p>
       <p class="func_signature">
        <code class="function">pg_advisory_lock_shared</code> ( <em class="parameter"><code>key1</code></em> <code class="type">integer</code>, <em class="parameter"><code>key2</code></em> <code class="type">integer</code> )
        → <code class="returnvalue">void</code>
       </p>
       <p>
<!--
        Obtains a shared session-level advisory lock, waiting if necessary.
-->
必要なら待ってからセッションレベルの共有勧告的ロックを獲得します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.12.4.2.2.3.1.1.1" class="indexterm"></a>
        <code class="function">pg_advisory_unlock</code> ( <em class="parameter"><code>key</code></em> <code class="type">bigint</code> )
        → <code class="returnvalue">boolean</code>
       </p>
       <p class="func_signature">
        <code class="function">pg_advisory_unlock</code> ( <em class="parameter"><code>key1</code></em> <code class="type">integer</code>, <em class="parameter"><code>key2</code></em> <code class="type">integer</code> )
        → <code class="returnvalue">boolean</code>
       </p>
       <p>
<!--
        Releases a previously-acquired exclusive session-level advisory lock.
        Returns <literal>true</literal> if the lock is successfully released.
        If the lock was not held, <literal>false</literal> is returned, and in
        addition, an SQL warning will be reported by the server.
-->
事前に獲得したセッションレベルの排他的勧告ロックを解放します。
ロックの解放に成功した場合、<code class="literal">true</code>を返します。
ロックを保持していない場合、<code class="literal">false</code>を返し、さらに、SQL警告がサーバから報告されます。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.12.4.2.2.4.1.1.1" class="indexterm"></a>
        <code class="function">pg_advisory_unlock_all</code> ()
        → <code class="returnvalue">void</code>
       </p>
       <p>
<!--
        Releases all session-level advisory locks held by the current session.
        (This function is implicitly invoked at session end, even if the
        client disconnects ungracefully.)
-->
現在のセッションで保持するセッションレベルの勧告的ロックをすべて解放します。
（この関数は、クライアントとの接続が不用意に切れた場合でも、セッション終了時に暗黙的に呼び出されます。）
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.12.4.2.2.5.1.1.1" class="indexterm"></a>
        <code class="function">pg_advisory_unlock_shared</code> ( <em class="parameter"><code>key</code></em> <code class="type">bigint</code> )
        → <code class="returnvalue">boolean</code>
       </p>
       <p class="func_signature">
        <code class="function">pg_advisory_unlock_shared</code> ( <em class="parameter"><code>key1</code></em> <code class="type">integer</code>, <em class="parameter"><code>key2</code></em> <code class="type">integer</code> )
        → <code class="returnvalue">boolean</code>
       </p>
       <p>
<!--
        Releases a previously-acquired shared session-level advisory lock.
        Returns <literal>true</literal> if the lock is successfully released.
        If the lock was not held, <literal>false</literal> is returned, and in
        addition, an SQL warning will be reported by the server.
-->
事前に獲得したセッションレベルの共有勧告的ロックを解放します。
ロックの解放に成功した場合、<code class="literal">true</code>を返します。
ロックを保持していない場合、<code class="literal">false</code>を返し、さらに、SQL警告がサーバから報告されます。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.12.4.2.2.6.1.1.1" class="indexterm"></a>
        <code class="function">pg_advisory_xact_lock</code> ( <em class="parameter"><code>key</code></em> <code class="type">bigint</code> )
        → <code class="returnvalue">void</code>
       </p>
       <p class="func_signature">
        <code class="function">pg_advisory_xact_lock</code> ( <em class="parameter"><code>key1</code></em> <code class="type">integer</code>, <em class="parameter"><code>key2</code></em> <code class="type">integer</code> )
        → <code class="returnvalue">void</code>
       </p>
       <p>
<!--
        Obtains an exclusive transaction-level advisory lock, waiting if
        necessary.
-->
必要なら待ってからトランザクションレベルの排他勧告的ロックを獲得します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.12.4.2.2.7.1.1.1" class="indexterm"></a>
        <code class="function">pg_advisory_xact_lock_shared</code> ( <em class="parameter"><code>key</code></em> <code class="type">bigint</code> )
        → <code class="returnvalue">void</code>
       </p>
       <p class="func_signature">
        <code class="function">pg_advisory_xact_lock_shared</code> ( <em class="parameter"><code>key1</code></em> <code class="type">integer</code>, <em class="parameter"><code>key2</code></em> <code class="type">integer</code> )
        → <code class="returnvalue">void</code>
       </p>
       <p>
<!--
        Obtains a shared transaction-level advisory lock, waiting if
        necessary.
-->
必要なら待ってからトランザクションレベルの共有勧告的ロックを獲得します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.12.4.2.2.8.1.1.1" class="indexterm"></a>
        <code class="function">pg_try_advisory_lock</code> ( <em class="parameter"><code>key</code></em> <code class="type">bigint</code> )
        → <code class="returnvalue">boolean</code>
       </p>
       <p class="func_signature">
        <code class="function">pg_try_advisory_lock</code> ( <em class="parameter"><code>key1</code></em> <code class="type">integer</code>, <em class="parameter"><code>key2</code></em> <code class="type">integer</code> )
        → <code class="returnvalue">boolean</code>
       </p>
       <p>
<!--
        Obtains an exclusive session-level advisory lock if available.
        This will either obtain the lock immediately and
        return <literal>true</literal>, or return <literal>false</literal>
        without waiting if the lock cannot be acquired immediately.
-->
可能ならセッションレベルの排他勧告的ロックを獲得します。
これは直ちにロックを取得して<code class="literal">true</code>を返すか、直ちにロックを取得できない場合は待たずに<code class="literal">false</code>を返します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.12.4.2.2.9.1.1.1" class="indexterm"></a>
        <code class="function">pg_try_advisory_lock_shared</code> ( <em class="parameter"><code>key</code></em> <code class="type">bigint</code> )
        → <code class="returnvalue">boolean</code>
       </p>
       <p class="func_signature">
        <code class="function">pg_try_advisory_lock_shared</code> ( <em class="parameter"><code>key1</code></em> <code class="type">integer</code>, <em class="parameter"><code>key2</code></em> <code class="type">integer</code> )
        → <code class="returnvalue">boolean</code>
       </p>
       <p>
<!--
        Obtains a shared session-level advisory lock if available.
        This will either obtain the lock immediately and
        return <literal>true</literal>, or return <literal>false</literal>
        without waiting if the lock cannot be acquired immediately.
-->
可能ならセッションレベルの共有勧告的ロックを獲得します。
これは直ちにロックを取得して<code class="literal">true</code>を返すか、直ちにロックを取得できない場合は待たずに<code class="literal">false</code>を返します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.12.4.2.2.10.1.1.1" class="indexterm"></a>
        <code class="function">pg_try_advisory_xact_lock</code> ( <em class="parameter"><code>key</code></em> <code class="type">bigint</code> )
        → <code class="returnvalue">boolean</code>
       </p>
       <p class="func_signature">
        <code class="function">pg_try_advisory_xact_lock</code> ( <em class="parameter"><code>key1</code></em> <code class="type">integer</code>, <em class="parameter"><code>key2</code></em> <code class="type">integer</code> )
        → <code class="returnvalue">boolean</code>
       </p>
       <p>
<!--
        Obtains an exclusive transaction-level advisory lock if available.
        This will either obtain the lock immediately and
        return <literal>true</literal>, or return <literal>false</literal>
        without waiting if the lock cannot be acquired immediately.
-->
可能ならトランザクションレベルの排他勧告的ロックを獲得します。
これは直ちにロックを取得して<code class="literal">true</code>を返すか、直ちにロックを取得できない場合は待たずに<code class="literal">false</code>を返します。
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.35.12.4.2.2.11.1.1.1" class="indexterm"></a>
        <code class="function">pg_try_advisory_xact_lock_shared</code> ( <em class="parameter"><code>key</code></em> <code class="type">bigint</code> )
        → <code class="returnvalue">boolean</code>
       </p>
       <p class="func_signature">
        <code class="function">pg_try_advisory_xact_lock_shared</code> ( <em class="parameter"><code>key1</code></em> <code class="type">integer</code>, <em class="parameter"><code>key2</code></em> <code class="type">integer</code> )
        → <code class="returnvalue">boolean</code>
       </p>
       <p>
<!--
        Obtains a shared transaction-level advisory lock if available.
        This will either obtain the lock immediately and
        return <literal>true</literal>, or return <literal>false</literal>
        without waiting if the lock cannot be acquired immediately.
-->
可能ならトランザクションレベルの共有勧告的ロックを獲得します。
これは直ちにロックを取得して<code class="literal">true</code>を返すか、直ちにロックを取得できない場合は待たずに<code class="literal">false</code>を返します。
       </p></td></tr></tbody></table></div></div><br class="table-break" /></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="functions-info.html" title="9.26. システム情報関数と演算子">前へ</a> </td><td width="20%" align="center"><a accesskey="u" href="functions.html" title="第9章 関数と演算子">上へ</a></td><td width="40%" align="right"> <a accesskey="n" href="functions-trigger.html" title="9.28. トリガ関数">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">9.26. システム情報関数と演算子 </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="PostgreSQL 16.0文書">ホーム</a></td><td width="40%" align="right" valign="top"> 9.28. トリガ関数</td></tr></table></div></body></html>