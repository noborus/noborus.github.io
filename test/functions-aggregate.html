<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>9.21. 集約関数</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="functions-range.html" title="9.20. 範囲／多重範囲関数と演算子" /><link rel="next" href="functions-window.html" title="9.22. ウィンドウ関数" /><meta name="viewport" content="width=device-width,initial-scale=1.0" /></head><body id="docContent" class="container-fluid col-10"><div class="other_version"><a href="https://www.postgresql.jp/document/">バージョンごとのドキュメント一覧</a></div><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="4" align="center"><a accesskey="h" href="index.html">PostgreSQL 15.0文書</a></th></tr><tr><td width="10%" align="left"></td><td width="10%" align="left"></td><td width="60%" align="center"><a href="functions.html" title="第9章 関数と演算子">第9章 関数と演算子</a></td><td width="20%" align="right"><div class="actions"><a class="issue" title="github" href="https://github.com/pgsql-jp/jpug-doc/issues/new?template=bug_report.yml&amp;what-happened=version 15.0 : functions-aggregate.html">誤訳等の報告
                    </a></div></td></tr><tr><td width="10%" align="left"><a accesskey="p" href="functions-range.html" title="9.20. 範囲／多重範囲関数と演算子">前へ</a> </td><td width="10%" align="left"><a accesskey="u" href="functions.html" title="第9章 関数と演算子">上へ</a></td><td width="60%" align="center">9.21. 集約関数</td><td width="20%" align="right"> <a accesskey="n" href="functions-window.html" title="9.22. ウィンドウ関数">次へ</a></td></tr></table><hr /></div><div class="sect1" id="FUNCTIONS-AGGREGATE"><div class="titlepage"><div><div><h2 class="title" style="clear: both">9.21. 集約関数</h2></div></div></div><span class="original">
  &lt;title&gt;Aggregate Functions&lt;/title&gt;
</span><a id="id-1.5.8.29.2" class="indexterm"></a><a id="id-1.5.8.29.3" class="indexterm"></a><p>
<span class="original">
   &lt;firstterm&gt;Aggregate functions&lt;/firstterm&gt; compute a single result
   from a set of input values.  The built-in general-purpose aggregate
   functions are listed in &lt;xref linkend="functions-aggregate-table"/&gt;
   while statistical aggregates are in &lt;xref
   linkend="functions-aggregate-statistics-table"/&gt;.
   The built-in within-group ordered-set aggregate functions
   are listed in &lt;xref linkend="functions-orderedset-table"/&gt;
   while the built-in within-group hypothetical-set ones are in &lt;xref
   linkend="functions-hypothetical-table"/&gt;.  Grouping operations,
   which are closely related to aggregate functions, are listed in
   &lt;xref linkend="functions-grouping-table"/&gt;.
   The special syntax considerations for aggregate
   functions are explained in &lt;xref linkend="syntax-aggregates"/&gt;.
   Consult &lt;xref linkend="tutorial-agg"/&gt; for additional introductory
   information.
</span>
<em class="firstterm">集約関数</em>は入力値の集合から単一の結果を計算します。
<a class="xref" href="functions-aggregate.html#FUNCTIONS-AGGREGATE-TABLE" title="表9.58 汎用集約関数">表 9.58</a>に組み込みの汎用的な集約関数を、<a class="xref" href="functions-aggregate.html#FUNCTIONS-AGGREGATE-STATISTICS-TABLE" title="表9.59 統計処理用の集約関数">表 9.59</a>に統計集約関数を示します。
<a class="xref" href="functions-aggregate.html#FUNCTIONS-ORDEREDSET-TABLE" title="表9.60 順序集合集約関数">表 9.60</a>には組み込みのグループ内順序集合集約関数を、一方<a class="xref" href="functions-aggregate.html#FUNCTIONS-HYPOTHETICAL-TABLE" title="表9.61 仮想集合集約関数">表 9.61</a>には組み込みのグループ内仮想集合用の順序集約関数を示します。
<a class="xref" href="functions-aggregate.html#FUNCTIONS-GROUPING-TABLE" title="表9.62 グループ化演算">表 9.62</a>には、集約関数と密接に関係するグループ化演算を示します。
集約関数の特殊な構文に関する考察は<a class="xref" href="sql-expressions.html#SYNTAX-AGGREGATES" title="4.2.7. 集約式">4.2.7</a>で説明されています。
また、初歩的な情報については<a class="xref" href="tutorial-agg.html" title="2.7. 集約関数">2.7</a>を参照して下さい。
  </p><p>
<span class="original">
   Aggregate functions that support &lt;firstterm&gt;Partial Mode&lt;/firstterm&gt;
   are eligible to participate in various optimizations, such as parallel
   aggregation.
</span>
<em class="firstterm">部分モード</em>をサポートする集約関数は並列集約など、様々な最適化に有用です。
  </p><div class="table" id="FUNCTIONS-AGGREGATE-TABLE"><p class="title"><strong>表9.58 汎用集約関数</strong></p><div class="table-contents"><span class="original">
    &lt;title&gt;General-Purpose Aggregate Functions&lt;/title&gt;
</span><table class="table" summary="汎用集約関数" border="1"><colgroup><col class="col1" /><col class="col2" /></colgroup><thead><tr><th class="func_table_entry"><p class="func_signature">
<span class="original">
        Function
</span>
関数
       </p>
       <p>
<span class="original">
        Description
</span>
説明
       </p></th><th>部分モード</th></tr></thead><tbody><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.6.2.4.1.1.1.1" class="indexterm"></a>
        <code class="function">array_agg</code> ( <code class="type">anynonarray</code> )
        → <code class="returnvalue">anyarray</code>
       </p>
       <p>
<span class="original">
        Collects all the input values, including nulls, into an array.
</span>
NULLも含めてすべての入力値を収集して配列に格納します。
       </p></td><td>非</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <code class="function">array_agg</code> ( <code class="type">anyarray</code> )
        → <code class="returnvalue">anyarray</code>
       </p>
       <p>
<span class="original">
        Concatenates all the input arrays into an array of one higher
        dimension.  (The inputs must all have the same dimensionality, and
        cannot be empty or null.)
</span>
すべての入力配列を結合して次元が1高い配列に格納します。
（入力配列はすべて同じ次元数を持ち、空もしくはNULLであってはいけません。）
       </p></td><td>非</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.6.2.4.3.1.1.1" class="indexterm"></a>
        <a id="id-1.5.8.29.6.2.4.3.1.1.2" class="indexterm"></a>
        <code class="function">avg</code> ( <code class="type">smallint</code> )
        → <code class="returnvalue">numeric</code>
       </p>
       <p class="func_signature">
        <code class="function">avg</code> ( <code class="type">integer</code> )
        → <code class="returnvalue">numeric</code>
       </p>
       <p class="func_signature">
        <code class="function">avg</code> ( <code class="type">bigint</code> )
        → <code class="returnvalue">numeric</code>
       </p>
       <p class="func_signature">
        <code class="function">avg</code> ( <code class="type">numeric</code> )
        → <code class="returnvalue">numeric</code>
       </p>
       <p class="func_signature">
        <code class="function">avg</code> ( <code class="type">real</code> )
        → <code class="returnvalue">double precision</code>
       </p>
       <p class="func_signature">
        <code class="function">avg</code> ( <code class="type">double precision</code> )
        → <code class="returnvalue">double precision</code>
       </p>
       <p class="func_signature">
        <code class="function">avg</code> ( <code class="type">interval</code> )
        → <code class="returnvalue">interval</code>
       </p>
       <p>
<span class="original">
        Computes the average (arithmetic mean) of all the non-null input
        values.
</span>
すべての非NULL入力値の平均（算術平均）を計算します。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.6.2.4.4.1.1.1" class="indexterm"></a>
        <code class="function">bit_and</code> ( <code class="type">smallint</code> )
        → <code class="returnvalue">smallint</code>
       </p>
       <p class="func_signature">
        <code class="function">bit_and</code> ( <code class="type">integer</code> )
        → <code class="returnvalue">integer</code>
       </p>
       <p class="func_signature">
        <code class="function">bit_and</code> ( <code class="type">bigint</code> )
        → <code class="returnvalue">bigint</code>
       </p>
       <p class="func_signature">
        <code class="function">bit_and</code> ( <code class="type">bit</code> )
        → <code class="returnvalue">bit</code>
       </p>
       <p>
<span class="original">
        Computes the bitwise AND of all non-null input values.
</span>
全ての非NULLの入力値のビット積を計算します。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.6.2.4.5.1.1.1" class="indexterm"></a>
        <code class="function">bit_or</code> ( <code class="type">smallint</code> )
        → <code class="returnvalue">smallint</code>
       </p>
       <p class="func_signature">
        <code class="function">bit_or</code> ( <code class="type">integer</code> )
        → <code class="returnvalue">integer</code>
       </p>
       <p class="func_signature">
        <code class="function">bit_or</code> ( <code class="type">bigint</code> )
        → <code class="returnvalue">bigint</code>
       </p>
       <p class="func_signature">
        <code class="function">bit_or</code> ( <code class="type">bit</code> )
        → <code class="returnvalue">bit</code>
       </p>
       <p>
<span class="original">
        Computes the bitwise OR of all non-null input values.
</span>
全ての非NULLの入力値のビット和を計算します。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.6.2.4.6.1.1.1" class="indexterm"></a>
        <code class="function">bit_xor</code> ( <code class="type">smallint</code> )
        → <code class="returnvalue">smallint</code>
       </p>
       <p class="func_signature">
        <code class="function">bit_xor</code> ( <code class="type">integer</code> )
        → <code class="returnvalue">integer</code>
       </p>
       <p class="func_signature">
        <code class="function">bit_xor</code> ( <code class="type">bigint</code> )
        → <code class="returnvalue">bigint</code>
       </p>
       <p class="func_signature">
        <code class="function">bit_xor</code> ( <code class="type">bit</code> )
        → <code class="returnvalue">bit</code>
       </p>
       <p>
<span class="original">
        Computes the bitwise exclusive OR of all non-null input values.
        Can be useful as a checksum for an unordered set of values.
</span>
すべての非NULL入力値のビット毎の排他的論理和を計算します。
順序付けられない値の集合のチェックサムとして有用かもしれません。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.6.2.4.7.1.1.1" class="indexterm"></a>
        <code class="function">bool_and</code> ( <code class="type">boolean</code> )
        → <code class="returnvalue">boolean</code>
       </p>
       <p>
<span class="original">
        Returns true if all non-null input values are true, otherwise false.
</span>
全ての入力が真ならば真、そうでなければ偽を返します。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.6.2.4.8.1.1.1" class="indexterm"></a>
        <code class="function">bool_or</code> ( <code class="type">boolean</code> )
        → <code class="returnvalue">boolean</code>
       </p>
       <p>
<span class="original">
        Returns true if any non-null input value is true, otherwise false.
</span>
入力のどれかが真ならば真、そうでなければ偽を返します。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.6.2.4.9.1.1.1" class="indexterm"></a>
        <code class="function">count</code> ( <code class="literal">*</code> )
        → <code class="returnvalue">bigint</code>
       </p>
       <p>
<span class="original">
        Computes the number of input rows.
</span>
入力行数を返します。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <code class="function">count</code> ( <code class="type">"any"</code> )
        → <code class="returnvalue">bigint</code>
       </p>
       <p>
<span class="original">
        Computes the number of input rows in which the input value is not
        null.
</span>
非NULLの入力行数を返します。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.6.2.4.11.1.1.1" class="indexterm"></a>
        <code class="function">every</code> ( <code class="type">boolean</code> )
        → <code class="returnvalue">boolean</code>
       </p>
       <p>
<span class="original">
        This is the SQL standard's equivalent to &lt;function&gt;bool_and&lt;/function&gt;.
</span>
これはSQL標準の<code class="function">bool_and</code>と等価です。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.6.2.4.12.1.1.1" class="indexterm"></a>
        <code class="function">json_agg</code> ( <code class="type">anyelement</code> )
        → <code class="returnvalue">json</code>
       </p>
       <p class="func_signature">
        <a id="id-1.5.8.29.6.2.4.12.1.2.1" class="indexterm"></a>
        <code class="function">jsonb_agg</code> ( <code class="type">anyelement</code> )
        → <code class="returnvalue">jsonb</code>
       </p>
       <p>
<span class="original">
        Collects all the input values, including nulls, into a JSON array.
        Values are converted to JSON as per &lt;function&gt;to_json&lt;/function&gt;
        or &lt;function&gt;to_jsonb&lt;/function&gt;.
</span>
NULLも含めてすべての入力値を収集し、JSON配列に格納します。
入力は<code class="function">to_json</code>あるいは<code class="function">to_jsonb</code>でJSONに変換されます。
       </p></td><td>非</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.6.2.4.13.1.1.1" class="indexterm"></a>
        <code class="function">json_object_agg</code> ( <em class="parameter"><code>key</code></em>
         <code class="type">"any"</code>, <em class="parameter"><code>value</code></em>
         <code class="type">"any"</code> )
        → <code class="returnvalue">json</code>
       </p>
       <p class="func_signature">
        <a id="id-1.5.8.29.6.2.4.13.1.2.1" class="indexterm"></a>
        <code class="function">jsonb_object_agg</code> ( <em class="parameter"><code>key</code></em>
         <code class="type">"any"</code>, <em class="parameter"><code>value</code></em>
         <code class="type">"any"</code> )
        → <code class="returnvalue">jsonb</code>
       </p>
       <p>
<span class="original">
        Collects all the key/value pairs into a JSON object.  Key arguments
        are coerced to text; value arguments are converted as
        per &lt;function&gt;to_json&lt;/function&gt; or &lt;function&gt;to_jsonb&lt;/function&gt;.
        Values can be null, but not keys.
</span>
すべてのキー／値ペアをJSONオブジェクトに格納します。
キー引数はテキストに変換されます。値は<code class="function">to_json</code>あるいは<code class="function">to_jsonb</code>にしたがって変換されます。
値はNULLでも構いませんが、キーはNULLにはできません。
       </p></td><td>非</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.6.2.4.14.1.1.1" class="indexterm"></a>
        <code class="function">max</code> ( <em class="replaceable"><code>see text</code></em> )
        → <code class="returnvalue"><em class="replaceable"><code>same as input type</code></em></code>
       </p>
       <p>
<span class="original">
        Computes the maximum of the non-null input
        values.  Available for any numeric, string, date/time, or enum type,
        as well as &lt;type&gt;inet&lt;/type&gt;, &lt;type&gt;interval&lt;/type&gt;,
        &lt;type&gt;money&lt;/type&gt;, &lt;type&gt;oid&lt;/type&gt;, &lt;type&gt;pg_lsn&lt;/type&gt;,
        &lt;type&gt;tid&lt;/type&gt;, &lt;type&gt;xid8&lt;/type&gt;,
        and arrays of any of these types.
</span>
非NULL入力値の最大を計算します。
数値、文字列、日時、列挙型および<code class="type">inet</code>、<code class="type">interval</code>、<code class="type">money</code>、<code class="type">oid</code>、<code class="type">pg_lsn</code>、<code class="type">tid</code>、<code class="type">xid8</code>、およびこれらすべての配列でも同様に利用できます。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.6.2.4.15.1.1.1" class="indexterm"></a>
        <code class="function">min</code> ( <em class="replaceable"><code>see text</code></em> )
        → <code class="returnvalue"><em class="replaceable"><code>same as input type</code></em></code>
       </p>
       <p>
<span class="original">
        Computes the minimum of the non-null input
        values.  Available for any numeric, string, date/time, or enum type,
        as well as &lt;type&gt;inet&lt;/type&gt;, &lt;type&gt;interval&lt;/type&gt;,
        &lt;type&gt;money&lt;/type&gt;, &lt;type&gt;oid&lt;/type&gt;, &lt;type&gt;pg_lsn&lt;/type&gt;,
        &lt;type&gt;tid&lt;/type&gt;, &lt;type&gt;xid8&lt;/type&gt;,
        and arrays of any of these types.
</span>
非NULL入力値の最小を計算します。
数値、文字列、日時、列挙型および<code class="type">inet</code>、<code class="type">interval</code>、<code class="type">money</code>、<code class="type">oid</code>、<code class="type">pg_lsn</code>、<code class="type">tid</code>、<code class="type">xid8</code>、およびこれらすべての配列でも同様に利用できます。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.6.2.4.16.1.1.1" class="indexterm"></a>
        <code class="function">range_agg</code> ( <em class="parameter"><code>value</code></em>
         <code class="type">anyrange</code> )
        → <code class="returnvalue">anymultirange</code>
       </p>
       <p class="func_signature">
        <code class="function">range_agg</code> ( <em class="parameter"><code>value</code></em>
         <code class="type">anymultirange</code> )
        → <code class="returnvalue">anymultirange</code>
       </p>
       <p>
<span class="original">
        Computes the union of the non-null input values.
</span>
非NULL入力の和を計算します。
       </p></td><td>非</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.6.2.4.17.1.1.1" class="indexterm"></a>
        <code class="function">range_intersect_agg</code> ( <em class="parameter"><code>value</code></em>
         <code class="type">anyrange</code> )
        → <code class="returnvalue">anyrange</code>
       </p>
       <p class="func_signature">
        <code class="function">range_intersect_agg</code> ( <em class="parameter"><code>value</code></em>
         <code class="type">anymultirange</code> )
        → <code class="returnvalue">anymultirange</code>
       </p>
       <p>
<span class="original">
        Computes the intersection of the non-null input values.
</span>
非NULL入力の共通部分を計算します。
       </p></td><td>非</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.6.2.4.18.1.1.1" class="indexterm"></a>
        <code class="function">string_agg</code> ( <em class="parameter"><code>value</code></em>
         <code class="type">text</code>, <em class="parameter"><code>delimiter</code></em> <code class="type">text</code> )
        → <code class="returnvalue">text</code>
       </p>
       <p class="func_signature">
        <code class="function">string_agg</code> ( <em class="parameter"><code>value</code></em>
         <code class="type">bytea</code>, <em class="parameter"><code>delimiter</code></em> <code class="type">bytea</code> )
        → <code class="returnvalue">bytea</code>
       </p>
       <p>
<span class="original">
        Concatenates the non-null input values into a string.  Each value
        after the first is preceded by the
        corresponding &lt;parameter&gt;delimiter&lt;/parameter&gt; (if it's not null).
</span>
非NULL入力を結合して文字列に格納します。
最初の値以降、各値の前に<em class="parameter"><code>delimiter</code></em>で指定した値が（NULLでなければ）追加されます。
       </p></td><td>非</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.6.2.4.19.1.1.1" class="indexterm"></a>
        <code class="function">sum</code> ( <code class="type">smallint</code> )
        → <code class="returnvalue">bigint</code>
       </p>
       <p class="func_signature">
        <code class="function">sum</code> ( <code class="type">integer</code> )
        → <code class="returnvalue">bigint</code>
       </p>
       <p class="func_signature">
        <code class="function">sum</code> ( <code class="type">bigint</code> )
        → <code class="returnvalue">numeric</code>
       </p>
       <p class="func_signature">
        <code class="function">sum</code> ( <code class="type">numeric</code> )
        → <code class="returnvalue">numeric</code>
       </p>
       <p class="func_signature">
        <code class="function">sum</code> ( <code class="type">real</code> )
        → <code class="returnvalue">real</code>
       </p>
       <p class="func_signature">
        <code class="function">sum</code> ( <code class="type">double precision</code> )
        → <code class="returnvalue">double precision</code>
       </p>
       <p class="func_signature">
        <code class="function">sum</code> ( <code class="type">interval</code> )
        → <code class="returnvalue">interval</code>
       </p>
       <p class="func_signature">
        <code class="function">sum</code> ( <code class="type">money</code> )
        → <code class="returnvalue">money</code>
       </p>
       <p>
<span class="original">
        Computes the sum of the non-null input values.
</span>
非NULL入力値の合計を計算します。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.6.2.4.20.1.1.1" class="indexterm"></a>
        <code class="function">xmlagg</code> ( <code class="type">xml</code> )
        → <code class="returnvalue">xml</code>
       </p>
       <p>
<span class="original">
        Concatenates the non-null XML input values (see
        &lt;xref linkend="functions-xml-xmlagg"/&gt;).
</span>
非NULLのXML入力値を結合します。（<a class="xref" href="functions-xml.html#FUNCTIONS-XML-XMLAGG" title="9.15.1.7. xmlagg">9.15.1.7</a>参照。）
       </p></td><td>非</td></tr></tbody></table></div></div><br class="table-break" /><p>
<span class="original">
   It should be noted that except for &lt;function&gt;count&lt;/function&gt;,
   these functions return a null value when no rows are selected.  In
   particular, &lt;function&gt;sum&lt;/function&gt; of no rows returns null, not
   zero as one might expect, and &lt;function&gt;array_agg&lt;/function&gt;
   returns null rather than an empty array when there are no input
   rows.  The &lt;function&gt;coalesce&lt;/function&gt; function can be used to
   substitute zero or an empty array for null when necessary.
</span>
上記の関数は、<code class="function">count</code>関数を除き、1行も選択されなかった場合NULL値を返すことに注意してください。
特に、行の選択がない<code class="function">sum</code>関数は、予想されるであろうゼロではなくNULLを返し、そして<code class="function">array_agg</code>は、入力行が存在しない場合に、空配列ではなくNULLを返します。
必要であれば、NULLをゼロまたは空配列と置換する目的で<code class="function">coalesce</code>関数を使うことができます。
  </p><p>
<span class="original">
   The aggregate functions &lt;function&gt;array_agg&lt;/function&gt;,
   &lt;function&gt;json_agg&lt;/function&gt;, &lt;function&gt;jsonb_agg&lt;/function&gt;,
   &lt;function&gt;json_object_agg&lt;/function&gt;, &lt;function&gt;jsonb_object_agg&lt;/function&gt;,
   &lt;function&gt;string_agg&lt;/function&gt;,
   and &lt;function&gt;xmlagg&lt;/function&gt;, as well as similar user-defined
   aggregate functions, produce meaningfully different result values
   depending on the order of the input values.  This ordering is
   unspecified by default, but can be controlled by writing an
   &lt;literal&gt;ORDER BY&lt;/literal&gt; clause within the aggregate call, as shown in
   &lt;xref linkend="syntax-aggregates"/&gt;.
   Alternatively, supplying the input values from a sorted subquery
   will usually work.  For example:
</span>
集約関数<code class="function">array_agg</code>、<code class="function">json_agg</code>、<code class="function">jsonb_agg</code>、<code class="function">json_object_agg</code>、<code class="function">jsonb_object_agg</code>、<code class="function">string_agg</code>、および<code class="function">xmlagg</code>、そして類似のユーザ定義の集約関数は、入力値の順序に依存した意味のある別の結果値を生成します。
この並び順はデフォルトでは指定されませんが、<a class="xref" href="sql-expressions.html#SYNTAX-AGGREGATES" title="4.2.7. 集約式">4.2.7</a>に記述されているように、集計呼び出し中に<code class="literal">ORDER BY</code>句を書くことで制御可能となります。別の方法として、並び替えられた副問い合わせから入力値を供給することでも上手くいきます。
例をあげます。

</p><pre class="screen">
SELECT xmlagg(x) FROM (SELECT x FROM test ORDER BY y DESC) AS tab;
</pre><p>

<span class="original">
   Beware that this approach can fail if the outer query level contains
   additional processing, such as a join, because that might cause the
   subquery's output to be reordered before the aggregate is computed.
</span>
外側の問い合わせのレベルで結合などの追加処理がある場合、この方法は失敗するかもしれないことに注意して下さい。
なぜなら、集約の計算の前に副問い合わせの出力を並べ替える必要があるかも知れないからです。
  </p><div class="note"><h3 class="title">注記</h3><a id="id-1.5.8.29.9.1" class="indexterm"></a><a id="id-1.5.8.29.9.2" class="indexterm"></a><p>
<span class="original">
      The boolean aggregates &lt;function&gt;bool_and&lt;/function&gt; and
      &lt;function&gt;bool_or&lt;/function&gt; correspond to the standard SQL aggregates
      &lt;function&gt;every&lt;/function&gt; and &lt;function&gt;any&lt;/function&gt; or
      &lt;function&gt;some&lt;/function&gt;.
      &lt;productname&gt;PostgreSQL&lt;/productname&gt;
      supports &lt;function&gt;every&lt;/function&gt;, but not &lt;function&gt;any&lt;/function&gt;
      or &lt;function&gt;some&lt;/function&gt;, because there is an ambiguity built into
      the standard syntax:
</span>
<code class="function">bool_and</code>、<code class="function">bool_or</code>論理集約関数は標準SQLの集約関数<code class="function">every</code>、<code class="function">any</code>または<code class="function">some</code>に対応します。
<span class="productname">PostgreSQL</span>は<code class="function">every</code>をサポートしますが、<code class="function">any</code>、あるいは<code class="function">some</code>はサポートしません。
<code class="function">any</code>と<code class="function">some</code>の標準の構文には曖昧さがあるからです。
</p><pre class="programlisting">
SELECT b1 = ANY((SELECT b2 FROM t2 ...)) FROM t1 ...;
</pre><p>
<span class="original">
      Here &lt;function&gt;ANY&lt;/function&gt; can be considered either as introducing
      a subquery, or as being an aggregate function, if the subquery
      returns one row with a Boolean value.
      Thus the standard name cannot be given to these aggregates.
</span>
ここで、副問い合わせが論理値での１行を返す場合、<code class="function">ANY</code>は副問い合わせを導入するもの、もしくは集約関数であるものいずれかとみなすことができます。
従って、これらの集約関数に標準の名前を付けることはできません。
    </p></div><div class="note"><h3 class="title">注記</h3><p>
<span class="original">
    Users accustomed to working with other SQL database management
    systems might be disappointed by the performance of the
    &lt;function&gt;count&lt;/function&gt; aggregate when it is applied to the
    entire table. A query like:
</span>
他のSQLデータベース管理システムでの作業に親しんだユーザは、<code class="function">count</code>集約関数がテーブル全体に適用される場合の性能に失望するかも知れません。
</p><pre class="programlisting">
SELECT count(*) FROM sometable;
</pre><p>
<span class="original">
    will require effort proportional to the size of the table:
    &lt;productname&gt;PostgreSQL&lt;/productname&gt; will need to scan either the
    entire table or the entirety of an index that includes all rows in
    the table.
</span>
のような問い合わせはテーブルサイズに比例した労力が必要です。<span class="productname">PostgreSQL</span>はテーブル全体か、そのテーブルの全ての行を含んだインデックス全体のスキャンを必要とします。
   </p></div><p>
<span class="original">
   &lt;xref linkend="functions-aggregate-statistics-table"/&gt; shows
   aggregate functions typically used in statistical analysis.
   (These are separated out merely to avoid cluttering the listing
   of more-commonly-used aggregates.)  Functions shown as
   accepting &lt;replaceable&gt;numeric_type&lt;/replaceable&gt; are available for all
   the types &lt;type&gt;smallint&lt;/type&gt;, &lt;type&gt;integer&lt;/type&gt;,
   &lt;type&gt;bigint&lt;/type&gt;, &lt;type&gt;numeric&lt;/type&gt;, &lt;type&gt;real&lt;/type&gt;,
   and &lt;type&gt;double precision&lt;/type&gt;.
   Where the description mentions
   &lt;parameter&gt;N&lt;/parameter&gt;, it means the
   number of input rows for which all the input expressions are non-null.
   In all cases, null is returned if the computation is meaningless,
   for example when &lt;parameter&gt;N&lt;/parameter&gt; is zero.
</span>
統計解析処理によく使用される集約関数を<a class="xref" href="functions-aggregate.html#FUNCTIONS-AGGREGATE-STATISTICS-TABLE" title="表9.59 統計処理用の集約関数">表 9.59</a>に示します。
（これらは、より一般的に使用される集約関数との混乱を防ぐために別出ししました。）
<em class="replaceable"><code>numeric_type</code></em>を受け付けると表示されている関数は、<code class="type">smallint</code>、<code class="type">integer</code>、<code class="type">bigint</code>、<code class="type">numeric</code>、<code class="type">real</code>、<code class="type">double precision</code>のすべての型で利用可能です。
説明の部分における<em class="parameter"><code>N</code></em>は、すべての入力式が非NULLの入力行の個数を表します。
すべての場合にて、例えば<em class="parameter"><code>N</code></em>が0の時など計算が無意味である場合にはNULLが返されます。
  </p><a id="id-1.5.8.29.12" class="indexterm"></a><a id="id-1.5.8.29.13" class="indexterm"></a><div class="table" id="FUNCTIONS-AGGREGATE-STATISTICS-TABLE"><p class="title"><strong>表9.59 統計処理用の集約関数</strong></p><div class="table-contents"><span class="original">
    &lt;title&gt;Aggregate Functions for Statistics&lt;/title&gt;
</span><table class="table" summary="統計処理用の集約関数" border="1"><colgroup><col class="col1" /><col class="col2" /></colgroup><thead><tr><th class="func_table_entry"><p class="func_signature">
<span class="original">
        Function
</span>
関数
       </p>
       <p>
<span class="original">
        Description
</span>
説明
       </p></th><th>部分モード</th></tr></thead><tbody><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.14.2.4.1.1.1.1" class="indexterm"></a>
        <a id="id-1.5.8.29.14.2.4.1.1.1.2" class="indexterm"></a>
        <a id="id-1.5.8.29.14.2.4.1.1.1.3" class="indexterm"></a>
        <code class="function">corr</code> ( <em class="parameter"><code>Y</code></em> <code class="type">double precision</code>, <em class="parameter"><code>X</code></em> <code class="type">double precision</code> )
        → <code class="returnvalue">double precision</code>
       </p>
       <p>
<span class="original">
        Computes the correlation coefficient.
</span>
相関係数を計算します。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.14.2.4.2.1.1.1" class="indexterm"></a>
        <a id="id-1.5.8.29.14.2.4.2.1.1.2" class="indexterm"></a>
        <a id="id-1.5.8.29.14.2.4.2.1.1.3" class="indexterm"></a>
        <code class="function">covar_pop</code> ( <em class="parameter"><code>Y</code></em> <code class="type">double precision</code>, <em class="parameter"><code>X</code></em> <code class="type">double precision</code> )
        → <code class="returnvalue">double precision</code>
       </p>
       <p>
<span class="original">
        Computes the population covariance.
</span>
母共分散を計算します。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.14.2.4.3.1.1.1" class="indexterm"></a>
        <a id="id-1.5.8.29.14.2.4.3.1.1.2" class="indexterm"></a>
        <a id="id-1.5.8.29.14.2.4.3.1.1.3" class="indexterm"></a>
        <code class="function">covar_samp</code> ( <em class="parameter"><code>Y</code></em> <code class="type">double precision</code>, <em class="parameter"><code>X</code></em> <code class="type">double precision</code> )
        → <code class="returnvalue">double precision</code>
       </p>
       <p>
<span class="original">
        Computes the sample covariance.
</span>
標本の共分散を計算します。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.14.2.4.4.1.1.1" class="indexterm"></a>
        <code class="function">regr_avgx</code> ( <em class="parameter"><code>Y</code></em> <code class="type">double precision</code>, <em class="parameter"><code>X</code></em> <code class="type">double precision</code> )
        → <code class="returnvalue">double precision</code>
       </p>
       <p>
<span class="original">
        Computes the average of the independent variable,
        &lt;literal&gt;sum(&lt;parameter&gt;X&lt;/parameter&gt;)/&lt;parameter&gt;N&lt;/parameter&gt;&lt;/literal&gt;.
</span>
独立変数の平均値を計算します。
        <code class="literal">sum(<em class="parameter"><code>X</code></em>)/<em class="parameter"><code>N</code></em></code>.
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.14.2.4.5.1.1.1" class="indexterm"></a>
        <code class="function">regr_avgy</code> ( <em class="parameter"><code>Y</code></em> <code class="type">double precision</code>, <em class="parameter"><code>X</code></em> <code class="type">double precision</code> )
        → <code class="returnvalue">double precision</code>
       </p>
       <p>
<span class="original">
        Computes the average of the dependent variable,
        &lt;literal&gt;sum(&lt;parameter&gt;Y&lt;/parameter&gt;)/&lt;parameter&gt;N&lt;/parameter&gt;&lt;/literal&gt;.
</span>
従属変数の平均値を計算します。
        <code class="literal">sum(<em class="parameter"><code>Y</code></em>)/<em class="parameter"><code>N</code></em></code>.
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.14.2.4.6.1.1.1" class="indexterm"></a>
        <code class="function">regr_count</code> ( <em class="parameter"><code>Y</code></em> <code class="type">double precision</code>, <em class="parameter"><code>X</code></em> <code class="type">double precision</code> )
        → <code class="returnvalue">bigint</code>
       </p>
       <p>
<span class="original">
        Computes the number of rows in which both inputs are non-null.
</span>
両方の入力が非NULLとなる行数を計算します。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.14.2.4.7.1.1.1" class="indexterm"></a>
        <a id="id-1.5.8.29.14.2.4.7.1.1.2" class="indexterm"></a>
        <a id="id-1.5.8.29.14.2.4.7.1.1.3" class="indexterm"></a>
        <code class="function">regr_intercept</code> ( <em class="parameter"><code>Y</code></em> <code class="type">double precision</code>, <em class="parameter"><code>X</code></em> <code class="type">double precision</code> )
        → <code class="returnvalue">double precision</code>
       </p>
       <p>
<span class="original">
        Computes the y-intercept of the least-squares-fit linear equation
        determined by the
        (&lt;parameter&gt;X&lt;/parameter&gt;, &lt;parameter&gt;Y&lt;/parameter&gt;) pairs.
</span>
(<em class="parameter"><code>X</code></em>, <em class="parameter"><code>Y</code></em>)の組み合わせで決まる、最小二乗法による線形方程式のY切片を計算します。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.14.2.4.8.1.1.1" class="indexterm"></a>
        <code class="function">regr_r2</code> ( <em class="parameter"><code>Y</code></em> <code class="type">double precision</code>, <em class="parameter"><code>X</code></em> <code class="type">double precision</code> )
        → <code class="returnvalue">double precision</code>
       </p>
       <p>
<span class="original">
        Computes the square of the correlation coefficient.
</span>
相関係数の二乗を計算します。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.14.2.4.9.1.1.1" class="indexterm"></a>
        <a id="id-1.5.8.29.14.2.4.9.1.1.2" class="indexterm"></a>
        <a id="id-1.5.8.29.14.2.4.9.1.1.3" class="indexterm"></a>
        <code class="function">regr_slope</code> ( <em class="parameter"><code>Y</code></em> <code class="type">double precision</code>, <em class="parameter"><code>X</code></em> <code class="type">double precision</code> )
        → <code class="returnvalue">double precision</code>
       </p>
       <p>
<span class="original">
        Computes the slope of the least-squares-fit linear equation determined
        by the (&lt;parameter&gt;X&lt;/parameter&gt;, &lt;parameter&gt;Y&lt;/parameter&gt;)
        pairs.
</span>
(<em class="parameter"><code>X</code></em>, <em class="parameter"><code>Y</code></em>)の組み合わせで決まる、最小二乗法による線型方程式の勾配を計算します。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.14.2.4.10.1.1.1" class="indexterm"></a>
        <code class="function">regr_sxx</code> ( <em class="parameter"><code>Y</code></em> <code class="type">double precision</code>, <em class="parameter"><code>X</code></em> <code class="type">double precision</code> )
        → <code class="returnvalue">double precision</code>
       </p>
       <p>
<span class="original">
        Computes the &lt;quote&gt;sum of squares&lt;/quote&gt; of the independent
        variable,
        &lt;literal&gt;sum(&lt;parameter&gt;X&lt;/parameter&gt;^2) - sum(&lt;parameter&gt;X&lt;/parameter&gt;)^2/&lt;parameter&gt;N&lt;/parameter&gt;&lt;/literal&gt;.
</span>
独立変数の<span class="quote">「<span class="quote">二乗和</span>」</span>、<code class="literal">sum(<em class="parameter"><code>X</code></em>^2) - sum(<em class="parameter"><code>X</code></em>)^2/<em class="parameter"><code>N</code></em></code>を計算します。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.14.2.4.11.1.1.1" class="indexterm"></a>
        <code class="function">regr_sxy</code> ( <em class="parameter"><code>Y</code></em> <code class="type">double precision</code>, <em class="parameter"><code>X</code></em> <code class="type">double precision</code> )
        → <code class="returnvalue">double precision</code>
       </p>
       <p>
<span class="original">
        Computes the &lt;quote&gt;sum of products&lt;/quote&gt; of independent times
        dependent variables,
        &lt;literal&gt;sum(&lt;parameter&gt;X&lt;/parameter&gt;*&lt;parameter&gt;Y&lt;/parameter&gt;) - sum(&lt;parameter&gt;X&lt;/parameter&gt;) * sum(&lt;parameter&gt;Y&lt;/parameter&gt;)/&lt;parameter&gt;N&lt;/parameter&gt;&lt;/literal&gt;.
</span>
独立変数と従属変数の<span class="quote">「<span class="quote">積の和</span>」</span>、<code class="literal">sum(<em class="parameter"><code>X</code></em>*<em class="parameter"><code>Y</code></em>) - sum(<em class="parameter"><code>X</code></em>) * sum(<em class="parameter"><code>Y</code></em>)/<em class="parameter"><code>N</code></em></code>を計算します。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.14.2.4.12.1.1.1" class="indexterm"></a>
        <code class="function">regr_syy</code> ( <em class="parameter"><code>Y</code></em> <code class="type">double precision</code>, <em class="parameter"><code>X</code></em> <code class="type">double precision</code> )
        → <code class="returnvalue">double precision</code>
       </p>
       <p>
<span class="original">
        Computes the &lt;quote&gt;sum of squares&lt;/quote&gt; of the dependent
        variable,
        &lt;literal&gt;sum(&lt;parameter&gt;Y&lt;/parameter&gt;^2) - sum(&lt;parameter&gt;Y&lt;/parameter&gt;)^2/&lt;parameter&gt;N&lt;/parameter&gt;&lt;/literal&gt;.
</span>
従属変数の<span class="quote">「<span class="quote">積の和</span>」</span>、<code class="literal">sum(<em class="parameter"><code>Y</code></em>^2) - sum(<em class="parameter"><code>Y</code></em>)^2/<em class="parameter"><code>N</code></em></code>を計算します。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.14.2.4.13.1.1.1" class="indexterm"></a>
        <a id="id-1.5.8.29.14.2.4.13.1.1.2" class="indexterm"></a>
        <a id="id-1.5.8.29.14.2.4.13.1.1.3" class="indexterm"></a>
        <code class="function">stddev</code> ( <em class="replaceable"><code>numeric_type</code></em> )
<span class="original">
        &lt;returnvalue&gt;&lt;/returnvalue&gt; &lt;type&gt;double precision&lt;/type&gt;
        for &lt;type&gt;real&lt;/type&gt; or &lt;type&gt;double precision&lt;/type&gt;,
        otherwise &lt;type&gt;numeric&lt;/type&gt;
</span>
        → <code class="returnvalue"></code> 引数が<code class="type">double precision</code>あるいは<code class="type">real</code>に対しては<code class="type">double precision</code>、それ以外は<code class="type">numeric</code>
       </p>
       <p>
<span class="original">
        This is a historical alias for &lt;function&gt;stddev_samp&lt;/function&gt;.
</span>
これは<code class="function">stddev_samp</code>の歴史的な別名です。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.14.2.4.14.1.1.1" class="indexterm"></a>
        <a id="id-1.5.8.29.14.2.4.14.1.1.2" class="indexterm"></a>
        <a id="id-1.5.8.29.14.2.4.14.1.1.3" class="indexterm"></a>
        <code class="function">stddev_pop</code> ( <em class="replaceable"><code>numeric_type</code></em> )
<span class="original">
        &lt;returnvalue&gt;&lt;/returnvalue&gt; &lt;type&gt;double precision&lt;/type&gt;
        for &lt;type&gt;real&lt;/type&gt; or &lt;type&gt;double precision&lt;/type&gt;,
        otherwise &lt;type&gt;numeric&lt;/type&gt;
</span>
        → <code class="returnvalue"></code> 引数が<code class="type">double precision</code>あるいは<code class="type">real</code>に対しては<code class="type">double precision</code>、それ以外は<code class="type">numeric</code>
       </p>
       <p>
<span class="original">
        Computes the population standard deviation of the input values.
</span>
入力値の母標準偏差を計算します。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.14.2.4.15.1.1.1" class="indexterm"></a>
        <a id="id-1.5.8.29.14.2.4.15.1.1.2" class="indexterm"></a>
        <a id="id-1.5.8.29.14.2.4.15.1.1.3" class="indexterm"></a>
        <code class="function">stddev_samp</code> ( <em class="replaceable"><code>numeric_type</code></em> )
<span class="original">
        &lt;returnvalue&gt;&lt;/returnvalue&gt; &lt;type&gt;double precision&lt;/type&gt;
        for &lt;type&gt;real&lt;/type&gt; or &lt;type&gt;double precision&lt;/type&gt;,
        otherwise &lt;type&gt;numeric&lt;/type&gt;
</span>
        → <code class="returnvalue"></code> 引数が<code class="type">double precision</code>あるいは<code class="type">real</code>に対しては<code class="type">double precision</code>、それ以外は<code class="type">numeric</code>
       </p>
       <p>
<span class="original">
        Computes the sample standard deviation of the input values.
</span>
入力値の標本標準偏差を計算します。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.14.2.4.16.1.1.1" class="indexterm"></a>
        <code class="function">variance</code> ( <em class="replaceable"><code>numeric_type</code></em> )
<span class="original">
        &lt;returnvalue&gt;&lt;/returnvalue&gt; &lt;type&gt;double precision&lt;/type&gt;
        for &lt;type&gt;real&lt;/type&gt; or &lt;type&gt;double precision&lt;/type&gt;,
        otherwise &lt;type&gt;numeric&lt;/type&gt;
</span>
        → <code class="returnvalue"></code> 引数が<code class="type">double precision</code>あるいは<code class="type">real</code>に対しては<code class="type">double precision</code>、それ以外は<code class="type">numeric</code>
       </p>
       <p>
<span class="original">
        This is a historical alias for &lt;function&gt;var_samp&lt;/function&gt;.
</span>
これは<code class="function">var_samp</code>の歴史的な別名です。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.14.2.4.17.1.1.1" class="indexterm"></a>
        <a id="id-1.5.8.29.14.2.4.17.1.1.2" class="indexterm"></a>
        <a id="id-1.5.8.29.14.2.4.17.1.1.3" class="indexterm"></a>
        <code class="function">var_pop</code> ( <em class="replaceable"><code>numeric_type</code></em> )
<span class="original">
        &lt;returnvalue&gt;&lt;/returnvalue&gt; &lt;type&gt;double precision&lt;/type&gt;
        for &lt;type&gt;real&lt;/type&gt; or &lt;type&gt;double precision&lt;/type&gt;,
        otherwise &lt;type&gt;numeric&lt;/type&gt;
</span>
        → <code class="returnvalue"></code> 引数が<code class="type">double precision</code>あるいは<code class="type">real</code>に対しては<code class="type">double precision</code>、それ以外は<code class="type">numeric</code>
       </p>
       <p>
<span class="original">
        Computes the population variance of the input values (square of the
        population standard deviation).
</span>
入力値の母分散（母標準偏差の二乗）を計算します。
       </p></td><td>可</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.14.2.4.18.1.1.1" class="indexterm"></a>
        <a id="id-1.5.8.29.14.2.4.18.1.1.2" class="indexterm"></a>
        <a id="id-1.5.8.29.14.2.4.18.1.1.3" class="indexterm"></a>
        <code class="function">var_samp</code> ( <em class="replaceable"><code>numeric_type</code></em> )
<span class="original">
        &lt;returnvalue&gt;&lt;/returnvalue&gt; &lt;type&gt;double precision&lt;/type&gt;
        for &lt;type&gt;real&lt;/type&gt; or &lt;type&gt;double precision&lt;/type&gt;,
        otherwise &lt;type&gt;numeric&lt;/type&gt;
</span>
        → <code class="returnvalue"></code> 引数が<code class="type">double precision</code>あるいは<code class="type">real</code>に対しては<code class="type">double precision</code>、それ以外は<code class="type">numeric</code>
       </p>
       <p>
<span class="original">
        Computes the sample variance of the input values (square of the sample
        standard deviation).
</span>
入力値の標本分散（標本標準偏差の二乗）を計算します。
       </p></td><td>可</td></tr></tbody></table></div></div><br class="table-break" /><p>
<span class="original">
   &lt;xref linkend="functions-orderedset-table"/&gt; shows some
   aggregate functions that use the &lt;firstterm&gt;ordered-set aggregate&lt;/firstterm&gt;
   syntax.  These functions are sometimes referred to as &lt;quote&gt;inverse
   distribution&lt;/quote&gt; functions.  Their aggregated input is introduced by
   &lt;literal&gt;ORDER BY&lt;/literal&gt;, and they may also take a &lt;firstterm&gt;direct
   argument&lt;/firstterm&gt; that is not aggregated, but is computed only once.
   All these functions ignore null values in their aggregated input.
   For those that take a &lt;parameter&gt;fraction&lt;/parameter&gt; parameter, the
   fraction value must be between 0 and 1; an error is thrown if not.
   However, a null &lt;parameter&gt;fraction&lt;/parameter&gt; value simply produces a
   null result.
</span>
<a class="xref" href="functions-aggregate.html#FUNCTIONS-ORDEREDSET-TABLE" title="表9.60 順序集合集約関数">表 9.60</a>に<em class="firstterm">順序集合集約</em>構文を使う集約関数を示します。
これらの関数は<span class="quote">「<span class="quote">逆分散</span>」</span>関数として参照されることがあります。
これらの集約入力は<code class="literal">ORDER BY</code>で導入され、集約ではない<em class="firstterm">direct argument</em>を取ることもでき、一度だけ計算されます。
<em class="parameter"><code>fraction</code></em>パラメータを取る関数では、その値は0と1の間でなければなりません。そうでなければエラーが生じます。
ただしNULLの<em class="parameter"><code>fraction</code></em>値は単にNULLの結果をもたらします。
  </p><a id="id-1.5.8.29.16" class="indexterm"></a><a id="id-1.5.8.29.17" class="indexterm"></a><a id="id-1.5.8.29.18" class="indexterm"></a><a id="id-1.5.8.29.19" class="indexterm"></a><div class="table" id="FUNCTIONS-ORDEREDSET-TABLE"><p class="title"><strong>表9.60 順序集合集約関数</strong></p><div class="table-contents"><span class="original">
    &lt;title&gt;Ordered-Set Aggregate Functions&lt;/title&gt;
</span><table class="table" summary="順序集合集約関数" border="1"><colgroup><col class="col1" /><col class="col2" /></colgroup><thead><tr><th class="func_table_entry"><p class="func_signature">
<span class="original">
        Function
</span>
関数
       </p>
       <p>
<span class="original">
        Description
</span>
説明
       </p></th><th>部分モード</th></tr></thead><tbody><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.20.2.4.1.1.1.1" class="indexterm"></a>
        <a id="id-1.5.8.29.20.2.4.1.1.1.2" class="indexterm"></a>
        <code class="function">mode</code> () <code class="literal">WITHIN GROUP</code> ( <code class="literal">ORDER BY</code> <code class="type">anyelement</code> )
        → <code class="returnvalue">anyelement</code>
       </p>
       <p>
<span class="original">
        Computes the &lt;firstterm&gt;mode&lt;/firstterm&gt;, the most frequent
        value of the aggregated argument (arbitrarily choosing the first one
        if there are multiple equally-frequent values).  The aggregated
        argument must be of a sortable type.
</span>
集約引数の<em class="firstterm">最頻値</em>、最も頻出する値（複数の同じ度数の結果があれば、任意に選んだ最初のもの）を計算します。
集約引数はソート可能な型でなければなりません。
       </p></td><td>非</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.20.2.4.2.1.1.1" class="indexterm"></a>
        <a id="id-1.5.8.29.20.2.4.2.1.1.2" class="indexterm"></a>
        <code class="function">percentile_cont</code> ( <em class="parameter"><code>fraction</code></em> <code class="type">double precision</code> ) <code class="literal">WITHIN GROUP</code> ( <code class="literal">ORDER BY</code> <code class="type">double precision</code> )
        → <code class="returnvalue">double precision</code>
       </p>
       <p class="func_signature">
        <code class="function">percentile_cont</code> ( <em class="parameter"><code>fraction</code></em> <code class="type">double precision</code> ) <code class="literal">WITHIN GROUP</code> ( <code class="literal">ORDER BY</code> <code class="type">interval</code> )
        → <code class="returnvalue">interval</code>
       </p>
       <p>
<span class="original">
        Computes the &lt;firstterm&gt;continuous percentile&lt;/firstterm&gt;, a value
        corresponding to the specified &lt;parameter&gt;fraction&lt;/parameter&gt;
        within the ordered set of aggregated argument values.  This will
        interpolate between adjacent input items if needed.
</span>
<em class="firstterm">連続百分位数</em>、引数の値の順序付け集合中で指定された<em class="parameter"><code>fraction</code></em>に対応する値を計算します。
これは必要なら隣り合う入力項目を補間します。
       </p></td><td>非</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <code class="function">percentile_cont</code> ( <em class="parameter"><code>fractions</code></em> <code class="type">double precision[]</code> ) <code class="literal">WITHIN GROUP</code> ( <code class="literal">ORDER BY</code> <code class="type">double precision</code> )
        → <code class="returnvalue">double precision[]</code>
       </p>
       <p class="func_signature">
        <code class="function">percentile_cont</code> ( <em class="parameter"><code>fractions</code></em> <code class="type">double precision[]</code> ) <code class="literal">WITHIN GROUP</code> ( <code class="literal">ORDER BY</code> <code class="type">interval</code> )
        → <code class="returnvalue">interval[]</code>
       </p>
       <p>
<span class="original">
        Computes multiple continuous percentiles.  The result is an array of
        the same dimensions as the &lt;parameter&gt;fractions&lt;/parameter&gt;
        parameter, with each non-null element replaced by the (possibly
        interpolated) value corresponding to that percentile.
</span>
複数の連続百分位数を計算します。
結果は<em class="parameter"><code>fractions</code></em>パラメータと同じ次元数の配列です。各非NULL要素は（必要なら隣り合う入力項目を補間して）その百分位数に対応する値で置き換えられます。
       </p></td><td>非</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.20.2.4.4.1.1.1" class="indexterm"></a>
        <a id="id-1.5.8.29.20.2.4.4.1.1.2" class="indexterm"></a>
        <code class="function">percentile_disc</code> ( <em class="parameter"><code>fraction</code></em> <code class="type">double precision</code> ) <code class="literal">WITHIN GROUP</code> ( <code class="literal">ORDER BY</code> <code class="type">anyelement</code> )
        → <code class="returnvalue">anyelement</code>
       </p>
       <p>
<span class="original">
        Computes the &lt;firstterm&gt;discrete percentile&lt;/firstterm&gt;, the first
        value within the ordered set of aggregated argument values whose
        position in the ordering equals or exceeds the
        specified &lt;parameter&gt;fraction&lt;/parameter&gt;.  The aggregated
        argument must be of a sortable type.
</span>
<em class="firstterm">離散百分位数</em>を計算します。集約引数の順序付け集合中で、その位置が指定した<em class="parameter"><code>fraction</code></em>と等しいか越えた最初の値です。
集約引数はソート可能な型でなければなりません。
       </p></td><td>非</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <code class="function">percentile_disc</code> ( <em class="parameter"><code>fractions</code></em> <code class="type">double precision[]</code> ) <code class="literal">WITHIN GROUP</code> ( <code class="literal">ORDER BY</code> <code class="type">anyelement</code> )
        → <code class="returnvalue">anyarray</code>
       </p>
       <p>
<span class="original">
        Computes multiple discrete percentiles.  The result is an array of the
        same dimensions as the &lt;parameter&gt;fractions&lt;/parameter&gt; parameter,
        with each non-null element replaced by the input value corresponding
        to that percentile.
        The aggregated argument must be of a sortable type.
</span>
複数の離散百分位数を計算します
結果は<em class="parameter"><code>fractions</code></em>パラメータと同じ次元数の配列です。各非NULL要素はその百分位数に対応する値で置き換えられます。
集約引数はソート可能な型でなければなりません。
       </p></td><td>非</td></tr></tbody></table></div></div><br class="table-break" /><a id="id-1.5.8.29.21" class="indexterm"></a><a id="id-1.5.8.29.22" class="indexterm"></a><p>
<span class="original">
   Each of the &lt;quote&gt;hypothetical-set&lt;/quote&gt; aggregates listed in
   &lt;xref linkend="functions-hypothetical-table"/&gt; is associated with a
   window function of the same name defined in
   &lt;xref linkend="functions-window"/&gt;.  In each case, the aggregate's result
   is the value that the associated window function would have
   returned for the &lt;quote&gt;hypothetical&lt;/quote&gt; row constructed from
   &lt;replaceable&gt;args&lt;/replaceable&gt;, if such a row had been added to the sorted
   group of rows represented by the &lt;replaceable&gt;sorted_args&lt;/replaceable&gt;.
   For each of these functions, the list of direct arguments
   given in &lt;replaceable&gt;args&lt;/replaceable&gt; must match the number and types of
   the aggregated arguments given in &lt;replaceable&gt;sorted_args&lt;/replaceable&gt;.
   Unlike most built-in aggregates, these aggregates are not strict, that is
   they do not drop input rows containing nulls.  Null values sort according
   to the rule specified in the &lt;literal&gt;ORDER BY&lt;/literal&gt; clause.
</span>
<a class="xref" href="functions-aggregate.html#FUNCTIONS-HYPOTHETICAL-TABLE" title="表9.61 仮想集合集約関数">表 9.61</a>に列挙されている<span class="quote">「<span class="quote">仮想集合</span>」</span>集約は、それぞれ<a class="xref" href="functions-window.html" title="9.22. ウィンドウ関数">9.22</a>で定義されている同じ名前のウィンドウ関数と関連します。
どの場合も、集約結果は、<em class="replaceable"><code>args</code></em>から構築される<span class="quote">「<span class="quote">仮想的な</span>」</span>行に対して、関連するウィンドウ関数が返す値で、そのような行が<em class="replaceable"><code>sorted_args</code></em>から計算されるソートされた行のグループに追加される場合を想定します。
これらの関数に対して<em class="replaceable"><code>args</code></em>で与えられる直接引数のリストは、<em class="replaceable"><code>sorted_args</code></em>で与えられる集約された引数の数と型に一致しなければなりません。
ほとんどの組み込み集約とは異なり、この集約はSTRICTではありません、すなわち、NULLを含む入力行を落としません。
NULL値は<code class="literal">ORDER BY</code>節で指定されるルールに従って並べられます。
  </p><div class="table" id="FUNCTIONS-HYPOTHETICAL-TABLE"><p class="title"><strong>表9.61 仮想集合集約関数</strong></p><div class="table-contents"><span class="original">
    &lt;title&gt;Hypothetical-Set Aggregate Functions&lt;/title&gt;
</span><table class="table" summary="仮想集合集約関数" border="1"><colgroup><col class="col1" /><col class="col2" /></colgroup><thead><tr><th class="func_table_entry"><p class="func_signature">
<span class="original">
        Function
</span>
関数
       </p>
       <p>
<span class="original">
        Description
</span>
説明
       </p></th><th>部分モード</th></tr></thead><tbody><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.24.2.4.1.1.1.1" class="indexterm"></a>
        <a id="id-1.5.8.29.24.2.4.1.1.1.2" class="indexterm"></a>
        <code class="function">rank</code> ( <em class="replaceable"><code>args</code></em> ) <code class="literal">WITHIN GROUP</code> ( <code class="literal">ORDER BY</code> <em class="replaceable"><code>sorted_args</code></em> )
        → <code class="returnvalue">bigint</code>
       </p>
       <p>
<span class="original">
        Computes the rank of the hypothetical row, with gaps; that is, the row
        number of the first row in its peer group.
</span>
重複する行のギャップを含む仮想の行の順位を計算します。すなわち、ピアグループの先頭の行の番号です。
       </p></td><td>非</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.24.2.4.2.1.1.1" class="indexterm"></a>
        <a id="id-1.5.8.29.24.2.4.2.1.1.2" class="indexterm"></a>
        <code class="function">dense_rank</code> ( <em class="replaceable"><code>args</code></em> ) <code class="literal">WITHIN GROUP</code> ( <code class="literal">ORDER BY</code> <em class="replaceable"><code>sorted_args</code></em> )
        → <code class="returnvalue">bigint</code>
       </p>
       <p>
<span class="original">
        Computes the rank of the hypothetical row, without gaps; this function
        effectively counts peer groups.
</span>
重複する行のギャップなしの仮想の行の順位を計算します。この関数は実効的にピアグループを数えます。
       </p></td><td>非</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.24.2.4.3.1.1.1" class="indexterm"></a>
        <a id="id-1.5.8.29.24.2.4.3.1.1.2" class="indexterm"></a>
        <code class="function">percent_rank</code> ( <em class="replaceable"><code>args</code></em> ) <code class="literal">WITHIN GROUP</code> ( <code class="literal">ORDER BY</code> <em class="replaceable"><code>sorted_args</code></em> )
        → <code class="returnvalue">double precision</code>
       </p>
       <p>
<span class="original">
        Computes the relative rank of the hypothetical row, that is
        (&lt;function&gt;rank&lt;/function&gt; - 1) / (total rows - 1).
        The value thus ranges from 0 to 1 inclusive.
</span>
仮想行の相対的な順位を計算します。すなわち、(<code class="function">rank</code> - 1) / (total rows - 1)です。
ですから値の範囲は境界を含んで0から1までです。
       </p></td><td>非</td></tr><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.24.2.4.4.1.1.1" class="indexterm"></a>
        <a id="id-1.5.8.29.24.2.4.4.1.1.2" class="indexterm"></a>
        <code class="function">cume_dist</code> ( <em class="replaceable"><code>args</code></em> ) <code class="literal">WITHIN GROUP</code> ( <code class="literal">ORDER BY</code> <em class="replaceable"><code>sorted_args</code></em> )
        → <code class="returnvalue">double precision</code>
       </p>
       <p>
<span class="original">
        Computes the cumulative distribution, that is (number of rows
        preceding or peers with hypothetical row) / (total rows).  The value
        thus ranges from 1/&lt;parameter&gt;N&lt;/parameter&gt; to 1.
</span>
現在行の相対順位を計算します。すなわち、(仮想行より先行する、あるいはピアの行数) / (合計行数)です。
ですから範囲は1/<em class="parameter"><code>N</code></em>から1です。
       </p></td><td>非</td></tr></tbody></table></div></div><br class="table-break" /><div class="table" id="FUNCTIONS-GROUPING-TABLE"><p class="title"><strong>表9.62 グループ化演算</strong></p><div class="table-contents"><span class="original">
   &lt;title&gt;Grouping Operations&lt;/title&gt;
</span><table class="table" summary="グループ化演算" border="1"><colgroup><col /></colgroup><thead><tr><th class="func_table_entry"><p class="func_signature">
<span class="original">
        Function
</span>
関数
       </p>
       <p>
<span class="original">
        Description
</span>
説明
       </p></th></tr></thead><tbody><tr><td class="func_table_entry"><p class="func_signature">
        <a id="id-1.5.8.29.25.2.2.1.1.1.1" class="indexterm"></a>
        <code class="function">GROUPING</code> ( <em class="replaceable"><code>group_by_expression(s)</code></em> )
        → <code class="returnvalue">integer</code>
       </p>
       <p>
<span class="original">
        Returns a bit mask indicating which &lt;literal&gt;GROUP BY&lt;/literal&gt;
        expressions are not included in the current grouping set.
        Bits are assigned with the rightmost argument corresponding to the
        least-significant bit; each bit is 0 if the corresponding expression
        is included in the grouping criteria of the grouping set generating
        the current result row, and 1 if it is not included.
</span>
どの<code class="literal">GROUP BY</code>式が現在のグループ化セットに含まれないかを示す整数のビットマスクを返します。
最も右側の引数が最下位ビットになるようにビットが割り当てられます。
各ビットは対応する式が結果の行を生成するグループ化セットのグループ化条件に含まれていれば0、そうでなければ1です。
       </p></td></tr></tbody></table></div></div><br class="table-break" /><p>
<span class="original">
    The grouping operations shown in
    &lt;xref linkend="functions-grouping-table"/&gt; are used in conjunction with
    grouping sets (see &lt;xref linkend="queries-grouping-sets"/&gt;) to distinguish
    result rows.  The arguments to the &lt;literal&gt;GROUPING&lt;/literal&gt; function
    are not actually evaluated, but they must exactly match expressions given
    in the &lt;literal&gt;GROUP BY&lt;/literal&gt; clause of the associated query level.
    For example:
</span>
<a class="xref" href="functions-aggregate.html#FUNCTIONS-GROUPING-TABLE" title="表9.62 グループ化演算">表 9.62</a>で示すグループ化演算はグループ化セット（<a class="xref" href="queries-table-expressions.html#QUERIES-GROUPING-SETS" title="7.2.4. GROUPING SETS、CUBE、ROLLUP">7.2.4</a>参照）と一緒に使われ、結果の行を区別するものです。
<code class="literal">GROUPING</code>関数の引数は実際には評価されませんが、関連する問い合わせの<code class="literal">GROUP BY</code>句にある式と正確に一致する必要があります。
例えば以下のようになります。
</p><pre class="screen">
<code class="prompt">=&gt;</code> <strong class="userinput"><code>SELECT * FROM items_sold;</code></strong>
 make  | model | sales
-------+-------+-------
 Foo   | GT    |  10
 Foo   | Tour  |  20
 Bar   | City  |  15
 Bar   | Sport |  5
(4 rows)

<code class="prompt">=&gt;</code> <strong class="userinput"><code>SELECT make, model, GROUPING(make,model), sum(sales) FROM items_sold GROUP BY ROLLUP(make,model);</code></strong>
 make  | model | grouping | sum
-------+-------+----------+-----
 Foo   | GT    |        0 | 10
 Foo   | Tour  |        0 | 20
 Bar   | City  |        0 | 15
 Bar   | Sport |        0 | 5
 Foo   |       |        1 | 30
 Bar   |       |        1 | 20
       |       |        3 | 50
(7 rows)
</pre><p>
<span class="original">
    Here, the &lt;literal&gt;grouping&lt;/literal&gt; value &lt;literal&gt;0&lt;/literal&gt; in the
    first four rows shows that those have been grouped normally, over both the
    grouping columns.  The value &lt;literal&gt;1&lt;/literal&gt; indicates
    that &lt;literal&gt;model&lt;/literal&gt; was not grouped by in the next-to-last two
    rows, and the value &lt;literal&gt;3&lt;/literal&gt; indicates that
    neither &lt;literal&gt;make&lt;/literal&gt; nor &lt;literal&gt;model&lt;/literal&gt; was grouped
    by in the last row (which therefore is an aggregate over all the input
    rows).
</span>
ここで、最初の4行の<code class="literal">グループ化</code>値<code class="literal">0</code>はこれらがグループ化列に対して正常にグループ化されたことを示します。
値<code class="literal">1</code>は<code class="literal">model</code>が最後とその一つ前の行ではグループ化されなかったことを、値<code class="literal">3</code>は<code class="literal">make</code>も<code class="literal">model</code>も最後の行でグループ化されなかったことを意味します（ですから最後の行はすべての入力行に対する集約になっています）。
   </p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="functions-range.html" title="9.20. 範囲／多重範囲関数と演算子">前へ</a> </td><td width="20%" align="center"><a accesskey="u" href="functions.html" title="第9章 関数と演算子">上へ</a></td><td width="40%" align="right"> <a accesskey="n" href="functions-window.html" title="9.22. ウィンドウ関数">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">9.20. 範囲／多重範囲関数と演算子 </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="PostgreSQL 15.0文書">ホーム</a></td><td width="40%" align="right" valign="top"> 9.22. ウィンドウ関数</td></tr></table></div></body></html>