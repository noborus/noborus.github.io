<!doctype html><html><head><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-136434199-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>ov &ndash; Noboru Saito's page</title><meta name=description property="og:description" content="私が作成中のovの紹介です。 最初Oviewerというレポジトリ名でしたが、コマンド名に合わせるようにovに変更しました。 インストール ov のリリースからバイナリもダウンロードできますが、今はまだgo getで最新をダウンロードして使うことをオススメします。 ※ 2020/5/11追記。現在|Noboru Saito's site"><meta name=apple-mobile-web-app-title content="Noboru Saito's page"><link rel=icon href=/favicon-64.png><link rel=apple-touch-icon href=/apple-touch-icon.png><link rel=mask-icon size=any href=/pinned-icon.svg><meta name=twitter:card content="summary"><meta name=twitter:site content="@noborus"><meta name=twitter:creator content="@noborus"><meta name=twitter:title content="ov | Noboru Saito's page"><meta name=twitter:description content="私が作成中のovの紹介です。 最初Oviewerというレポジトリ名でしたが、コマンド名に合わせるようにovに変更しました。 インストール ov のリリースからバイナリもダウンロードできますが、今はまだgo getで最新をダウンロードして使うことをオススメします。 ※ 2020/5/11追記。現在|Noboru Saito's site"><meta name=twitter:image content="https://noborus.github.io/twitter-card.png"><link rel=stylesheet href=/assets/syntax.css><link rel=stylesheet href=/assets/primer-build.css><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/assets/custom.css><link rel=stylesheet href="https://fonts.googleapis.com/icon?family=Material+Icons"></head><body class=bg-gray><div id=holy class="container-lg bg-white h-100"><div id=header class="px-1 bg-white"><nav class="UnderlineNav UnderlineNav--right px-2"><a class="UnderlineNav-actions muted-link h2" href=https://noborus.github.io/>Noboru Saito's page</a><div class=UnderlineNav-body><a class=UnderlineNav-item href=/><span>Top</span></a>
<a class=UnderlineNav-item href=/trdsql/><span>trdsql 目次</span></a>
<a class=UnderlineNav-item href=/blog/><span>Blog</span></a>
<a class=UnderlineNav-item href=/about/><span>About</span></a></div></nav></div><div role=main id=main class="holy-main markdown-body px-4 bg-white"><div class=Subhead><div class=Subhead-heading><div class="h1 mt-3 mb-1">ov</div></div><div class=Subhead-description><a href=/categories/ov class=muted-link><span class="Label Label--gray-darker">ov</span></a>
<a href=/tags/ov class=muted-link><span class="Label Label--gray">ov</span></a>
<a href=/tags/terminal-pager class=muted-link><span class="Label Label--gray">terminal pager</span></a><div class=float-md-right><span title="Lastmod: 2020-04-21. Published at: 2020-04-21.">Published: 2020-04-21</span></div></div></div><article><section class="pb-6 mb-3 border-bottom"><p>私が作成中の<a href=https://github.com/noborus/ov>ov</a>の紹介です。</p><p>最初Oviewerというレポジトリ名でしたが、コマンド名に合わせるように<code>ov</code>に変更しました。</p><h2 id=インストール>インストール</h2><p><a href=https://github.com/noborus/ov>ov</a> のリリースからバイナリもダウンロードできますが、今はまだgo getで最新をダウンロードして使うことをオススメします。</p><p>※ 2020/5/11追記。現在は各種パッケージも用意していますので、インストールしやすい方法利用してください。</p><pre><code class=language-console data-lang=console>go get -u github.com/noborus/ov
cd ov
make install
</code></pre><h2 id=特徴>特徴</h2><p><code>less</code>や<code>more</code>のようなTerminal pagerです。</p><ul><li>圧縮（gzip, bzip2, zstd, lz4, xz）されているファイルをそのまま表示可能</li><li>より良いUnicodeのサポート。ターミナルで表示できる（フォントがあれば）結合文字も表示可能</li><li>より良いワイド幅（全角文字）の対応</li><li>ヘッダーの行数を指定して固定可能</li><li>行の折り返し／折り返さないを表示後に切替可能</li><li>1行毎に背景色を付けることが可能</li><li>psqlやmysqlからの表示を考慮</li><li>終了時に現在の画面の内容を書き出すことが可能</li></ul><p>環境変数PAGERに設定して使用しても問題なく使えることを目指しています。</p><p>現在はUTF-8のテキストを対象にしています。</p><p><del>また、manのpagerとしては、問題があるので、MANPAGERは別途指定する必要があります。</del></p><p>※ 2020/5/25 追記 v0.2.0からMANPAGERとしても使用できるようになりました。</p><h3 id=実装の特徴>実装の特徴</h3><p><a href=https://github.com/gdamore/tcell>tcell</a>を使用していて、比較的多くの端末に対応しています。
メモリに溜め込む実装なので、メモリは多く使用します。更新されるログファイルの監視的な用途には向きません。</p><h2 id=使用方法>使用方法</h2><p>コマンド名は <code>ov</code> です。</p><p>基本的にはファイル名を指定して起動します。</p><pre><code class=language-console data-lang=console>ov filename
</code></pre><p>又はパイプを使用して標準入力からの入力を受け付けます。</p><pre><code class=language-console data-lang=console>cat filename|ov
</code></pre><p>オプションは以下です。オプションの多くは、起動後にキーより切り替え可能です。</p><pre><code class=language-console data-lang=console>$ ov --help
ov is a feature rich pager(such as more/less).
It supports various compressed files(gzip, bzip2, zstd, lz4, and xz).

Usage:
  ov [flags]

Flags:
  -C, --alternate-rows            color to alternate rows
  -i, --case-sensitive            case-sensitive in search
  -d, --column-delimiter string   column delimiter (default &quot;,&quot;)
  -c, --column-mode               column mode
      --config string             config file (default is $HOME/.oviewer.yaml)
      --debug                     debug mode
  -X, --exit-write                output the current screen when exiting
  -H, --header int                number of header rows to fix
  -h, --help                      help for ov
  -n, --line-number               line number
  -F, --quit-if-one-screen        quit if the output fits on one screen
  -x, --tab-width int             tab stop width (default 8)
  -v, --version                   display version information
  -w, --wrap                      wrap mode (default true)
</code></pre><h3 id=圧縮してあるファイルの対応>圧縮してあるファイルの対応</h3><p>元々の作成の動機でもあるのですが、圧縮してあるファイルをそのまま閲覧できます。</p><pre><code class=language-console data-lang=console>ov test.csv.zst
</code></pre><p>拡張子に関係なくファイルの先頭のマジックナンバーを見て判断しているため、パイプからでも動作します。</p><pre><code class=language-console data-lang=console>cat test.csv.zst|ov
</code></pre><h2 id=psqlでの使用>psqlでの使用</h2><p><a href=https://www.postgresql.jp/document/current/html/app-psql.html>psql</a>から呼び出されるPAGERとしても考慮しています。</p><p>psqlでは環境変数PAGER又は（PostgreSQL Ver.11.0からは）PSQL_PAGERが設定されているとPAGERを使用します。
~/.psqlrcによりpsql起動時に以下のように環境変数を設定することもできますので、以下のように設定することを推奨します。</p><pre><code class=language-.psqlrc data-lang=.psqlrc>\setenv PAGER 'ov -H2 -w=f -F -C -d &quot;|&quot;'
</code></pre><p>これによりpsqlでは、<code>-H2</code>2行の固定ヘッダー、<code>-w=f</code>折り返しをしない、<code>-F</code>終了時に表示していた内容を書き出す（ほぼ、クリアしないと同じ動作）、<code>-C</code>1行毎に背景色を付ける、区切り文字として"|&ldquo;を使用という動作になります。</p><p>これは起動時の動作のため、起動後以下のように切り替えることが可能です（<code>-F</code> は終了時に必ず書く設定なので、<code>-F</code>を付けずに起動すれば、<code>q</code>で書き出さないで終了（クリアする）、<code>Q</code>で書き出して終了する、というような動作になります。</p><h3 id=折り返し折り返さないw>折り返し／折り返さない(w)</h3><p><img src=https://raw.githubusercontent.com/noborus/ov/master/docs/ov-wrap.gif alt=wrap/nowrap></p><h3 id=1行毎に背景色を付ける付けないc>1行毎に背景色を付ける／付けない(C)</h3><p><img src=https://raw.githubusercontent.com/noborus/ov/master/docs/ov-color.gif alt="color enable/disable"></p><h3 id=固定するヘッダーの行数指定-h>固定するヘッダーの行数指定 (H)</h3><p>入力モードになるので行数を入力する。</p><p><img src=https://raw.githubusercontent.com/noborus/ov/master/docs/ov-header.gif alt=header></p><h3 id=列モードc>列モード(c)</h3><p>(<code>d</code>) で指定した区切り文字に囲まれた列として選択できるようになります。選択されている列がハイライト表示されます。
wrap/nowapで動作が変わり、nowrapモードの場合は、選択した列が表示されるように横スクロールします。</p><p><img src=https://raw.githubusercontent.com/noborus/ov/master/docs/ov-column.gif alt=column></p><h3 id=行番号モードg>行番号モード(G)</h3><p>(<code>G</code>)で先頭に行番号が表示されます。</p><h2 id=mysqlでの使用>mysqlでの使用</h2><p>またmysqlから使用されるPAGERとしても同様に使用できます。</p><pre><code class=language-console data-lang=console>mysql -pager='ov -H3 -w=f -C -d &quot;|&quot;'
</code></pre><p>$(HOME)/.my.cnfにPAGERの設定を書いておくこともできます。</p><pre><code class=language-$(HOME)/.my.cnf data-lang=$(HOME)/.my.cnf>[client]
pager=ov -H3 -w=f -C -d &quot;|&quot;
</code></pre><h2 id=ヘッダーがあるコマンド出力のページャー>ヘッダーがあるコマンド出力のページャー</h2><p>たとえば、よく使用する<code>ps</code>で全プロセスを出すと見づらくなりますが、以下のようにすると見やすくなります。</p><pre><code class=language-console data-lang=console>ps aux|ov -H1 -C -w=f
</code></pre><p><img src=../ps-ov.png alt=ps-ov.png></p><p>Debian/Ubuntuのインストールしているパッケージリストも以下のようにして見ることができます。</p><pre><code class=language-console data-lang=console>dpkg -l|ov -H5 -w=f -C
</code></pre><p><img src=../dpkg-ov.png alt=dpkg-ov.png></p><p>起動後にもヘッダーや折り返し、背景色の変更もできるため、とりあえずovに渡してから見やすい表示に変更するといった使い方ができると考えています。</p></section><section></section></article></div><div id=side class="pr-1 bg-white"><aside class=pr-3><div id=toc class="Box Box--blue mb-3"><b>ov</b><nav id=TableOfContents><ul><li><a href=#インストール>インストール</a></li><li><a href=#特徴>特徴</a><ul><li><a href=#実装の特徴>実装の特徴</a></li></ul></li><li><a href=#使用方法>使用方法</a><ul><li><a href=#圧縮してあるファイルの対応>圧縮してあるファイルの対応</a></li></ul></li><li><a href=#psqlでの使用>psqlでの使用</a><ul><li><a href=#折り返し折り返さないw>折り返し／折り返さない(w)</a></li><li><a href=#1行毎に背景色を付ける付けないc>1行毎に背景色を付ける／付けない(C)</a></li><li><a href=#固定するヘッダーの行数指定-h>固定するヘッダーの行数指定 (H)</a></li><li><a href=#列モードc>列モード(c)</a></li><li><a href=#行番号モードg>行番号モード(G)</a></li></ul></li><li><a href=#mysqlでの使用>mysqlでの使用</a></li><li><a href=#ヘッダーがあるコマンド出力のページャー>ヘッダーがあるコマンド出力のページャー</a></li></ul></nav></div><div><a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class=twitter-share-button data-show-count=false>Tweet</a><script async src=https://platform.twitter.com/widgets.js></script>
<iframe src="https://www.facebook.com/plugins/share_button.php?href=https%3A%2F%2Fdevelopers.facebook.com%2Fdocs%2Fplugins%2F&layout=button&size=small&mobile_iframe=true&width=61&height=20&appId" width=61 height=20 style=border:none;overflow:hidden scrolling=no frameborder=0 allowtransparency=true allow=encrypted-media></iframe>
<a href=http://b.hatena.ne.jp/entry/ class=hatena-bookmark-button data-hatena-bookmark-layout=basic-label-counter data-hatena-bookmark-lang=ja title=このエントリーをはてなブックマークに追加><img src=https://b.st-hatena.com/images/entry-button/button-only@2x.png alt=このエントリーをはてなブックマークに追加 width=20 height=20 style=border:none></a><script type=text/javascript src=https://b.st-hatena.com/js/bookmark_button.js async></script>
<a data-pocket-label=pocket data-pocket-count=none class=pocket-btn data-lang=en></a><script type=text/javascript>!function(d,i){if(!d.getElementById(i)){var j=d.createElement("script");j.id=i;j.src="https://widgets.getpocket.com/v1/j/btn.js?v=1";var w=d.getElementById(i);d.body.appendChild(j);}}(document,"pocket-btn-js");</script></div></aside></div><div id=footer class="pt-2 pb-3 bg-white text-center"><span class="text-small text-gray">©Noboru Saito 2019-2020 &#183;
Powered by the
<a href=https://github.com/qqhann/hugo-primer class=link-gray-dark>Hugo-Primer</a> theme for
<a href=https://gohugo.io class=link-gray-dark>Hugo</a>.</span></div></div><script type=text/javascript src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type=text/x-mathjax-config>MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });</script></body></html>