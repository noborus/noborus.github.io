<!doctype html><html><head><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-136434199-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>trdsql ファイルフォーマット変換 &ndash; Noboru Saito's page</title><meta name=description property="og:description" content="trdsqlはCSV等のファイルをSQLで処理するツールとして説明していますが、単純にファイル形式を変換するツールとしても使用できます。 その場合、SQLは以下の定型句さえ覚えておけば、十分です。 ファイル内のすべての行と列を出力します。 SELECT * FROM ファイル名 後は、オプションとして入力形式|Noboru Saito's site"><meta name=apple-mobile-web-app-title content="Noboru Saito's page"><link rel=icon href=/favicon-64.png><link rel=apple-touch-icon href=/apple-touch-icon.png><link rel=mask-icon size=any href=/pinned-icon.svg><meta name=twitter:card content="summary"><meta name=twitter:site content="@noborus"><meta name=twitter:creator content="@noborus"><meta name=twitter:title content="trdsql ファイルフォーマット変換 | Noboru Saito's page"><meta name=twitter:description content="trdsqlはCSV等のファイルをSQLで処理するツールとして説明していますが、単純にファイル形式を変換するツールとしても使用できます。 その場合、SQLは以下の定型句さえ覚えておけば、十分です。 ファイル内のすべての行と列を出力します。 SELECT * FROM ファイル名 後は、オプションとして入力形式|Noboru Saito's site"><meta name=twitter:image content="https://noborus.github.io/twitter-card.png"><link rel=stylesheet href=/assets/syntax.css><link rel=stylesheet href=/assets/primer-build.css><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/assets/custom.css><link rel=stylesheet href="https://fonts.googleapis.com/icon?family=Material+Icons"></head><body class=bg-gray><div id=holy class="container-lg bg-white h-100"><div id=header class="px-1 bg-white"><nav class="UnderlineNav UnderlineNav--right px-2"><a class="UnderlineNav-actions muted-link h2" href=https://noborus.github.io/>Noboru Saito's page</a><div class=UnderlineNav-body><a class=UnderlineNav-item href=/><span>Top</span></a>
<a class=UnderlineNav-item href=/trdsql/><span>trdsql 目次</span></a>
<a class=UnderlineNav-item href=/blog/><span>Blog</span></a>
<a class=UnderlineNav-item href=/about/><span>About</span></a></div></nav></div><div role=main id=main class="holy-main markdown-body px-4 bg-white"><div class=Subhead><div class=Subhead-heading><div class="h1 mt-3 mb-1">trdsql ファイルフォーマット変換</div></div><div class=Subhead-description><a href=/categories/trdsql class=muted-link><span class="Label Label--gray-darker">trdsql</span></a>
<a href=/tags/trdsql class=muted-link><span class="Label Label--gray">trdsql</span></a>
<a href=/tags/csv2ltsv class=muted-link><span class="Label Label--gray">csv2ltsv</span></a>
<a href=/tags/ltsv2csv class=muted-link><span class="Label Label--gray">ltsv2csv</span></a>
<a href=/tags/csv2json class=muted-link><span class="Label Label--gray">csv2json</span></a>
<a href=/tags/json2csv class=muted-link><span class="Label Label--gray">json2csv</span></a><div class=float-md-right><span title="Lastmod: 2019-12-02. Published at: 2019-12-02.">Published: 2019-12-02</span></div></div></div><article><section class="pb-6 mb-3 border-bottom"><p>trdsqlはCSV等のファイルをSQLで処理するツールとして説明していますが、単純にファイル形式を変換するツールとしても使用できます。</p><p>その場合、SQLは以下の定型句さえ覚えておけば、十分です。
ファイル内のすべての行と列を出力します。</p><div class=highlight><pre class=chroma><code class=language-SQL data-lang=SQL><span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=err>ファイル名</span>
</code></pre></div><p>後は、オプションとして入力形式(-i&mldr;)と出力形式(-o&mldr;)を指定してあげればファイル形式の変換が可能です。
CSV、LTSV、JSON等の相互変換ができます。</p><p>CSV(-icsv)からLTSV(-oltsv)への変換は以下のようにします。</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>trdsql -icsv -oltsv <span class=s2>&#34;SELECT * FROM ファイル名&#34;</span>
</code></pre></div><h3 id=csv-header>CSV header</h3><p>CSVファイルはヘッダーに列名がついている場合 -ih でヘッダーを解釈して列名として使用できます。</p><p>header.csv</p><pre><code class=language-CSV data-lang=CSV>id,name
1,Orange
2,Melon
3,Apple
</code></pre><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>trdsql -icsv -ih -oltsv <span class=s2>&#34;SELECT * FROM header.csv&#34;</span> &gt; test.ltsv
</code></pre></div><p>test.ltsv</p><pre><code class=language-LTSV data-lang=LTSV>id:1	name:Orange
id:2	name:Melon
id:3	name:Apple
</code></pre><p>ヘッダーが無い場合は、列名はc1,c2,c3&mldr;の連番になります。</p><h3 id=ltsv入力>LTSV入力</h3><p>上記で出力されたLTSVを入力に使用すれば、CSVに戻ります。</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>trdsql -iltsv -ocsv -oh <span class=s2>&#34;SELECT * FROM test.ltsv&#34;</span>
</code></pre></div><pre><code class=language-CSV data-lang=CSV>id,name
1,Orange
2,Melon
3,Apple
</code></pre><h3 id=区切り文字の変更tsv>区切り文字の変更（TSV）</h3><p>また、CSVはComma-Separated Valuesではなく、Character-separated valuesとも呼ばれたりすることがあるように、区切り文字として「,」以外を使用できます。</p><p>-id オプションの後に文字を指定することにより変更ができます。
タブ区切りの場合（TSVとも呼ばれます）は、"\t"を使用します。</p><p>以下はTSVからCSVの変更になります。</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>trdsql -icsv -id <span class=s2>&#34;\t&#34;</span> -ih <span class=s2>&#34;SELECT * FROM test.tsv&#34;</span>
</code></pre></div><h3 id=json出力>JSON出力</h3><p>JSON出力では、全体を配列としてのJSONが出力されます。</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>trdsql -icsv -ih -ojson <span class=s2>&#34;SELECT * FROM header.csv&#34;</span>
</code></pre></div><div class=highlight><pre class=chroma><code class=language-json data-lang=json><span class=p>[</span>
  <span class=p>{</span>
    <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;1&#34;</span><span class=p>,</span>
    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Orange&#34;</span>
  <span class=p>},</span>
  <span class=p>{</span>
    <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;2&#34;</span><span class=p>,</span>
    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Melon&#34;</span>
  <span class=p>},</span>
  <span class=p>{</span>
    <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;3&#34;</span><span class=p>,</span>
    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Apple&#34;</span>
  <span class=p>}</span>
<span class=p>]</span>
</code></pre></div><h3 id=json入力>JSON入力</h3><p>trdsqlではJSONは、行と列で構成されているフォーマットを想定しています。
一つは、上記で出力したような、トップが配列になっていて、名前と値が含まれているフォーマットです。</p><p>もう一つは、下記のように１行が１つのJSONになっているNDJSON、LDJSON、JSONLとも呼ばれるフォーマットです。</p><div class=highlight><pre class=chroma><code class=language-json data-lang=json><span class=p>{</span><span class=nt>&#34;id&#34;</span><span class=p>:</span><span class=s2>&#34;1&#34;</span><span class=p>,</span><span class=nt>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Orange&#34;</span><span class=p>}</span>
<span class=p>{</span><span class=nt>&#34;id&#34;</span><span class=p>:</span><span class=s2>&#34;2&#34;</span><span class=p>,</span><span class=nt>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Melon&#34;</span><span class=p>}</span>
<span class=p>{</span><span class=nt>&#34;id&#34;</span><span class=p>:</span><span class=s2>&#34;3&#34;</span><span class=p>,</span><span class=nt>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Apple&#34;</span><span class=p>}</span>
</code></pre></div><p>このような列が同じで揃っていれば、CSVやLTSVと同様に入力が可能です。</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>trdsql -ijson -ocsv <span class=s2>&#34;SELECT * FROM test.json&#34;</span>
</code></pre></div><p>(JSONのオブジェクトは順序が不定のため、列の順番はname,idのように前後することがあります。)</p><h3 id=その他の出力>その他の出力</h3><p>また出力だけならば、更に多くのフォーマットに対応しているため、マークダウンのテーブル(CSV2MDとかJSON2MDとかLTSV2MDとか呼ばれるツールに相当)として出力できます。</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>trdsql -icsv -ih -ovf <span class=s2>&#34;SELECT * FROM header.csv&#34;</span>
<span class=p>|</span> id <span class=p>|</span>  name  <span class=p>|</span>
<span class=p>|</span>----<span class=p>|</span>--------<span class=p>|</span>
<span class=p>|</span>  <span class=m>1</span> <span class=p>|</span> Orange <span class=p>|</span>
<span class=p>|</span>  <span class=m>2</span> <span class=p>|</span> Melon  <span class=p>|</span>
<span class=p>|</span>  <span class=m>3</span> <span class=p>|</span> Apple  <span class=p>|</span>
</code></pre></div><p>列が多いCSVファイル等で横に長くなってしまって見づらいファイルをVerticalフォーマットで縦に表示したり出来ます。</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>trdsql -icsv -ih -ovf <span class=s2>&#34;SELECT * FROM header.csv&#34;</span>
---<span class=o>[</span> 1<span class=o>]</span>-----------------------------------------------------
    id <span class=p>|</span> <span class=m>1</span>
  name <span class=p>|</span> Orange
---<span class=o>[</span> 2<span class=o>]</span>-----------------------------------------------------
    id <span class=p>|</span> <span class=m>2</span>
  name <span class=p>|</span> Melon
---<span class=o>[</span> 3<span class=o>]</span>-----------------------------------------------------
    id <span class=p>|</span> <span class=m>3</span>
  name <span class=p>|</span> Apple
</code></pre></div><h3 id=使用できるフォーマット>使用できるフォーマット</h3><table><thead><tr><th style=text-align:left>フォーマット</th><th style=text-align:center>入力</th><th style=text-align:center>出力</th><th style=text-align:left>注釈</th></tr></thead><tbody><tr><td style=text-align:left>CSV</td><td style=text-align:center>○</td><td style=text-align:center>○</td><td style=text-align:left>TSV等もオプションにより対応</td></tr><tr><td style=text-align:left>LTSV</td><td style=text-align:center>○</td><td style=text-align:center>○</td><td style=text-align:left><a href=http://ltsv.org>ltsv.org</a></td></tr><tr><td style=text-align:left>JSON</td><td style=text-align:center>○</td><td style=text-align:center>○</td><td style=text-align:left><a href=www.json.org>www.json.org</a></td></tr><tr><td style=text-align:left>JSONL</td><td style=text-align:center>○</td><td style=text-align:center>○</td><td style=text-align:left>入力はJSONで可能</td></tr><tr><td style=text-align:left>TBLN</td><td style=text-align:center>○</td><td style=text-align:center>○</td><td style=text-align:left><a href=https://tbln.dev>tbln.dev</a></td></tr><tr><td style=text-align:left>RAW</td><td style=text-align:center>×</td><td style=text-align:center>○</td><td style=text-align:left>そのまま出力（エスケープ処理をしない）</td></tr><tr><td style=text-align:left>MD</td><td style=text-align:center>×</td><td style=text-align:center>○</td><td style=text-align:left>MarkDownテーブル</td></tr><tr><td style=text-align:left>AT</td><td style=text-align:center>×</td><td style=text-align:center>○</td><td style=text-align:left>ASCIIテーブル</td></tr><tr><td style=text-align:left>VF</td><td style=text-align:center>×</td><td style=text-align:center>○</td><td style=text-align:left>Verticalフォーマット</td></tr></tbody></table><h4 id=csv>CSV</h4><pre><code class=language-CSV data-lang=CSV>id,name
1,Orange
2,Melon
3,Apple
</code></pre><h4 id=ltsv>LTSV</h4><pre><code class=language-LTSV data-lang=LTSV>id:1	name:Orange
id:2	name:Melon
id:3	name:Apple
</code></pre><h4 id=json>JSON</h4><div class=highlight><pre class=chroma><code class=language-JSON data-lang=JSON><span class=p>[</span>
  <span class=p>{</span>
    <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;1&#34;</span><span class=p>,</span>
    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Orange&#34;</span>
  <span class=p>},</span>
  <span class=p>{</span>
    <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;2&#34;</span><span class=p>,</span>
    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Melon&#34;</span>
  <span class=p>},</span>
  <span class=p>{</span>
    <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;3&#34;</span><span class=p>,</span>
    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Apple&#34;</span>
  <span class=p>}</span>
<span class=p>]</span>
</code></pre></div><h4 id=jsonl>JSONL</h4><div class=highlight><pre class=chroma><code class=language-JSON data-lang=JSON><span class=p>{</span><span class=nt>&#34;id&#34;</span><span class=p>:</span><span class=s2>&#34;1&#34;</span><span class=p>,</span><span class=nt>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Orange&#34;</span><span class=p>}</span>
<span class=p>{</span><span class=nt>&#34;id&#34;</span><span class=p>:</span><span class=s2>&#34;2&#34;</span><span class=p>,</span><span class=nt>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Melon&#34;</span><span class=p>}</span>
<span class=p>{</span><span class=nt>&#34;id&#34;</span><span class=p>:</span><span class=s2>&#34;3&#34;</span><span class=p>,</span><span class=nt>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Apple&#34;</span><span class=p>}</span>
</code></pre></div><h4 id=tbln>TBLN</h4><pre><code class=language-TBLN data-lang=TBLN>; name: | id | name |
; type: | text | text |
| 1 | Orange |
| 2 | Melon |
| 3 | Apple |
</code></pre><h4 id=raw>RAW</h4><pre><code class=language-CSV data-lang=CSV>id,name
1,Orange
2,Melon
3,Apple
</code></pre><h4 id=md>MD</h4><div class=highlight><pre class=chroma><code class=language-Markdown data-lang=Markdown>| id |  name  |
|----|--------|
|  1 | Orange |
|  2 | Melon  |
|  3 | Apple  |
</code></pre></div><h4 id=at>AT</h4><pre><code class=language-AsciiTable data-lang=AsciiTable>+----+--------+
| id |  name  |
+----+--------+
|  1 | Orange |
|  2 | Melon  |
|  3 | Apple  |
+----+--------+
</code></pre><h4 id=vf>VF</h4><pre><code class=language-VerticalFormat data-lang=VerticalFormat>---[ 1]-------------------------------------------------------------------
    id | 1
  name | Orange
---[ 2]-------------------------------------------------------------------
    id | 2
  name | Melon
---[ 3]-------------------------------------------------------------------
    id | 3
  name | Apple
</code></pre></section><section></section></article></div><div id=side class="pr-1 bg-white"><aside class=pr-3><div id=toc class="Box Box--blue mb-3"><b>trdsql ファイルフォーマット変換</b><nav id=TableOfContents><ul><li><ul><li><a href=#csv-header>CSV header</a></li><li><a href=#ltsv入力>LTSV入力</a></li><li><a href=#区切り文字の変更tsv>区切り文字の変更（TSV）</a></li><li><a href=#json出力>JSON出力</a></li><li><a href=#json入力>JSON入力</a></li><li><a href=#その他の出力>その他の出力</a></li><li><a href=#使用できるフォーマット>使用できるフォーマット</a></li></ul></li></ul></nav></div><div><a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class=twitter-share-button data-show-count=false>Tweet</a><script async src=https://platform.twitter.com/widgets.js></script>
<iframe src="https://www.facebook.com/plugins/share_button.php?href=https%3A%2F%2Fdevelopers.facebook.com%2Fdocs%2Fplugins%2F&layout=button&size=small&mobile_iframe=true&width=61&height=20&appId" width=61 height=20 style=border:none;overflow:hidden scrolling=no frameborder=0 allowtransparency=true allow=encrypted-media></iframe>
<a href=http://b.hatena.ne.jp/entry/ class=hatena-bookmark-button data-hatena-bookmark-layout=basic-label-counter data-hatena-bookmark-lang=ja title=このエントリーをはてなブックマークに追加><img src=https://b.st-hatena.com/images/entry-button/button-only@2x.png alt=このエントリーをはてなブックマークに追加 width=20 height=20 style=border:none></a><script type=text/javascript src=https://b.st-hatena.com/js/bookmark_button.js async></script>
<a data-pocket-label=pocket data-pocket-count=none class=pocket-btn data-lang=en></a><script type=text/javascript>!function(d,i){if(!d.getElementById(i)){var j=d.createElement("script");j.id=i;j.src="https://widgets.getpocket.com/v1/j/btn.js?v=1";var w=d.getElementById(i);d.body.appendChild(j);}}(document,"pocket-btn-js");</script></div></aside></div><div id=footer class="pt-2 pb-3 bg-white text-center"><span class="text-small text-gray">©Noboru Saito 2019-2020 &#183;
Powered by the
<a href=https://github.com/qqhann/hugo-primer class=link-gray-dark>Hugo-Primer</a> theme for
<a href=https://gohugo.io class=link-gray-dark>Hugo</a>.</span></div></div><script type=text/javascript src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type=text/x-mathjax-config>MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });</script></body></html>