<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>34.3. コマンド実行関数</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="libpq-status.html" title="34.2. 接続状態関数" /><link rel="next" href="libpq-async.html" title="34.4. 非同期コマンドの処理" /><meta name="viewport" content="width=device-width,initial-scale=1.0" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="4" align="center"><a accesskey="h" href="index.html">PostgreSQL 11.4文書</a></th></tr><tr><td width="10%" align="left"></td><td width="10%" align="left"></td><td width="60%" align="center"><a href="libpq.html" title="第34章 libpq - C ライブラリ">第34章 <span class="application">libpq</span> - C ライブラリ</a></td><td width="20%" align="right"><div class="actions"><a class="issue" title="github" href="https://github.com/pgsql-jp/jpug-doc/issues/new?title=version 11.4 &#10;                      libpq-exec.html">誤訳等の報告
                    </a></div></td></tr><tr><td width="10%" align="left"><a accesskey="p" href="libpq-status.html" title="34.2. 接続状態関数">前へ</a> </td><td width="10%" align="left"><a accesskey="u" href="libpq.html" title="第34章 libpq - C ライブラリ">上へ</a></td><td width="60%" align="center">34.3. コマンド実行関数</td><td width="20%" align="right"> <a accesskey="n" href="libpq-async.html" title="34.4. 非同期コマンドの処理">次へ</a></td></tr></table><hr /></div><div class="sect1" id="LIBPQ-EXEC"><div class="titlepage"><div><div><h2 class="title" style="clear: both">34.3. コマンド実行関数</h2></div></div></div><span class="original">
  &lt;title&gt;Command Execution Functions&lt;/title&gt;
</span><p>
<span class="original">
   Once a connection to a database server has been successfully
   established, the functions described here are used to perform
   SQL queries and commands.
</span>
いったんデータベースサーバへの接続の確立が成功すれば、本節で説明する関数を使ってSQLの問い合わせやコマンドを実行します。
  </p><div class="sect2" id="LIBPQ-EXEC-MAIN"><div class="titlepage"><div><div><h3 class="title">34.3.1. 主要な関数</h3></div></div></div><span class="original">
   &lt;title&gt;Main Functions&lt;/title&gt;
</span><p>
    </p><div class="variablelist"><dl class="variablelist"><dt id="LIBPQ-PQEXEC"><span class="term">
       <code class="function">PQexec</code>
       <a id="id-1.7.3.10.3.2.1.1.1.2" class="indexterm"></a>
      </span></dt><dd><p>
<span class="original">
        Submits a command to the server and waits for the result.
</span>
コマンドをサーバに送信し、結果を待機します。

</p><pre class="synopsis">
PGresult *PQexec(PGconn *conn, const char *command);
</pre><p>
       </p><p>
<span class="original">
        Returns a &lt;structname&gt;PGresult&lt;/structname&gt; pointer or possibly a null
        pointer.  A non-null pointer will generally be returned except in
        out-of-memory conditions or serious errors such as inability to send
        the command to the server.  The &lt;function&gt;PQresultStatus&lt;/function&gt; function
        should be called to check the return value for any errors (including
        the value of a null pointer, in which case it will return
        &lt;symbol&gt;PGRES_FATAL_ERROR&lt;/symbol&gt;).  Use
        &lt;function&gt;PQerrorMessage&lt;/function&gt; to get more information about such
        errors.
</span>
戻り値は<code class="structname">PGresult</code>へのポインタ、場合によってはヌルポインタです。
メモリ不足の状態、あるいはサーバへのコマンド送信が不可能といった深刻なエラーの場合を除けば、通常非ヌルのポインタが返ります。
<code class="function">PQresultStatus</code>関数を呼び出して、何かエラー（ヌルポインタ値を含むエラー。この場合は<code class="symbol">PGRES_FATAL_ERROR</code>が返されます）がないか戻り値を検査しなければなりません。
こうしたエラーの詳しい情報は<code class="function">PQerrorMessage</code>で得ることができます。
       </p></dd></dl></div><p>

<span class="original">
    The command string can include multiple SQL commands
    (separated by semicolons).  Multiple queries sent in a single
    &lt;function&gt;PQexec&lt;/function&gt; call are processed in a single transaction, unless
    there are explicit &lt;command&gt;BEGIN&lt;/command&gt;/&lt;command&gt;COMMIT&lt;/command&gt;
    commands included in the query string to divide it into multiple
    transactions.  (See &lt;xref linkend="protocol-flow-multi-statement"/&gt;
    for more details about how the server handles multi-query strings.)
    Note however that the returned
    &lt;structname&gt;PGresult&lt;/structname&gt; structure describes only the result
    of the last command executed from the string.  Should one of the
    commands fail, processing of the string stops with it and the returned
    &lt;structname&gt;PGresult&lt;/structname&gt; describes the error condition.
</span>
コマンド文字列には（セミコロンで区切られた）複数のSQLコマンドを含めることができます。
単一の<code class="function">PQexec</code>呼び出しで送信された複数の問い合わせは、単一トランザクションで処理されます。
ただし、問い合わせ文字列内に明示的な<code class="command">BEGIN</code>/<code class="command">COMMIT</code>コマンドがある場合は、複数のトランザクションに分離されます。
（サーバがどのように複数問い合わせを処理するかの更なる詳細は<a class="xref" href="protocol-flow.html#PROTOCOL-FLOW-MULTI-STATEMENT" title="53.2.2.1. 簡易問い合わせでの複文">53.2.2.1</a>を参照してください。）
しかし、返される<code class="structname">PGresult</code>構造体には、その文字列内で最後に実行されたコマンドの結果のみが含まれることに注意してください。
そのコマンドの1つが失敗したとすると、文字列の処理はそこで中断し、エラー条件が含まれる<code class="structname">PGresult</code>が返されます。
   </p><p>
    </p><div class="variablelist"><dl class="variablelist"><dt id="LIBPQ-PQEXECPARAMS"><span class="term">
       <code class="function">PQexecParams</code>
       <a id="id-1.7.3.10.3.3.1.1.1.2" class="indexterm"></a>
      </span></dt><dd><p>
<span class="original">
        Submits a command to the server and waits for the result,
        with the ability to pass parameters separately from the SQL
        command text.
</span>
サーバにコマンドを送信し、結果を待ちます。
ただし、SQLコマンドテキストとは別にパラメータを渡すことができます。

</p><pre class="synopsis">
PGresult *PQexecParams(PGconn *conn,
                       const char *command,
                       int nParams,
                       const Oid *paramTypes,
                       const char * const *paramValues,
                       const int *paramLengths,
                       const int *paramFormats,
                       int resultFormat);
</pre><p>
       </p><p>
<span class="original">
        &lt;function&gt;PQexecParams&lt;/function&gt; is like &lt;function&gt;PQexec&lt;/function&gt;, but offers additional
        functionality: parameter values can be specified separately from the command
        string proper, and query results can be requested in either text or binary
        format.  &lt;function&gt;PQexecParams&lt;/function&gt; is supported only in protocol 3.0 and later
        connections; it will fail when using protocol 2.0.
</span>
<code class="function">PQexecParams</code>と<code class="function">PQexec</code>は似ていますが、前者は次の機能が追加されています。
パラメータ値をコマンド文字列とは別に適切に指定することができ、また、問い合わせの結果をテキスト書式としてでもバイナリ書式としてでも要求できます。
<code class="function">PQexecParams</code>はプロトコル3.0以降でのみサポートされ、プロトコル2.0で使用した場合は失敗します。
       </p><p>
<span class="original">
        The function arguments are:
</span>
この関数の引数を以下に示します。

        </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><em class="parameter"><code>conn</code></em></span></dt><dd><p>
<span class="original">
            The connection object to send the command through.
</span>
接続オブジェクトです。これを通してコマンドを送信します。
           </p></dd><dt><span class="term"><em class="parameter"><code>command</code></em></span></dt><dd><p>
<span class="original">
            The SQL command string to be executed. If parameters are used,
            they are referred to in the command string as &lt;literal&gt;$1&lt;/literal&gt;,
            &lt;literal&gt;$2&lt;/literal&gt;, etc.
</span>
実行させるSQLコマンド文字列です。
パラメータが使用される場合は、コマンド文字列内で<code class="literal">$1</code>、<code class="literal">$2</code>などのように参照されます。
           </p></dd><dt><span class="term"><em class="parameter"><code>nParams</code></em></span></dt><dd><p>
<span class="original">
            The number of parameters supplied; it is the length of the arrays
            &lt;parameter&gt;paramTypes[]&lt;/parameter&gt;, &lt;parameter&gt;paramValues[]&lt;/parameter&gt;,
            &lt;parameter&gt;paramLengths[]&lt;/parameter&gt;, and &lt;parameter&gt;paramFormats[]&lt;/parameter&gt;. (The
            array pointers can be &lt;symbol&gt;NULL&lt;/symbol&gt; when &lt;parameter&gt;nParams&lt;/parameter&gt;
            is zero.)
</span>
提供されるパラメータ数です。
これは配列<em class="parameter"><code>paramTypes[]</code></em>、<em class="parameter"><code>paramValues[]</code></em>、<em class="parameter"><code>paramLengths[]</code></em>、<em class="parameter"><code>paramFormats[]</code></em>の要素数です。
（この配列ポインタは、<em class="parameter"><code>nParams</code></em>が0の場合、<code class="symbol">NULL</code>とすることができます。）
           </p></dd><dt><span class="term"><em class="parameter"><code>paramTypes[]</code></em></span></dt><dd><p>
<span class="original">
            Specifies, by OID, the data types to be assigned to the
            parameter symbols.  If &lt;parameter&gt;paramTypes&lt;/parameter&gt; is
            &lt;symbol&gt;NULL&lt;/symbol&gt;, or any particular element in the array
            is zero, the server infers a data type for the parameter symbol
            in the same way it would do for an untyped literal string.
</span>
パラメータシンボルに代入されるデータ型をOIDで指定したものです。
<em class="parameter"><code>paramTypes</code></em>が<code class="symbol">NULL</code>、または、ある配列要素が0の場合、サーバは、型指定のないリテラル文字列に対して行う推定方法と同じ方法を使用して、パラメータシンボルのデータ型を推定します。
           </p></dd><dt><span class="term"><em class="parameter"><code>paramValues[]</code></em></span></dt><dd><p>
<span class="original">
            Specifies the actual values of the parameters.  A null pointer
            in this array means the corresponding parameter is null;
            otherwise the pointer points to a zero-terminated text string
            (for text format) or binary data in the format expected by the
            server (for binary format).
</span>
パラメータの実際の値を指定します。
配列内のヌルポインタは対応するパラメータがNULLであることを意味します。
さもなくば、このポインタはゼロ終端のテキスト文字列（テキスト書式）、または、サーバで想定している書式によるバイナリデータ（バイナリ書式）を指し示します。
           </p></dd><dt><span class="term"><em class="parameter"><code>paramLengths[]</code></em></span></dt><dd><p>
<span class="original">
            Specifies the actual data lengths of binary-format parameters.
            It is ignored for null parameters and text-format parameters.
            The array pointer can be null when there are no binary parameters.
</span>
バイナリ書式のパラメータの実データ長を指定します。
NULLパラメータおよびテキスト書式のパラメータでは無視されます。
バイナリパラメータが存在しない場合、この配列ポインタはヌルとしてもかまいません。
           </p></dd><dt><span class="term"><em class="parameter"><code>paramFormats[]</code></em></span></dt><dd><p>
<span class="original">
            Specifies whether parameters are text (put a zero in the
            array entry for the corresponding parameter) or binary (put
            a one in the array entry for the corresponding parameter).
            If the array pointer is null then all parameters are presumed
            to be text strings.
</span>
パラメータがテキスト（パラメータに対応する配列要素に0を設定）か、バイナリ（パラメータに対応する配列要素に1を設定）かを指定します。
この配列ポインタがヌルの場合、すべてのパラメータはテキスト文字列であると仮定されます。
           </p><p>
<span class="original">
            Values passed in binary format require knowledge of
            the internal representation expected by the backend.
            For example, integers must be passed in network byte
            order.  Passing &lt;type&gt;numeric&lt;/type&gt; values requires
            knowledge of the server storage format, as implemented
            in
            &lt;filename&gt;src/backend/utils/adt/numeric.c::numeric_send()&lt;/filename&gt; and
            &lt;filename&gt;src/backend/utils/adt/numeric.c::numeric_recv()&lt;/filename&gt;.
</span>
バイナリ書式で渡された値は、バックエンドが想定する内部表現の知識を必要とします。
例えば、整数はネットワークバイト順に渡されなければなりません。
<code class="type">numeric</code>による値は、<code class="filename">src/backend/utils/adt/numeric.c::numeric_send()</code>および<code class="filename">src/backend/utils/adt/numeric.c::numeric_recv()</code>で実装されたようにサーバストレージ書式の知識を必要とします。
           </p></dd><dt><span class="term"><em class="parameter"><code>resultFormat</code></em></span></dt><dd><p>
<span class="original">
            Specify zero to obtain results in text format, or one to obtain
            results in binary format.  (There is not currently a provision
            to obtain different result columns in different formats,
            although that is possible in the underlying protocol.)
</span>
結果をテキスト書式で取り出したい場合は0を、バイナリ書式で取り出したい場合は1を指定します。
（現時点では、プロトコル内部では実現可能ですが、結果の列ごとに異なる書式を指定して取り出す機構は存在しません。）
           </p></dd></dl></div><p>
       </p></dd></dl></div><p>
   </p><p>
<span class="original">
    The primary advantage of &lt;function&gt;PQexecParams&lt;/function&gt; over
    &lt;function&gt;PQexec&lt;/function&gt; is that parameter values can be separated from the
    command string, thus avoiding the need for tedious and error-prone
    quoting and escaping.
</span>
<code class="function">PQexec</code>に対する<code class="function">PQexecParams</code>の主要な利点は、コマンド文字列とパラメータ値を分離することができることです。
これにより、面倒でエラーを招きやすい引用符付けやエスケープ処理を行なう必要がなくなります。
   </p><p>
<span class="original">
    Unlike &lt;function&gt;PQexec&lt;/function&gt;, &lt;function&gt;PQexecParams&lt;/function&gt; allows at most
    one SQL command in the given string.  (There can be semicolons in it,
    but not more than one nonempty command.)  This is a limitation of the
    underlying protocol, but has some usefulness as an extra defense against
    SQL-injection attacks.
</span>
<code class="function">PQexec</code>と異なり、<code class="function">PQexecParams</code>は、文字列内に最大でも1つのSQLコマンドを入れることができます。
（セミコロンを入れることはできますが、空でないコマンドを2つ以上入れることはできません。）
これは、プロトコル自体の制限ですが、SQLインジェクション攻撃に対する追加の防御となりますので、多少役に立ちます。
   </p><div class="tip"><h3 class="title">ヒント</h3><p>
<span class="original">
     Specifying parameter types via OIDs is tedious, particularly if you prefer
     not to hard-wire particular OID values into your program.  However, you can
     avoid doing so even in cases where the server by itself cannot determine the
     type of the parameter, or chooses a different type than you want.  In the
     SQL command text, attach an explicit cast to the parameter symbol to show what
     data type you will send.  For example:
</span>
OID経由のパラメータ型の指定は、特にプログラムの中で特定のOID値がソースに直接書き込まれることを好まない場合には退屈です。
しかしながら、パラメータの型をサーバ自身で決定できない場合や、望む型と異なる型を選択する場合であっても、これを避けることができます。
SQLコマンドテキストでどのデータ型を送信するかを示すためにパラメータシンボルに明示的なキャストをつけてください。
以下が例です。

</p><pre class="programlisting">
SELECT * FROM mytable WHERE x = $1::bigint;
</pre><p>
<span class="original">
     This forces parameter &lt;literal&gt;$1&lt;/literal&gt; to be treated as &lt;type&gt;bigint&lt;/type&gt;, whereas
     by default it would be assigned the same type as &lt;literal&gt;x&lt;/literal&gt;.  Forcing the
     parameter type decision, either this way or by specifying a numeric type OID,
     is strongly recommended when sending parameter values in binary format, because
     binary format has less redundancy than text format and so there is less chance
     that the server will detect a type mismatch mistake for you.
</span>
デフォルトではパラメータ<code class="literal">$1</code>の型は<code class="literal">x</code>と同じデータ型に割り当てられますが、これにより強制的に<code class="type">bigint</code>として扱われます。
この方法または型のOIDを数字で指定する方法で、パラメータの型を強制的に決定することがバイナリ書式においてパラメータ値を送る時に強く推奨されます。
これは、バイナリ書式はテキスト書式より情報が少なく、そのために、サーバが型の不一致という問題を検出する機会が少なくなるためです。
    </p></div><p>
    </p><div class="variablelist"><dl class="variablelist"><dt id="LIBPQ-PQPREPARE"><span class="term"><code class="function">PQprepare</code>
       <a id="id-1.7.3.10.3.7.1.1.1.2" class="indexterm"></a>
      </span></dt><dd><p>
<span class="original">
        Submits a request to create a prepared statement with the
        given parameters, and waits for completion.
</span>
指定パラメータを持つプリペアド文の作成要求を送信し、その完了を待ちます。
</p><pre class="synopsis">
PGresult *PQprepare(PGconn *conn,
                    const char *stmtName,
                    const char *query,
                    int nParams,
                    const Oid *paramTypes);
</pre><p>
       </p><p>
<span class="original">
        &lt;function&gt;PQprepare&lt;/function&gt; creates a prepared statement for later
        execution with &lt;function&gt;PQexecPrepared&lt;/function&gt;.  This feature allows
        commands to be executed repeatedly without being parsed and
        planned each time;  see &lt;xref linkend="sql-prepare"/&gt; for details.
        &lt;function&gt;PQprepare&lt;/function&gt; is supported only in protocol 3.0 and later
        connections; it will fail when using protocol 2.0.
</span>
<code class="function">PQprepare</code>は、後で<code class="function">PQexecPrepared</code>を使用して実行するプリペアド文を作成します。
この機能を使用すると、コマンドを実行の度に解析して計画することなく、繰り返し実行することができます。
詳しくは<a class="xref" href="sql-prepare.html" title="PREPARE"><span class="refentrytitle">PREPARE</span></a>を参照してください。
<code class="function">PQprepare</code>はプロトコル3.0以降でのみサポートされ、プロトコル2.0を使用している場合は失敗します。
       </p><p>
<span class="original">
        The function creates a prepared statement named
        &lt;parameter&gt;stmtName&lt;/parameter&gt; from the &lt;parameter&gt;query&lt;/parameter&gt; string, which
        must contain a single SQL command.  &lt;parameter&gt;stmtName&lt;/parameter&gt; can be
        &lt;literal&gt;""&lt;/literal&gt; to create an unnamed statement, in which case any
        pre-existing unnamed statement is automatically replaced; otherwise
        it is an error if the statement name is already defined in the
        current session.  If any parameters are used, they are referred
        to in the query as &lt;literal&gt;$1&lt;/literal&gt;, &lt;literal&gt;$2&lt;/literal&gt;, etc.
        &lt;parameter&gt;nParams&lt;/parameter&gt; is the number of parameters for which types
        are pre-specified in the array &lt;parameter&gt;paramTypes[]&lt;/parameter&gt;.  (The
        array pointer can be &lt;symbol&gt;NULL&lt;/symbol&gt; when
        &lt;parameter&gt;nParams&lt;/parameter&gt; is zero.) &lt;parameter&gt;paramTypes[]&lt;/parameter&gt;
        specifies, by OID, the data types to be assigned to the parameter
        symbols.  If &lt;parameter&gt;paramTypes&lt;/parameter&gt; is &lt;symbol&gt;NULL&lt;/symbol&gt;,
        or any particular element in the array is zero, the server assigns
        a data type to the parameter symbol in the same way it would do
        for an untyped literal string.  Also, the query can use parameter
        symbols with numbers higher than &lt;parameter&gt;nParams&lt;/parameter&gt;; data types
        will be inferred for these symbols as well.  (See
        &lt;function&gt;PQdescribePrepared&lt;/function&gt; for a means to find out
        what data types were inferred.)
</span>
この関数は<em class="parameter"><code>query</code></em>文字列から<em class="parameter"><code>stmtName</code></em>という名前のプリペアド文を作成します。
<em class="parameter"><code>query</code></em>は単一のSQLコマンドでなければなりません。
<em class="parameter"><code>stmtName</code></em>を<code class="literal">""</code>にして、無名の文を作成することができます。
もし、無名の文が既に存在していた場合は自動的に置き換えられます。
その他の場合、文の名前が現在のセッションで既に存在するとエラーになります。
何らかのパラメータが使用される場合、問い合わせ内では<code class="literal">$1</code>、<code class="literal">$2</code>などで参照します。
<em class="parameter"><code>nParams</code></em>はパラメータ数です。
その型については事前に<em class="parameter"><code>paramTypes[]</code></em>配列で指定されています。
(<em class="parameter"><code>nParams</code></em>がゼロの場合、この配列ポインタは<code class="symbol">NULL</code>にすることができます。)
<em class="parameter"><code>paramTypes[]</code></em>は、OIDによりパラメータシンボルに割り当てるデータ型を指定します。
<em class="parameter"><code>paramTypes</code></em>が<code class="symbol">NULL</code>の場合、もしくは、配列内の特定要素がゼロの場合、サーバはそのパラメータシンボルに対して、型指定の無いリテラル文字列に対する処理と同等の方法でデータ型を割り当てます。
また、問い合わせでは<em class="parameter"><code>nParams</code></em>より多くのパラメータシンボルを使用することができます。
これらのシンボルに対するデータ型も同様に推測されます。
（どのようなデータ型が推測されるかを検出する手法については<code class="function">PQdescribePrepared</code>を参照してください。）
       </p><p>
<span class="original">
        As with &lt;function&gt;PQexec&lt;/function&gt;, the result is normally a
        &lt;structname&gt;PGresult&lt;/structname&gt; object whose contents indicate
        server-side success or failure.  A null result indicates
        out-of-memory or inability to send the command at all.  Use
        &lt;function&gt;PQerrorMessage&lt;/function&gt; to get more information about
        such errors.
</span>
<code class="function">PQexec</code>同様、結果は通常<code class="structname">PGresult</code>オブジェクトで、その内容でサーバ側の成功や失敗を示します。
ヌルという結果はメモリ不足や全くコマンドを送信することができなかったことを示します。
こうしたエラーの詳細情報を入手するには<code class="function">PQerrorMessage</code>を使用してください。
       </p></dd></dl></div><p>

<span class="original">
    Prepared statements for use with &lt;function&gt;PQexecPrepared&lt;/function&gt; can also
    be created by executing SQL &lt;xref linkend="sql-prepare"/&gt;
    statements.  Also, although there is no &lt;application&gt;libpq&lt;/application&gt;
    function for deleting a prepared statement, the SQL &lt;xref
    linkend="sql-deallocate"/&gt; statement
    can be used for that purpose.
</span>
<code class="function">PQexecPrepared</code>で使用するためのプリペアド文は、<a class="xref" href="sql-prepare.html" title="PREPARE"><span class="refentrytitle">PREPARE</span></a> SQL文を実行することでも作成可能です。
また、プリペアド文を削除する<span class="application">libpq</span>関数はありませんが、この目的のために<a class="xref" href="sql-deallocate.html" title="DEALLOCATE"><span class="refentrytitle">DEALLOCATE</span></a>SQL文を使用することができます。
   </p><p>
    </p><div class="variablelist"><dl class="variablelist"><dt id="LIBPQ-PQEXECPREPARED"><span class="term">
       <code class="function">PQexecPrepared</code>
       <a id="id-1.7.3.10.3.8.1.1.1.2" class="indexterm"></a>
      </span></dt><dd><p>
<span class="original">
        Sends a request to execute a prepared statement with given
        parameters, and waits for the result.
</span>
指定パラメータによるプリペアド文の実行要求を送信し、結果を待ちます。
</p><pre class="synopsis">
PGresult *PQexecPrepared(PGconn *conn,
                         const char *stmtName,
                         int nParams,
                         const char * const *paramValues,
                         const int *paramLengths,
                         const int *paramFormats,
                         int resultFormat);
</pre><p>
       </p><p>
<span class="original">
        &lt;function&gt;PQexecPrepared&lt;/function&gt; is like &lt;function&gt;PQexecParams&lt;/function&gt;,
        but the command to be executed is specified by naming a
        previously-prepared statement, instead of giving a query string.
        This feature allows commands that will be used repeatedly to be
        parsed and planned just once, rather than each time they are
        executed.  The statement must have been prepared previously in
        the current session.  &lt;function&gt;PQexecPrepared&lt;/function&gt; is supported
        only in protocol 3.0 and later connections; it will fail when
        using protocol 2.0.
</span>
<code class="function">PQexecPrepared</code>と<code class="function">PQexecParams</code>は似ていますが、前者では実行されるコマンドは、問い合わせ文字列を与えるのではなく、事前にプリペアド文を指名することで指定されます。
この機能により、繰り返し使用する予定のコマンドを実行する度にではなく、一度だけ解析、計画作成を行うことができます。
この文は現在のセッションで事前に準備されていなければなりません。
<code class="function">PQexecPrepared</code>は、プロトコル3.0以降の接続でのみサポートされます。
プロトコル2.0で使用した場合は失敗します。
       </p><p>
<span class="original">
        The parameters are identical to &lt;function&gt;PQexecParams&lt;/function&gt;, except that the
        name of a prepared statement is given instead of a query string, and the
        &lt;parameter&gt;paramTypes[]&lt;/parameter&gt; parameter is not present (it is not needed since
        the prepared statement's parameter types were determined when it was created).
</span>
パラメータは、問い合わせ文字列ではなく指定されたプリペアド文の名前を与える点を除き、<code class="function">PQexecParams</code>と同じです。
また、<em class="parameter"><code>paramTypes[]</code></em>パラメータは存在しません。
(プリペアド文のパラメータ型はその作成時点で決定されているため、これは不要です。)
       </p></dd><dt id="LIBPQ-PQDESCRIBEPREPARED"><span class="term">
       <code class="function">PQdescribePrepared</code>
       <a id="id-1.7.3.10.3.8.1.2.1.2" class="indexterm"></a>
      </span></dt><dd><p>
<span class="original">
        Submits a request to obtain information about the specified
        prepared statement, and waits for completion.
</span>
指定したプリペアド文に関する情報入手要求を送り、入手完了まで待機します。

</p><pre class="synopsis">
PGresult *PQdescribePrepared(PGconn *conn, const char *stmtName);
</pre><p>
       </p><p>
<span class="original">
        &lt;function&gt;PQdescribePrepared&lt;/function&gt; allows an application to obtain
        information about a previously prepared statement.
        &lt;function&gt;PQdescribePrepared&lt;/function&gt; is supported only in protocol 3.0
        and later connections; it will fail when using protocol 2.0.
</span>
<code class="function">PQdescribePrepared</code>により、アプリケーションは事前にプリペアド文に関する情報を入手できます。
<code class="function">PQdescribePrepared</code>はプロトコル3.0以降の接続でのみサポートされます。
プロトコル2.0で使用すると失敗します。
       </p><p>
<span class="original">
        &lt;parameter&gt;stmtName&lt;/parameter&gt; can be &lt;literal&gt;""&lt;/literal&gt; or &lt;symbol&gt;NULL&lt;/symbol&gt; to reference
        the unnamed statement, otherwise it must be the name of an existing
        prepared statement.  On success, a &lt;structname&gt;PGresult&lt;/structname&gt; with
        status &lt;literal&gt;PGRES_COMMAND_OK&lt;/literal&gt; is returned.  The
        functions &lt;function&gt;PQnparams&lt;/function&gt; and
        &lt;function&gt;PQparamtype&lt;/function&gt; can be applied to this
        &lt;structname&gt;PGresult&lt;/structname&gt; to obtain information about the parameters
        of the prepared statement, and the functions
        &lt;function&gt;PQnfields&lt;/function&gt;, &lt;function&gt;PQfname&lt;/function&gt;,
        &lt;function&gt;PQftype&lt;/function&gt;, etc provide information about the
        result columns (if any) of the statement.
</span>
<em class="parameter"><code>stmtName</code></em>を<code class="literal">""</code>または<code class="symbol">NULL</code>とすることで、無名の文を参照することができます。
これ以外では、存在するプリペアド文の名前でなければなりません。
成功すると、<code class="literal">PGRES_COMMAND_OK</code>というステータスの<code class="structname">PGresult</code>が返されます。
<code class="function">PQnparams</code>および<code class="function">PQparamtype</code>関数をこの<code class="structname">PGresult</code>に適用して、プリペアド文のパラメータに関する情報を得ることができます。
また、<code class="function">PQnfields</code>、<code class="function">PQfname</code>、<code class="function">PQftype</code>関数などを使用して、文の結果列（もしあれば）に関する情報を提供できます。
       </p></dd><dt id="LIBPQ-PQDESCRIBEPORTAL"><span class="term">
       <code class="function">PQdescribePortal</code>
       <a id="id-1.7.3.10.3.8.1.3.1.2" class="indexterm"></a>
      </span></dt><dd><p>
<span class="original">
        Submits a request to obtain information about the specified
        portal, and waits for completion.
</span>
指定したポータルに関する情報入手要求を送信し、完了まで待機します。

</p><pre class="synopsis">
PGresult *PQdescribePortal(PGconn *conn, const char *portalName);
</pre><p>
       </p><p>
<span class="original">
        &lt;function&gt;PQdescribePortal&lt;/function&gt; allows an application to obtain
        information about a previously created portal.
        (&lt;application&gt;libpq&lt;/application&gt; does not provide any direct access to
        portals, but you can use this function to inspect the properties
        of a cursor created with a &lt;command&gt;DECLARE CURSOR&lt;/command&gt; SQL command.)
        &lt;function&gt;PQdescribePortal&lt;/function&gt; is supported only in protocol 3.0
        and later connections; it will fail when using protocol 2.0.
</span>
<code class="function">PQdescribePortal</code>により、アプリケーションは事前に作成されたポータルの情報を入手することができます。
（<span class="application">libpq</span>はポータルへの直接アクセスする方法を提供していませんが、この関数を使用して<code class="command">DECLARE CURSOR</code> SQLコマンドで作成したカーソルの属性を確認することができます。）
<code class="function">PQdescribePortal</code>はプロトコル3.0以降の接続でのみサポートされます。
プロトコル2.0で使用すると失敗します。
       </p><p>
<span class="original">
        &lt;parameter&gt;portalName&lt;/parameter&gt; can be &lt;literal&gt;""&lt;/literal&gt; or &lt;symbol&gt;NULL&lt;/symbol&gt; to reference
        the unnamed portal, otherwise it must be the name of an existing
        portal.  On success, a &lt;structname&gt;PGresult&lt;/structname&gt; with status
        &lt;literal&gt;PGRES_COMMAND_OK&lt;/literal&gt; is returned.  The functions
        &lt;function&gt;PQnfields&lt;/function&gt;, &lt;function&gt;PQfname&lt;/function&gt;,
        &lt;function&gt;PQftype&lt;/function&gt;, etc can be applied to the
        &lt;structname&gt;PGresult&lt;/structname&gt; to obtain information about the result
        columns (if any) of the portal.
</span>
<em class="parameter"><code>portalName</code></em>に<code class="literal">""</code>または<code class="symbol">NULL</code>を指定して、無名のポータルを参照することができます。
これ以外では、既存のポータルの名前でなければなりません。
成功すると、<code class="literal">PGRES_COMMAND_OK</code>というステータスの<code class="structname">PGresult</code>が返されます。
<code class="function">PQnfields</code>、<code class="function">PQfname</code>、<code class="function">PQftype</code>関数などをこの<code class="structname">PGresult</code>に適用して、ポータルの結果列（もしあれば）に関する情報を得ることができます。
       </p></dd></dl></div><p>
   </p><p>
<span class="original">
    The &lt;structname&gt;PGresult&lt;/structname&gt;&lt;indexterm&gt;&lt;primary&gt;PGresult&lt;/primary&gt;&lt;/indexterm&gt;
    structure encapsulates the result returned by the server.
    &lt;application&gt;libpq&lt;/application&gt; application programmers should be
    careful to maintain the &lt;structname&gt;PGresult&lt;/structname&gt; abstraction.
    Use the accessor functions below to get at the contents of
    &lt;structname&gt;PGresult&lt;/structname&gt;.  Avoid directly referencing the
    fields of the &lt;structname&gt;PGresult&lt;/structname&gt; structure because they
    are subject to change in the future.
</span>
<code class="structname">PGresult</code>構造体はサーバから返された結果をカプセル化します。
<a id="id-1.7.3.10.3.9.2" class="indexterm"></a>
<span class="application">libpq</span>アプリケーションのプログラマは注意して<code class="structname">PGresult</code>という抽象化を維持してください。
以下のアクセス用関数を使用して、<code class="structname">PGresult</code>の内容を取り出してください。
将来の変更に影響されますので、<code class="structname">PGresult</code>構造体のフィールドを直接参照することは避けてください。

    </p><div class="variablelist"><dl class="variablelist"><dt id="LIBPQ-PQRESULTSTATUS"><span class="term">
       <code class="function">PQresultStatus</code>
       <a id="id-1.7.3.10.3.9.7.1.1.2" class="indexterm"></a>
      </span></dt><dd><p>
<span class="original">
        Returns the result status of the command.
</span>
コマンドの結果状態を返します。
</p><pre class="synopsis">
ExecStatusType PQresultStatus(const PGresult *res);
</pre><p>
       </p><p>
<span class="original">
        &lt;function&gt;PQresultStatus&lt;/function&gt; can return one of the following values:
</span>
<code class="function">PQresultStatus</code>は以下のいずれかの値を返します。

        </p><div class="variablelist"><dl class="variablelist"><dt id="LIBPQ-PGRES-EMPTY-QUERY"><span class="term"><code class="literal">PGRES_EMPTY_QUERY</code></span></dt><dd><p>
<span class="original">
            The string sent to the server was empty.
</span>
サーバに送信された文字列が空でした。
           </p></dd><dt id="LIBPQ-PGRES-COMMAND-OK"><span class="term"><code class="literal">PGRES_COMMAND_OK</code></span></dt><dd><p>
<span class="original">
            Successful completion of a command returning no data.
</span>
データを返さないコマンドが正常終了しました。
           </p></dd><dt id="LIBPQ-PGRES-TUPLES-OK"><span class="term"><code class="literal">PGRES_TUPLES_OK</code></span></dt><dd><p>
<span class="original">
            Successful completion of a command returning data (such as
            a &lt;command&gt;SELECT&lt;/command&gt; or &lt;command&gt;SHOW&lt;/command&gt;).
</span>
データを返すコマンド(<code class="command">SELECT</code>や<code class="command">SHOW</code>など)が正常終了しました。
           </p></dd><dt id="LIBPQ-PGRES-COPY-OUT"><span class="term"><code class="literal">PGRES_COPY_OUT</code></span></dt><dd><p>
<span class="original">
            Copy Out (from server) data transfer started.
</span>
(サーバからの)コピーアウトデータ転送が始まりました。
           </p></dd><dt id="LIBPQ-PGRES-COPY-IN"><span class="term"><code class="literal">PGRES_COPY_IN</code></span></dt><dd><p>
<span class="original">
            Copy In (to server) data transfer started.
</span>
(サーバへの)コピーインデータ転送が始まりました。
           </p></dd><dt id="LIBPQ-PGRES-BAD-RESPONSE"><span class="term"><code class="literal">PGRES_BAD_RESPONSE</code></span></dt><dd><p>
<span class="original">
            The server's response was not understood.
</span>
サーバが不明な応答を返しました。
           </p></dd><dt id="LIBPQ-PGRES-NONFATAL-ERROR"><span class="term"><code class="literal">PGRES_NONFATAL_ERROR</code></span></dt><dd><p>
<span class="original">
            A nonfatal error (a notice or warning) occurred.
</span>
致命的ではない(注意喚起もしくは警告)エラーが発生しました。
           </p></dd><dt id="LIBPQ-PGRES-FATAL-ERROR"><span class="term"><code class="literal">PGRES_FATAL_ERROR</code></span></dt><dd><p>
<span class="original">
            A fatal error occurred.
</span>
致命的なエラーが発生しました。
           </p></dd><dt id="LIBPQ-PGRES-COPY-BOTH"><span class="term"><code class="literal">PGRES_COPY_BOTH</code></span></dt><dd><p>
<span class="original">
            Copy In/Out (to and from server) data transfer started.  This
            feature is currently used only for streaming replication,
            so this status should not occur in ordinary applications.
</span>
（サーバからおよびサーバへの）コピーイン/アウトデータ転送が始まりました。
現在こればストリーミングレプリケーションのみで使用されます。
このためこの状態は通常のアプリケーションでは起こりません。
           </p></dd><dt id="LIBPQ-PGRES-SINGLE-TUPLE"><span class="term"><code class="literal">PGRES_SINGLE_TUPLE</code></span></dt><dd><p>
<span class="original">
            The &lt;structname&gt;PGresult&lt;/structname&gt; contains a single result tuple
            from the current command.  This status occurs only when
            single-row mode has been selected for the query
            (see &lt;xref linkend="libpq-single-row-mode"/&gt;).
</span>
<code class="structname">PGresult</code>には現在のコマンドからの結果タプルが１つ含まれます。
この状態は問い合わせで単一行モードが選択された場合（<a class="xref" href="libpq-single-row-mode.html" title="34.5. １行１行問い合わせ結果を受け取る">34.5</a>参照）のみ起こります。
           </p></dd></dl></div><p>

<span class="original">
        If the result status is &lt;literal&gt;PGRES_TUPLES_OK&lt;/literal&gt; or
        &lt;literal&gt;PGRES_SINGLE_TUPLE&lt;/literal&gt;, then
        the functions described below can be used to retrieve the rows
        returned by the query.  Note that a &lt;command&gt;SELECT&lt;/command&gt;
        command that happens to retrieve zero rows still shows
        &lt;literal&gt;PGRES_TUPLES_OK&lt;/literal&gt;.
        &lt;literal&gt;PGRES_COMMAND_OK&lt;/literal&gt; is for commands that can never
        return rows (&lt;command&gt;INSERT&lt;/command&gt; or &lt;command&gt;UPDATE&lt;/command&gt;
        without a &lt;literal&gt;RETURNING&lt;/literal&gt; clause,
        etc.). A response of &lt;literal&gt;PGRES_EMPTY_QUERY&lt;/literal&gt; might
        indicate a bug in the client software.
</span>
結果状態が<code class="literal">PGRES_TUPLES_OK</code>または<code class="literal">PGRES_SINGLE_TUPLE</code>であれば、以下で説明する関数を使って問い合わせが返した行を取り出すことができます。
ただし、たまたま<code class="command">SELECT</code>コマンドが返す行が０個だったような場合でも<code class="literal">PGRES_TUPLES_OK</code>となることに注意してください。
<code class="literal">PGRES_COMMAND_OK</code>は、行を決して返さない(<code class="literal">RETURNING</code>句の無い<code class="command">INSERT</code>または<code class="command">UPDATE</code>など)コマンド用です。
<code class="literal">PGRES_EMPTY_QUERY</code>という応答はクライアントソフトウェアの不具合を示しているかもしれません。
       </p><p>
<span class="original">
        A result of status &lt;symbol&gt;PGRES_NONFATAL_ERROR&lt;/symbol&gt; will
        never be returned directly by &lt;function&gt;PQexec&lt;/function&gt; or other
        query execution functions; results of this kind are instead passed
        to the notice processor (see &lt;xref
        linkend="libpq-notice-processing"/&gt;).
</span>
<code class="symbol">PGRES_NONFATAL_ERROR</code>状態の場合、結果は<code class="function">PQexec</code>や他の問い合わせ実行関数によって直接返されません。
その代わりに、この種の結果は注意喚起プロセッサ(<a class="xref" href="libpq-notice-processing.html" title="34.12. 警告処理">34.12</a>参照)に渡されます。
       </p></dd><dt id="LIBPQ-PQRESSTATUS"><span class="term">
       <code class="function">PQresStatus</code>
       <a id="id-1.7.3.10.3.9.7.2.1.2" class="indexterm"></a>
      </span></dt><dd><p>
<span class="original">
        Converts the enumerated type returned by
        &lt;function&gt;PQresultStatus&lt;/function&gt; into a string constant describing the
        status code. The caller should not free the result.
</span>
<code class="function">PQresultStatus</code>が返す列挙型から状態コードを説明する文字列定数に変換します。
呼び出し元はこの結果を解放してはいけません。

</p><pre class="synopsis">
char *PQresStatus(ExecStatusType status);
</pre><p>
       </p></dd><dt id="LIBPQ-PQRESULTERRORMESSAGE"><span class="term">
       <code class="function">PQresultErrorMessage</code>
       <a id="id-1.7.3.10.3.9.7.3.1.2" class="indexterm"></a>
      </span></dt><dd><p>
<span class="original">
        Returns the error message associated with the command, or an empty string
        if there was no error.
</span>
コマンドに関するエラーメッセージを返します。
エラーが何もなければ、空の文字列を返します。
</p><pre class="synopsis">
char *PQresultErrorMessage(const PGresult *res);
</pre><p>
<span class="original">
        If there was an error, the returned string will include a trailing
        newline.  The caller should not free the result directly. It will
        be freed when the associated &lt;structname&gt;PGresult&lt;/structname&gt; handle is
        passed to &lt;function&gt;PQclear&lt;/function&gt;.
</span>
エラーがあった場合、返される文字列の最後には改行が含まれます。
呼び出し元はこの結果を直接解放してはいけません。
関連する<code class="structname">PGresult</code>ハンドルが<code class="function">PQclear</code>に渡された時にこれは解放されます。
       </p><p>
<span class="original">
        Immediately following a &lt;function&gt;PQexec&lt;/function&gt; or
        &lt;function&gt;PQgetResult&lt;/function&gt; call,
        &lt;function&gt;PQerrorMessage&lt;/function&gt; (on the connection) will return
        the same string as &lt;function&gt;PQresultErrorMessage&lt;/function&gt; (on
        the result).  However, a &lt;structname&gt;PGresult&lt;/structname&gt; will
        retain its error message until destroyed, whereas the connection's
        error message will change when subsequent operations are done.
        Use &lt;function&gt;PQresultErrorMessage&lt;/function&gt; when you want to
        know the status associated with a particular
        &lt;structname&gt;PGresult&lt;/structname&gt;; use
        &lt;function&gt;PQerrorMessage&lt;/function&gt; when you want to know the
        status from the latest operation on the connection.
</span>
（接続に対する）<code class="function">PQerrorMessage</code>も、<code class="function">PQexec</code>または<code class="function">PQgetResult</code>呼び出しの直後なら（結果に対する）<code class="function">PQresultErrorMessage</code>と同じ文字列を返します。
しかし、接続に対するエラーメッセージは続いて操作を行うと変化してしまうのに対し、<code class="structname">PGresult</code>は自身が破棄されるまでそのエラーメッセージを維持し続けます。
この<code class="function">PQresultErrorMessage</code>は個々の<code class="structname">PGresult</code>に結び付けられた状態を確認する時に、そして<code class="function">PQerrorMessage</code>は接続における最後の操作の状態を確認する時に使用してください。
       </p></dd><dt id="LIBPQ-PQRESULTVERBOSEERRORMESSAGE"><span class="term">
       <code class="function">PQresultVerboseErrorMessage</code>
       <a id="id-1.7.3.10.3.9.7.4.1.2" class="indexterm"></a>
      </span></dt><dd><p>
<span class="original">
        Returns a reformatted version of the error message associated with
        a &lt;structname&gt;PGresult&lt;/structname&gt; object.
</span>
<code class="structname">PGresult</code>オブジェクトに関連したエラーメッセージの再フォーマットしたバージョンを返します。
</p><pre class="synopsis">
char *PQresultVerboseErrorMessage(const PGresult *res,
                                  PGVerbosity verbosity,
                                  PGContextVisibility show_context);
</pre><p>
<span class="original">
        In some situations a client might wish to obtain a more detailed
        version of a previously-reported error.
        &lt;function&gt;PQresultVerboseErrorMessage&lt;/function&gt; addresses this need
        by computing the message that would have been produced
        by &lt;function&gt;PQresultErrorMessage&lt;/function&gt; if the specified
        verbosity settings had been in effect for the connection when the
        given &lt;structname&gt;PGresult&lt;/structname&gt; was generated.  If
        the &lt;structname&gt;PGresult&lt;/structname&gt; is not an error result,
        &lt;quote&gt;PGresult is not an error result&lt;/quote&gt; is reported instead.
        The returned string includes a trailing newline.
</span>
状況によっては、クライアントは以前に報告されたエラーのより詳細なバージョンを取得したいと思うかもしれません。
<code class="function">PQresultVerboseErrorMessage</code>は、指定の<code class="structname">PGresult</code>が生成されたときに、指定した冗長設定がその接続で使われていたなら<code class="function">PQresultErrorMessage</code>が生成したであろうメッセージを計算することで、この要請に応えます。
<code class="structname">PGresult</code>がエラーの結果ではない場合は、<span class="quote">「<span class="quote">PGresult is not an error result</span>」</span>が代わりに報告されます。
返される文字列は行末に改行コードが含まれます。
       </p><p>
<span class="original">
        Unlike most other functions for extracting data from
        a &lt;structname&gt;PGresult&lt;/structname&gt;, the result of this function is a freshly
        allocated string.  The caller must free it
        using &lt;function&gt;PQfreemem()&lt;/function&gt; when the string is no longer needed.
</span>
<code class="structname">PGresult</code>からデータを抽出する他の多くの関数と異なり、この関数の結果は新しく割り当てられた文字列です。
その文字列が必要なくなったときは、呼び出し側が<code class="function">PQfreemem()</code>を使ってそれを解放しなければなりません。
       </p><p>
<span class="original">
        A NULL return is possible if there is insufficient memory.
</span>
十分なメモリがないときは、NULLが返されることもありえます。
       </p></dd><dt id="LIBPQ-PQRESULTERRORFIELD"><span class="term"><code class="function">PQresultErrorField</code><a id="id-1.7.3.10.3.9.7.5.1.2" class="indexterm"></a></span></dt><dd><p>
<span class="original">
        Returns an individual field of an error report.
</span>
エラー報告の個々のフィールドを返します。
</p><pre class="synopsis">
char *PQresultErrorField(const PGresult *res, int fieldcode);
</pre><p>
<span class="original">
        &lt;parameter&gt;fieldcode&lt;/parameter&gt; is an error field identifier; see the symbols
        listed below.  &lt;symbol&gt;NULL&lt;/symbol&gt; is returned if the
        &lt;structname&gt;PGresult&lt;/structname&gt; is not an error or warning result,
        or does not include the specified field.  Field values will normally
        not include a trailing newline. The caller should not free the
        result directly. It will be freed when the
        associated &lt;structname&gt;PGresult&lt;/structname&gt; handle is passed to
        &lt;function&gt;PQclear&lt;/function&gt;.
</span>
<em class="parameter"><code>fieldcode</code></em>はエラーフィールド識別子です。
以下に示すシンボルを参照してください。
<code class="structname">PGresult</code>がエラーではない、もしくは、警告付きの結果である場合や指定したフィールドを含まない場合、<code class="symbol">NULL</code>が返されます。
通常フィールド値には改行が含まれません。
フィールド値は関連する<code class="structname">PGresult</code>ハンドルが<code class="function">PQclear</code>に渡された時に解放されます。
       </p><p>
<span class="original">
        The following field codes are available:
</span>
以下のフィールドコードが使用できます。
        </p><div class="variablelist"><dl class="variablelist"><dt id="LIBPQ-PG-DIAG-SEVERITY"><span class="term"><code class="symbol">PG_DIAG_SEVERITY</code></span></dt><dd><p>
<span class="original">
            The severity; the field contents are &lt;literal&gt;ERROR&lt;/literal&gt;,
            &lt;literal&gt;FATAL&lt;/literal&gt;, or &lt;literal&gt;PANIC&lt;/literal&gt; (in an error message),
            or &lt;literal&gt;WARNING&lt;/literal&gt;, &lt;literal&gt;NOTICE&lt;/literal&gt;, &lt;literal&gt;DEBUG&lt;/literal&gt;,
            &lt;literal&gt;INFO&lt;/literal&gt;, or &lt;literal&gt;LOG&lt;/literal&gt; (in a notice message), or
            a localized translation of one of these.  Always present.
</span>
深刻度。
このフィールドの内容は(エラーメッセージの場合)<code class="literal">ERROR</code>、<code class="literal">FATAL</code>、もしくは、<code class="literal">PANIC</code>、(注意喚起メッセージの場合)<code class="literal">WARNING</code>、<code class="literal">NOTICE</code>、<code class="literal">DEBUG</code>、<code class="literal">INFO</code>、もしくは、<code class="literal">LOG</code>です。
これらは、多言語化により翻訳されている可能性があります。
常に存在します。
           </p></dd><dt id="LIBPQ-PG-DIAG-SEVERITY-NONLOCALIZED"><span class="term"><code class="symbol">PG_DIAG_SEVERITY_NONLOCALIZED</code></span></dt><dd><p>
<span class="original">
            The severity; the field contents are &lt;literal&gt;ERROR&lt;/literal&gt;,
            &lt;literal&gt;FATAL&lt;/literal&gt;, or &lt;literal&gt;PANIC&lt;/literal&gt; (in an error message),
            or &lt;literal&gt;WARNING&lt;/literal&gt;, &lt;literal&gt;NOTICE&lt;/literal&gt;, &lt;literal&gt;DEBUG&lt;/literal&gt;,
            &lt;literal&gt;INFO&lt;/literal&gt;, or &lt;literal&gt;LOG&lt;/literal&gt; (in a notice message).
            This is identical to the &lt;symbol&gt;PG_DIAG_SEVERITY&lt;/symbol&gt; field except
            that the contents are never localized.  This is present only in
            reports generated by &lt;productname&gt;PostgreSQL&lt;/productname&gt; versions 9.6
            and later.
</span>
深刻度。
このフィールドの内容は(エラーメッセージの場合)<code class="literal">ERROR</code>、<code class="literal">FATAL</code>、もしくは、<code class="literal">PANIC</code>、(注意喚起メッセージの場合)<code class="literal">WARNING</code>、<code class="literal">NOTICE</code>、<code class="literal">DEBUG</code>、<code class="literal">INFO</code>、もしくは、<code class="literal">LOG</code>です。
これは、内容が多言語化されないことを除き、<code class="symbol">PG_DIAG_SEVERITY</code>と同一です。
これは<span class="productname">PostgreSQL</span>のバージョン9.6以降で生成された報告にのみ存在します。
           </p></dd><dt id="LIBPQ-PG-DIAG-SQLSTATE"><span class="term">
           <code class="symbol">PG_DIAG_SQLSTATE</code>
          <a id="id-1.7.3.10.3.9.7.5.2.2.1.3.1.2" class="indexterm"></a>
          </span></dt><dd><p>
<span class="original">
            The SQLSTATE code for the error. The SQLSTATE code identifies
            the type of error that has occurred; it can be used by
            front-end applications to perform specific operations (such
            as error handling) in response to a particular database error.
            For a list of the possible SQLSTATE codes, see &lt;xref
            linkend="errcodes-appendix"/&gt;. This field is not localizable,
            and is always present.
</span>
エラーのSQLSTATEコードです。
SQLSTATEコードは発生したエラーの種類を識別します。
フロントエンドアプリケーションにより、特定のデータベースエラーに対して所定の操作（エラー処理など）を行うために使用できます。
起こり得るSQLSTATEコードの一覧については<a class="xref" href="errcodes-appendix.html" title="付録A PostgreSQLエラーコード">付録A</a>を参照してください。
このフィールドは多言語化されず、また、常に存在します。
           </p></dd><dt id="LIBPQ-PG-DIAG-MESSAGE-PRIMARY"><span class="term"><code class="symbol">PG_DIAG_MESSAGE_PRIMARY</code></span></dt><dd><p>
<span class="original">
            The primary human-readable error message (typically one line).
            Always present.
</span>
可読性を高めた主要エラーメッセージです。
(通常は1行です。)
常に存在します。
           </p></dd><dt id="LIBPQ-PG-DIAG-MESSAGE-DETAIL"><span class="term"><code class="symbol">PG_DIAG_MESSAGE_DETAIL</code></span></dt><dd><p>
<span class="original">
            Detail: an optional secondary error message carrying more
            detail about the problem.  Might run to multiple lines.
</span>
詳細です。
問題に関するより詳細を表す補助的なエラーメッセージです。
複数行に跨る可能性があります。
           </p></dd><dt id="LIBPQ-PG-DIAG-MESSAGE-HINT"><span class="term"><code class="symbol">PG_DIAG_MESSAGE_HINT</code></span></dt><dd><p>
<span class="original">
            Hint: an optional suggestion what to do about the problem.
            This is intended to differ from detail in that it offers advice
            (potentially inappropriate) rather than hard facts.  Might
            run to multiple lines.
</span>
ヒントです。
問題の対応方法についての補助的な提言です。
これは、詳細(detail)とは異なり、問題の事象ではなく、(適切でない可能性がありますが)アドバイスを提供することを目的としています。
複数行に跨る可能性があります。
           </p></dd><dt id="LIBPQ-PG-DIAG-STATEMENT-POSITION"><span class="term"><code class="symbol">PG_DIAG_STATEMENT_POSITION</code></span></dt><dd><p>
<span class="original">
            A string containing a decimal integer indicating an error cursor
            position as an index into the original statement string.  The
            first character has index 1, and positions are measured in
            characters not bytes.
</span>
元の問い合わせ文字列のインデックスとなる、エラーが発生したカーソル位置を示す10進整数を持つ文字列です。
先頭文字がインデックス1となり、また、バイトではなく、文字数で数えた位置です。
           </p></dd><dt id="LIBPQ-PG-DIAG-INTERNAL-POSITION"><span class="term"><code class="symbol">PG_DIAG_INTERNAL_POSITION</code></span></dt><dd><p>
<span class="original">
            This is defined the same as the
            &lt;symbol&gt;PG_DIAG_STATEMENT_POSITION&lt;/symbol&gt; field, but it is used
            when the cursor position refers to an internally generated
            command rather than the one submitted by the client.  The
            &lt;symbol&gt;PG_DIAG_INTERNAL_QUERY&lt;/symbol&gt; field will always appear when
            this field appears.
</span>
この定義は<code class="symbol">PG_DIAG_STATEMENT_POSITION</code>フィールドと同じです。
しかし、これは、クライアントが発行したコマンドではなく、カーソル位置が内部生成コマンドを参照する場合に使用されます。
このフィールドが存在する時は常に<code class="symbol">PG_DIAG_INTERNAL_QUERY</code>フィールドが存在します。
           </p></dd><dt id="LIBPQ-PG-DIAG-INTERNAL-QUERY"><span class="term"><code class="symbol">PG_DIAG_INTERNAL_QUERY</code></span></dt><dd><p>
<span class="original">
            The text of a failed internally-generated command.  This could
            be, for example, a SQL query issued by a PL/pgSQL function.
</span>
失敗した内部生成コマンドのテキストです。
これは、例えば、PL/pgSQL関数で発行されたSQL問い合わせになります。
           </p></dd><dt id="LIBPQ-PG-DIAG-CONTEXT"><span class="term"><code class="symbol">PG_DIAG_CONTEXT</code></span></dt><dd><p>
<span class="original">
            An indication of the context in which the error occurred.
            Presently this includes a call stack traceback of active
            procedural language functions and internally-generated queries.
            The trace is one entry per line, most recent first.
</span>
エラーが発生した文脈を示すものです。
今の所、これは活動中の手続き言語関数や内部生成問い合わせの呼び出しスタックの追跡情報が含まれます。
この追跡は行単位で1項目であり、その順番は呼び出し順の反対になります。
           </p></dd><dt id="LIBPQ-PG-DIAG-SCHEMA-NAME"><span class="term"><code class="symbol">PG_DIAG_SCHEMA_NAME</code></span></dt><dd><p>
<span class="original">
            If the error was associated with a specific database object,
            the name of the schema containing that object, if any.
</span>
そのエラーが特定のデータベースオブジェクトに付随する場合、もしあれば、そのオブジェクトを含むスキーマ名です。
           </p></dd><dt id="LIBPQ-PG-DIAG-TABLE-NAME"><span class="term"><code class="symbol">PG_DIAG_TABLE_NAME</code></span></dt><dd><p>
<span class="original">
            If the error was associated with a specific table, the name of the
            table.  (Refer to the schema name field for the name of the
            table's schema.)
</span>
そのエラーが特定のテーブルに付随する場合のテーブル名です。
（テーブルのスキーマ名についてはスキーマ名フィールドを参照ください。）
           </p></dd><dt id="LIBPQ-PG-DIAG-COLUMN-NAME"><span class="term"><code class="symbol">PG_DIAG_COLUMN_NAME</code></span></dt><dd><p>
<span class="original">
            If the error was associated with a specific table column, the name
            of the column.  (Refer to the schema and table name fields to
            identify the table.)
</span>
そのエラーが特定のテーブル列に付随する場合の列名です。
（テーブルを識別するにはスキーマとテーブル名フィールドを参照ください。）
           </p></dd><dt id="LIBPQ-PG-DIAG-DATATYPE-NAME"><span class="term"><code class="symbol">PG_DIAG_DATATYPE_NAME</code></span></dt><dd><p>
<span class="original">
            If the error was associated with a specific data type, the name of
            the data type.  (Refer to the schema name field for the name of
            the data type's schema.)
</span>
そのエラーが特定のデータ型に付随する場合のデータ型名です。
（データ型のスキーマ名についてはスキーマ名フィールドを参照ください。）
           </p></dd><dt id="LIBPQ-PG-DIAG-CONSTRAINT-NAME"><span class="term"><code class="symbol">PG_DIAG_CONSTRAINT_NAME</code></span></dt><dd><p>
<span class="original">
            If the error was associated with a specific constraint, the name
            of the constraint.  Refer to fields listed above for the
            associated table or domain.  (For this purpose, indexes are
            treated as constraints, even if they weren't created with
            constraint syntax.)
</span>
そのエラーが特定の制約に付随する場合の制約名です。
付随するテーブルまたはドメインについては上記にリストされたフィールドを参照ください。
（この目的のために、制約は制約構文で作成されていなくてもインデックスは制約として扱われます。）
           </p></dd><dt id="LIBPQ-PG-DIAG-SOURCE-FILE"><span class="term"><code class="symbol">PG_DIAG_SOURCE_FILE</code></span></dt><dd><p>
<span class="original">
            The file name of the source-code location where the error was
            reported.
</span>
エラーが報告された場所のソースコードのファイル名です。
           </p></dd><dt id="LIBPQ-PG-DIAG-SOURCE-LINE"><span class="term"><code class="symbol">PG_DIAG_SOURCE_LINE</code></span></dt><dd><p>
<span class="original">
            The line number of the source-code location where the error
            was reported.
</span>
エラーが報告された場所のソースコードにおける行番号です。
           </p></dd><dt id="LIBPQ-PG-DIAG-SOURCE-FUNCTION"><span class="term"><code class="symbol">PG_DIAG_SOURCE_FUNCTION</code></span></dt><dd><p>
<span class="original">
            The name of the source-code function reporting the error.
</span>
エラーを報告した、ソースコードにおける関数名です。
           </p></dd></dl></div><p>
       </p><div class="note"><h3 class="title">注記</h3><p>
<span class="original">
         The fields for schema name, table name, column name, data type name,
         and constraint name are supplied only for a limited number of error
         types; see &lt;xref linkend="errcodes-appendix"/&gt;.  Do not assume that
         the presence of any of these fields guarantees the presence of
         another field.  Core error sources observe the interrelationships
         noted above, but user-defined functions may use these fields in other
         ways.  In the same vein, do not assume that these fields denote
         contemporary objects in the current database.
</span>
スキーマ名、テーブル名、列名、データ型名、および制約名に対するフィールドは限定的なエラー型に対してのみ提供されます。<a class="xref" href="errcodes-appendix.html" title="付録A PostgreSQLエラーコード">付録A</a>を参照ください。
これらのフィールドのいかなる存在もその他のフィールドの存在を保証すると推測してはなりません。
コアエラーの出所は上に記載の相互関係を監視しますが、ユーザ定義関数はこれらフィールドを別目的で使用しているかもしれません。
同様の脈絡で、使用しているデータベースで
これらのフィールドが同時に存在するオブジェクトを意味すると推測してはなりません。
        </p></div><p>
<span class="original">
        The client is responsible for formatting displayed information to meet
        its needs; in particular it should break long lines as needed.
        Newline characters appearing in the error message fields should be
        treated as paragraph breaks, not line breaks.
</span>
表示情報の必要に応じた整形はクライアントの責任です。
具体的には、必要に応じて長い行を分割しなければなりません。
エラーメッセージフィールド内の改行文字は、改行としてではなく段落として分かれたものとして取扱うべきです。
       </p><p>
<span class="original">
        Errors generated internally by &lt;application&gt;libpq&lt;/application&gt; will
        have severity and primary message, but typically no other fields.
        Errors returned by a pre-3.0-protocol server will include severity and
        primary message, and sometimes a detail message, but no other fields.
</span>
<span class="application">libpq</span>で内部的に生成されたエラーは、深刻度と主要メッセージを持ちますが、通常は他のフィールドを持ちません。
3.0より前のプロトコルのサーバで返されるエラーは、深刻度と主要メッセージ、場合によって詳細メッセージを持ちますが、他のフィールドを持ちません。
       </p><p>
<span class="original">
        Note that error fields are only available from
        &lt;structname&gt;PGresult&lt;/structname&gt; objects, not
        &lt;structname&gt;PGconn&lt;/structname&gt; objects; there is no
        &lt;function&gt;PQerrorField&lt;/function&gt; function.
</span>
エラーフィールドは<code class="structname">PGresult</code>からのみ利用でき、<code class="structname">PGconn</code>からは利用できません。
<code class="function">PQerrorField</code>という関数はありません。
       </p></dd><dt id="LIBPQ-PQCLEAR"><span class="term"><code class="function">PQclear</code><a id="id-1.7.3.10.3.9.7.6.1.2" class="indexterm"></a></span></dt><dd><p>
<span class="original">
        Frees  the  storage  associated with a
        &lt;structname&gt;PGresult&lt;/structname&gt;.  Every command result should be
        freed via &lt;function&gt;PQclear&lt;/function&gt; when it  is  no  longer
        needed.
</span>
<code class="structname">PGresult</code>に割り当てられた記憶領域を解放します。
個々の問い合わせ結果は、必要なくなった時に<code class="function">PQclear</code>で解放するべきです。

</p><pre class="synopsis">
void PQclear(PGresult *res);
</pre><p>
       </p><p>
<span class="original">
        You can keep a &lt;structname&gt;PGresult&lt;/structname&gt; object around for
        as long as you need it; it does not go away when you issue a new
        command, nor even if you close the connection.  To get rid of it,
        you must call &lt;function&gt;PQclear&lt;/function&gt;.  Failure to do this
        will result in memory leaks in your application.
</span>
<code class="structname">PGresult</code>オブジェクトは必要な間保持することができます。
新しい問い合わせを発行する場合でも、接続を閉じてしまうまでは<code class="structname">PGresult</code>は消えません。
<code class="structname">PGresult</code>を解放するには、<code class="function">PQclear</code>を呼び出さなくてはいけません。
その操作に失敗してしまうと、アプリケーションのメモリリークを引き起こしてしまいます。
       </p></dd></dl></div><p>
   </p></div><div class="sect2" id="LIBPQ-EXEC-SELECT-INFO"><div class="titlepage"><div><div><h3 class="title">34.3.2. 問い合わせ結果の情報の取り出し</h3></div></div></div><span class="original">
   &lt;title&gt;Retrieving Query Result Information&lt;/title&gt;
</span><p>
<span class="original">
    These functions are used to extract information from a
    &lt;structname&gt;PGresult&lt;/structname&gt; object that represents a successful
    query result (that is, one that has status
    &lt;literal&gt;PGRES_TUPLES_OK&lt;/literal&gt; or &lt;literal&gt;PGRES_SINGLE_TUPLE&lt;/literal&gt;).
    They can also be used to extract
    information from a successful Describe operation: a Describe's result
    has all the same column information that actual execution of the query
    would provide, but it has zero rows.  For objects with other status values,
    these functions will act as though the result has zero rows and zero columns.
</span>
これらの関数を使用して、正常終了した問い合わせ結果を示す(つまり、その状態が<code class="literal">PGRES_TUPLES_OK</code>または<code class="literal">PGRES_SINGLE_TUPLE</code>となっている)<code class="structname">PGresult</code>オブジェクトから情報を抽出することができます。
また、成功したDescribe操作から情報を抽出することもできます。
Describeの結果はすべて、実際に問い合わせを実行した時に提供されるものと同じ列情報を持ちますが、行はありません。
他の状態値を持つオブジェクトでは、これらの関数は、結果が0行0列であるものと同様に動作します。
   </p><div class="variablelist"><dl class="variablelist"><dt id="LIBPQ-PQNTUPLES"><span class="term">
      <code class="function">PQntuples</code>
      <a id="id-1.7.3.10.4.3.1.1.2" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       Returns the number of rows (tuples) in the query result.
       (Note that &lt;structname&gt;PGresult&lt;/structname&gt; objects are limited to no more
       than &lt;literal&gt;INT_MAX&lt;/literal&gt; rows, so an &lt;type&gt;int&lt;/type&gt; result is
       sufficient.)
</span>
問い合わせ結果内の行(タプル)数を返します。
これは整数を結果として返しますので、32ビットオペレーティングシステムでは、大規模な結果セットの戻り値はオーバーフローする可能性があります。

</p><pre class="synopsis">
int PQntuples(const PGresult *res);
</pre><p>

      </p></dd><dt id="LIBPQ-PQNFIELDS"><span class="term">
      <code class="function">PQnfields</code>
      <a id="id-1.7.3.10.4.3.2.1.2" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       Returns the number of columns (fields) in each row of the query
       result.
</span>
問い合わせ結果の各行の列(フィールド)の数を返します。

</p><pre class="synopsis">
int PQnfields(const PGresult *res);
</pre><p>
      </p></dd><dt id="LIBPQ-PQFNAME"><span class="term">
      <code class="function">PQfname</code>
      <a id="id-1.7.3.10.4.3.3.1.2" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       Returns the column name associated with the given column number.
       Column numbers start at 0. The caller should not free the result
       directly. It will be freed when the associated
       &lt;structname&gt;PGresult&lt;/structname&gt; handle is passed to
       &lt;function&gt;PQclear&lt;/function&gt;.
</span>
指定した列番号に対応する列の名前を返します。
列番号は0から始まります。
呼び出し元はこの結果を直接解放してはいけません。
関連する<code class="structname">PGresult</code>ハンドルが<code class="function">PQclear</code>に渡された時にこれは解放されます。
</p><pre class="synopsis">
char *PQfname(const PGresult *res,
              int column_number);
</pre><p>
      </p><p>
<span class="original">
       &lt;symbol&gt;NULL&lt;/symbol&gt; is returned if the column number is out of range.
</span>
列番号が範囲外であった場合、<code class="symbol">NULL</code>が返ります。
      </p></dd><dt id="LIBPQ-PQFNUMBER"><span class="term">
      <code class="function">PQfnumber</code>
      <a id="id-1.7.3.10.4.3.4.1.2" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       Returns the column number associated with the given column name.
</span>
指定した列名に関連する列番号を返します。
</p><pre class="synopsis">
int PQfnumber(const PGresult *res,
              const char *column_name);
</pre><p>
      </p><p>
<span class="original">
       -1 is returned if the given name does not match any column.
</span>
指定した名前に一致する列がなければ、-1が返ります。
      </p><p>
<span class="original">
       The given name is treated like an identifier in an SQL command,
       that is, it is downcased unless double-quoted.  For example, given
       a query result generated from the SQL command:
</span>
指定した名前はSQLコマンドの識別子同様に扱われます。
つまり、二重引用符でくくられていない限り、小文字化されます。
例えば、以下のSQLで生成された問い合わせ結果を考えます。
</p><pre class="programlisting">
SELECT 1 AS FOO, 2 AS "BAR";
</pre><p>
<span class="original">
       we would have the results:
</span>
以下により、結果を取り出すことができます。
</p><pre class="programlisting">
PQfname(res, 0)              <em class="lineannotation"><span class="lineannotation">foo</span></em>
PQfname(res, 1)              <em class="lineannotation"><span class="lineannotation">BAR</span></em>
PQfnumber(res, "FOO")        <em class="lineannotation"><span class="lineannotation">0</span></em>
PQfnumber(res, "foo")        <em class="lineannotation"><span class="lineannotation">0</span></em>
PQfnumber(res, "BAR")        <em class="lineannotation"><span class="lineannotation">-1</span></em>
PQfnumber(res, "\"BAR\"")    <em class="lineannotation"><span class="lineannotation">1</span></em>
</pre><p>
      </p></dd><dt id="LIBPQ-PQFTABLE"><span class="term">
      <code class="function">PQftable</code>
      <a id="id-1.7.3.10.4.3.5.1.2" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       Returns the OID of the table from which the given column was
       fetched.  Column numbers start at 0.
</span>
指定した列の抽出元であるテーブルのOIDを返します。
列番号は0から始まります。
</p><pre class="synopsis">
Oid PQftable(const PGresult *res,
             int column_number);
</pre><p>
      </p><p>
<span class="original">
       &lt;literal&gt;InvalidOid&lt;/literal&gt; is returned if the column number is out of range,
       or if the specified column is not a simple reference to a table column,
       or when using pre-3.0 protocol.
       You can query the system table &lt;literal&gt;pg_class&lt;/literal&gt; to determine
       exactly which table is referenced.
</span>
列番号が範囲外の場合や指定した列がテーブル列への単純な参照でない場合、3.0より前のプロトコルを使用している場合は、<code class="literal">InvalidOid</code>が返されます。
<code class="literal">pg_class</code>システムテーブルに問い合わせ、どのテーブルが参照されているのかを正確に求めることができます。
      </p><p>
<span class="original">
       The type &lt;type&gt;Oid&lt;/type&gt; and the constant
       &lt;literal&gt;InvalidOid&lt;/literal&gt; will be defined when you include
       the &lt;application&gt;libpq&lt;/application&gt; header file. They will both
       be some integer type.
</span>
<span class="application">libpq</span>ヘッダファイルをインクルードすると、<code class="type">Oid</code>型と<code class="literal">InvalidOid</code>定数が定義されます。
これらは両方とも何らかの整数型です。
      </p></dd><dt id="LIBPQ-PQFTABLECOL"><span class="term">
      <code class="function">PQftablecol</code>
      <a id="id-1.7.3.10.4.3.6.1.2" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       Returns the column number (within its table) of the column making
       up the specified query result column.  Query-result column numbers
       start at 0, but table columns have nonzero numbers.
</span>
指定した問い合わせ結果の列を作成した列の(それが属するテーブル内での)列番号を返します。
問い合わせ結果の列番号は0から始まりますが、テーブル列には0以外の番号が付けられています。
</p><pre class="synopsis">
int PQftablecol(const PGresult *res,
                int column_number);
</pre><p>
      </p><p>
<span class="original">
       Zero is returned if the column number is out of range, or if the
       specified column is not a simple reference to a table column, or
       when using pre-3.0 protocol.
</span>
列番号が範囲外の場合や指定した列がテーブル列への単純な参照でなかった場合、3.0より前のプロトコルを使用している場合は、ゼロが返されます。
      </p></dd><dt id="LIBPQ-PQFFORMAT"><span class="term">
      <code class="function">PQfformat</code>
      <a id="id-1.7.3.10.4.3.7.1.2" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       Returns the format code indicating the format of the given
       column.  Column numbers start at 0.
</span>
指定した列の書式を示す書式コードを返します。
列番号は0から始まります。
</p><pre class="synopsis">
int PQfformat(const PGresult *res,
              int column_number);
</pre><p>
      </p><p>
<span class="original">
       Format code zero indicates textual data representation, while format
       code one indicates binary representation.  (Other codes are reserved
       for future definition.)
</span>
ゼロという書式コードはテキストデータ表現を示し、1という書式コードはバイナリ表現を示します。
(他のコードは将来の定義のために予約されています。)
      </p></dd><dt id="LIBPQ-PQFTYPE"><span class="term">
      <code class="function">PQftype</code>
      <a id="id-1.7.3.10.4.3.8.1.2" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       Returns the data type associated with the given  column number.
       The  integer  returned is the internal OID number of the type.
       Column numbers start at 0.
</span>
指定した列番号に関連したデータ型を返します。
返された整数はその型の内部的なOID番号です。
列番号は0から始まります。
</p><pre class="synopsis">
Oid PQftype(const PGresult *res,
            int column_number);
</pre><p>
      </p><p>
<span class="original">
       You can query the system table &lt;literal&gt;pg_type&lt;/literal&gt; to
       obtain the names and properties of the various data types. The
       &lt;acronym&gt;OID&lt;/acronym&gt;s of the built-in data types are defined
       in the file &lt;filename&gt;src/include/catalog/pg_type_d.h&lt;/filename&gt;
       in the source tree.
</span>
<code class="literal">pg_type</code>システムテーブルに問い合わせて、各種データ型の名前や属性を得ることができます。
組み込みデータ型の<acronym class="acronym">OID</acronym>は、ソースツリー内の<code class="filename">src/include/catalog/pg_type_d.h</code>ファイル内で定義されています。
      </p></dd><dt id="LIBPQ-PQFMOD"><span class="term">
      <code class="function">PQfmod</code>
      <a id="id-1.7.3.10.4.3.9.1.2" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       Returns  the type modifier of the column associated with the
       given column number.  Column numbers start at 0.
</span>
指定した列番号に関連した列の型修飾子を返します。
列番号は0から始まります。
</p><pre class="synopsis">
int PQfmod(const PGresult *res,
           int column_number);
</pre><p>
      </p><p>
<span class="original">
       The interpretation of modifier values is type-specific; they
       typically indicate precision or size limits.  The value -1 is
       used to indicate &lt;quote&gt;no information available&lt;/quote&gt;.  Most data
       types do not use modifiers, in which case the value is always
       -1.
</span>
修飾子の値の解釈は型に固有なものです。
通常これらは精度やサイズの制限を示します。
-1という値は<span class="quote">「<span class="quote">使用できる情報がない</span>」</span>ことを示します。
ほとんどのデータ型は修飾子を使用しません。
この場合は常に-1という値になります。
      </p></dd><dt id="LIBPQ-PQFSIZE"><span class="term">
      <code class="function">PQfsize</code>
      <a id="id-1.7.3.10.4.3.10.1.2" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       Returns  the  size  in bytes of the column associated with the
       given column number.  Column numbers start at 0.
</span>
指定した列番号に関連した列のバイト単位のサイズを返します。
列番号は0から始まります。
</p><pre class="synopsis">
int PQfsize(const PGresult *res,
            int column_number);
</pre><p>
      </p><p>
<span class="original">
       &lt;function&gt;PQfsize&lt;/function&gt; returns the space allocated for this column
       in a database row, in other words the size of the server's
       internal representation of the data type.  (Accordingly, it is
       not really very useful to clients.) A negative value indicates
       the data type is variable-length.
</span>
<code class="function">PQfsize</code>はデータベース行内でその列用に割り当てられる領域を返します。
言い替えると、そのデータ型についてのサーバでの内部表現のサイズです。
(従って、実際にはクライアントから見るとあまり役には立ちません。)
負の値は可変長データ型を示します。
      </p></dd><dt id="LIBPQ-PQBINARYTUPLES"><span class="term">
      <code class="function">PQbinaryTuples</code>
      <a id="id-1.7.3.10.4.3.11.1.2" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       Returns 1 if the &lt;structname&gt;PGresult&lt;/structname&gt; contains binary data
       and 0 if it contains text data.
</span>
<code class="structname">PGresult</code>がバイナリデータを持つ場合は1を、テキストデータを持つ場合は0を返します。
</p><pre class="synopsis">
int PQbinaryTuples(const PGresult *res);
</pre><p>
      </p><p>
<span class="original">
       This function is deprecated (except for its use in connection with
       &lt;command&gt;COPY&lt;/command&gt;), because it is possible for a single
       &lt;structname&gt;PGresult&lt;/structname&gt; to contain text data in some columns and
       binary data in others.  &lt;function&gt;PQfformat&lt;/function&gt; is preferred.
       &lt;function&gt;PQbinaryTuples&lt;/function&gt; returns 1 only if all columns of the
       result are binary (format 1).
</span>
この関数は廃れたものです。
(<code class="command">COPY</code>を行う接続での使用を除きます。)
単一の<code class="structname">PGresult</code>で、ある列はテキストデータを持ち、他の列ではバイナリデータを持つことが可能であるためです。
<code class="function">PQfformat</code>の利用が推奨されます。
結果のすべての列がバイナリ(書式1)の場合のみ<code class="function">PQbinaryTuples</code>は1を返します。
      </p></dd><dt id="LIBPQ-PQGETVALUE"><span class="term">
      <code class="function">PQgetvalue</code>
       <a id="id-1.7.3.10.4.3.12.1.2" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       Returns a single field value of one row of a
       &lt;structname&gt;PGresult&lt;/structname&gt;.  Row and column numbers start
       at 0.  The caller should not free the result directly.  It will
       be freed when the associated &lt;structname&gt;PGresult&lt;/structname&gt; handle is
       passed to &lt;function&gt;PQclear&lt;/function&gt;.
</span>
<code class="structname">PGresult</code>の1行における単一フィールドの値を返します。
行番号と列番号は0から始まります。
呼び出し元はこの結果を直接解放してはいけません。
関連する<code class="structname">PGresult</code>ハンドルが<code class="function">PQclear</code>に渡された時に、これは解放されます。
</p><pre class="synopsis">
char *PQgetvalue(const PGresult *res,
                 int row_number,
                 int column_number);
</pre><p>
      </p><p>
<span class="original">
       For data in text format, the value returned by
       &lt;function&gt;PQgetvalue&lt;/function&gt; is a null-terminated character
       string  representation of the field value.  For data in binary
       format, the value is in the binary representation determined by
       the data type's &lt;function&gt;typsend&lt;/function&gt; and &lt;function&gt;typreceive&lt;/function&gt;
       functions.  (The value is actually followed by a zero byte in
       this case too, but that is not ordinarily useful, since the
       value is likely to contain embedded nulls.)
</span>
テキスト書式のデータでは、<code class="function">PQgetvalue</code>で返される値はフィールド値のヌル終端の文字列表現となります。
バイナリ書式のデータでは、この値はデータ型の<code class="function">typsend</code>関数と<code class="function">typreceive</code>関数で決まるバイナリ表現となります。
(実際にはこの場合でも値の終わりにゼロというバイトが付与されます。
しかし、この値の内部には大抵の場合ヌルが埋め込まれていますので、通常このバイトは有用ではありません。)
      </p><p>
<span class="original">
       An empty string is returned if the field value is null.  See
       &lt;function&gt;PQgetisnull&lt;/function&gt; to distinguish null values from
       empty-string values.
</span>
フィールド値がNULLの場合、空文字列が返されます。
NULL値と空文字列という値とを区別する方法は<code class="function">PQgetisnull</code>を参照してください。
      </p><p>
<span class="original">
       The pointer returned  by  &lt;function&gt;PQgetvalue&lt;/function&gt; points
       to storage that is part of the &lt;structname&gt;PGresult&lt;/structname&gt;
       structure.  One should not modify the data it points to, and one
       must explicitly copy the data into other storage if it is to be
       used past the lifetime of the  &lt;structname&gt;PGresult&lt;/structname&gt;
       structure itself.
</span>
<code class="function">PQgetvalue</code>によって返されるポインタは<code class="structname">PGresult</code>構造体の一部の格納領域を指し示します。
このポインタが指し示すデータを変更すべきではありません。
また、<code class="structname">PGresult</code>構造体を解放した後も使用し続ける場合は、データを別の格納領域に明示的にコピーしなければなりません。
      </p></dd><dt id="LIBPQ-PQGETISNULL"><span class="term">
      <code class="function">PQgetisnull</code>
      <a id="id-1.7.3.10.4.3.13.1.2" class="indexterm"></a>
      <a id="id-1.7.3.10.4.3.13.1.3" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       Tests a field for a null value.  Row and column numbers start
       at 0.
</span>
フィールドがNULL値かどうか検査します。
行番号と列番号は0から始まります。
</p><pre class="synopsis">
int PQgetisnull(const PGresult *res,
                int row_number,
                int column_number);
</pre><p>
      </p><p>
<span class="original">
       This function returns  1 if the field is null and 0 if it
       contains a non-null value.  (Note that
       &lt;function&gt;PQgetvalue&lt;/function&gt; will return an empty string,
       not a null pointer, for a null field.)
</span>
この関数は、フィールドがNULLの場合に1を、フィールドが非NULL値を持つ場合は0を返します。
(<code class="function">PQgetvalue</code>では、NULLフィールドはヌルポインタではなく空文字列を返すことに注意してください。)
      </p></dd><dt id="LIBPQ-PQGETLENGTH"><span class="term">
     <code class="function">PQgetlength</code>
     <a id="id-1.7.3.10.4.3.14.1.2" class="indexterm"></a></span></dt><dd><p>
<span class="original">
       Returns the actual length of a field value in bytes.  Row and
       column numbers start at 0.
</span>
実際のフィールド値の長さをバイト単位で返します。
行番号と列番号は0から始まります。
</p><pre class="synopsis">
int PQgetlength(const PGresult *res,
                int row_number,
                int column_number);
</pre><p>
      </p><p>
<span class="original">
       This is the actual data length for the particular data value,
       that is, the size of the object pointed to by
       &lt;function&gt;PQgetvalue&lt;/function&gt;.  For text data format this is
       the same as &lt;function&gt;strlen()&lt;/function&gt;.  For binary format this is
       essential information.  Note that one should &lt;emphasis&gt;not&lt;/emphasis&gt;
       rely on &lt;function&gt;PQfsize&lt;/function&gt; to obtain the actual data
       length.
</span>
これは特定のデータ値についての実際のデータ長です。
つまり、<code class="function">PQgetvalue</code>によって指し示されるオブジェクトのサイズです。
テキストデータ書式では<code class="function">strlen()</code>と同一です。
バイナリ書式ではこれは重要な情報です。
実際のデータ長を取り出すために<code class="function">PQfsize</code>を信用しては<span class="emphasis"><em>なりません</em></span>。
      </p></dd><dt id="LIBPQ-PQNPARAMS"><span class="term">
      <code class="function">PQnparams</code>
      <a id="id-1.7.3.10.4.3.15.1.2" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       Returns the number of parameters of a prepared statement.
</span>
プリペアド文のパラメータ数を返します。
</p><pre class="synopsis">
int PQnparams(const PGresult *res);
</pre><p>
      </p><p>
<span class="original">
       This function is only useful when inspecting the result of
       &lt;function&gt;PQdescribePrepared&lt;/function&gt;.  For other types of queries it
       will return zero.
</span>
この関数は<code class="function">PQdescribePrepared</code>の結果を確認する時にのみ有用です。
他の種類の問い合わせではゼロを返します。
      </p></dd><dt id="LIBPQ-PQPARAMTYPE"><span class="term">
      <code class="function">PQparamtype</code>
      <a id="id-1.7.3.10.4.3.16.1.2" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       Returns the data type of the indicated statement parameter.
       Parameter numbers start at 0.
</span>
指定された文パラメータのデータ型を返します。
パラメータ番号は0から始まります。
</p><pre class="synopsis">
Oid PQparamtype(const PGresult *res, int param_number);
</pre><p>
      </p><p>
<span class="original">
       This function is only useful when inspecting the result of
       &lt;function&gt;PQdescribePrepared&lt;/function&gt;.  For other types of queries it
       will return zero.
</span>
この関数は、<code class="function">PQdescribePrepared</code>の結果を確認する時にのみ有用です。
他の種類の問い合わせではゼロを返します。
      </p></dd><dt id="LIBPQ-PQPRINT"><span class="term">
      <code class="function">PQprint</code>
      <a id="id-1.7.3.10.4.3.17.1.2" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       Prints out all the rows and,  optionally,  the column names  to
       the specified output stream.
</span>
すべての行と列名(省略可能)を指定した出力ストリームに表示します。
</p><pre class="synopsis">
<span class="original">
void PQprint(FILE *fout,      /* output stream */
             const PGresult *res,
             const PQprintOpt *po);
typedef struct
{
    pqbool  header;      /* print output field headings and row count */
    pqbool  align;       /* fill align the fields */
    pqbool  standard;    /* old brain dead format */
    pqbool  html3;       /* output HTML tables */
    pqbool  expanded;    /* expand tables */
    pqbool  pager;       /* use pager for output if needed */
    char    *fieldSep;   /* field separator */
    char    *tableOpt;   /* attributes for HTML table element */
    char    *caption;    /* HTML table caption */
    char    **fieldName; /* null-terminated array of replacement field names */
} PQprintOpt;
</span>
void PQprint(FILE *fout,      /* 出力ストリーム */
             const PGresult *res,
             const PQprintOpt *po);

typedef struct
{
    pqbool  header;      /* フィールドヘッダ情報と行数の表示出力 */
    pqbool  align;       /* 位置揃えのためのフィールドへの埋め込み */
    pqbool  standard;    /* 古い、無くなりそうな書式 */
    pqbool  html3;       /* HTML表出力 */
    pqbool  expanded;    /* 拡張テーブル */
    pqbool  pager;       /* 必要に応じたページャの使用 */
    char    *fieldSep;   /* フィールド区切り文字 */
    char    *tableOpt;   /* HTML表要素の属性 */
    char    *caption;    /* HTML 表の表題 */
    char    **fieldName; /* フィールド名を置き換えるNULL終端の配列 */
} PQprintOpt;
</pre><p>
      </p><p>
<span class="original">
       This function was formerly used by &lt;application&gt;psql&lt;/application&gt;
       to print query results, but this is no longer the case.  Note
       that it assumes all the data is in text format.
</span>
この関数は以前に問い合わせ結果を表示するために<span class="application">psql</span>で使用されていましたが、今ではもう使用されていません。
これはすべてのデータがテキスト書式であるという前提で動作することに注意してください。
      </p></dd></dl></div></div><div class="sect2" id="LIBPQ-EXEC-NONSELECT"><div class="titlepage"><div><div><h3 class="title">34.3.3. 他の結果情報の取り出し</h3></div></div></div><span class="original">
   &lt;title&gt;Retrieving Other Result Information&lt;/title&gt;
</span><p>
<span class="original">
    These functions are used to extract other information from
    &lt;structname&gt;PGresult&lt;/structname&gt; objects.
</span>
これらの関数は<code class="structname">PGresult</code>オブジェクトからその他の情報を取り出すために使用されます。
   </p><div class="variablelist"><dl class="variablelist"><dt id="LIBPQ-PQCMDSTATUS"><span class="term">
      <code class="function">PQcmdStatus</code>
      <a id="id-1.7.3.10.5.3.1.1.2" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       Returns the command status tag from the SQL command that generated
       the &lt;structname&gt;PGresult&lt;/structname&gt;.
</span>
<code class="structname">PGresult</code>を生成したSQLコマンドのコマンド状態タグを返します。
</p><pre class="synopsis">
char *PQcmdStatus(PGresult *res);
</pre><p>
      </p><p>
<span class="original">
       Commonly this is just the name of the command, but it might include
       additional data such as the number of rows processed. The caller
       should not free the result directly. It will be freed when the
       associated &lt;structname&gt;PGresult&lt;/structname&gt; handle is passed to
       &lt;function&gt;PQclear&lt;/function&gt;.
</span>
これは通常単なるコマンド名ですが、処理行数など追加情報が含まれる場合もあります。
呼び出し元はこの戻り値を直接解放してはいけません。
関連する<code class="structname">PGresult</code>ハンドルが<code class="function">PQclear</code>に渡された時にこれは解放されます。
      </p></dd><dt id="LIBPQ-PQCMDTUPLES"><span class="term">
      <code class="function">PQcmdTuples</code>
      <a id="id-1.7.3.10.5.3.2.1.2" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       Returns the number of rows affected by the SQL command.
</span>
SQLコマンドにより影響を受けた行数を返します。
</p><pre class="synopsis">
char *PQcmdTuples(PGresult *res);
</pre><p>
      </p><p>
<span class="original">
       This function returns a string containing the number of rows
       affected by the &lt;acronym&gt;SQL&lt;/acronym&gt; statement that generated the
       &lt;structname&gt;PGresult&lt;/structname&gt;. This function can only be used following
       the execution of a &lt;command&gt;SELECT&lt;/command&gt;, &lt;command&gt;CREATE TABLE AS&lt;/command&gt;,
       &lt;command&gt;INSERT&lt;/command&gt;, &lt;command&gt;UPDATE&lt;/command&gt;, &lt;command&gt;DELETE&lt;/command&gt;,
       &lt;command&gt;MOVE&lt;/command&gt;, &lt;command&gt;FETCH&lt;/command&gt;, or &lt;command&gt;COPY&lt;/command&gt; statement,
       or an &lt;command&gt;EXECUTE&lt;/command&gt; of a prepared query that contains an
       &lt;command&gt;INSERT&lt;/command&gt;, &lt;command&gt;UPDATE&lt;/command&gt;, or &lt;command&gt;DELETE&lt;/command&gt; statement.
       If the command that generated the &lt;structname&gt;PGresult&lt;/structname&gt; was anything
       else, &lt;function&gt;PQcmdTuples&lt;/function&gt; returns an empty string. The caller
       should not free the return value directly. It will be freed when
       the associated &lt;structname&gt;PGresult&lt;/structname&gt; handle is passed to
       &lt;function&gt;PQclear&lt;/function&gt;.
</span>
この関数は<code class="structname">PGresult</code>を生成した<acronym class="acronym">SQL</acronym>コマンドにより影響を受けた行数を含む文字列を返します。
この関数は<code class="command">SELECT</code>、<code class="command">CREATE TABLE AS</code>、<code class="command">INSERT</code>、<code class="command">UPDATE</code>、<code class="command">DELETE</code>、<code class="command">MOVE</code>、<code class="command">FETCH</code>、<code class="command">COPY</code>文の実行、あるいは、<code class="command">INSERT</code>、<code class="command">UPDATE</code>、<code class="command">DELETE</code>を含むプリペアド問い合わせの<code class="command">EXECUTE</code>文の後でのみ使用することができます。
<code class="structname">PGresult</code>を生成したコマンドが他のコマンドであった場合、<code class="function">PQcmdTuples</code>は空文字列を返します。
呼び出し元はこの戻り値を直接解放してはいけません。
関連する<code class="structname">PGresult</code>ハンドルが<code class="function">PQclear</code>に渡された時にこれは解放されます。
      </p></dd><dt id="LIBPQ-PQOIDVALUE"><span class="term">
      <code class="function">PQoidValue</code>
      <a id="id-1.7.3.10.5.3.3.1.2" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       Returns the OID&lt;indexterm&gt;&lt;primary&gt;OID&lt;/primary&gt;&lt;secondary&gt;in libpq&lt;/secondary&gt;&lt;/indexterm&gt;
       of the inserted row, if the &lt;acronym&gt;SQL&lt;/acronym&gt; command was an
       &lt;command&gt;INSERT&lt;/command&gt; that inserted exactly one row into a table that
       has OIDs, or a &lt;command&gt;EXECUTE&lt;/command&gt; of a prepared query containing
       a suitable &lt;command&gt;INSERT&lt;/command&gt; statement.  Otherwise, this function
       returns &lt;literal&gt;InvalidOid&lt;/literal&gt;. This function will also
       return &lt;literal&gt;InvalidOid&lt;/literal&gt; if the table affected by the
       &lt;command&gt;INSERT&lt;/command&gt; statement does not contain OIDs.
</span>
<acronym class="acronym">SQL</acronym>コマンドが、OIDを持つテーブル内に1行のみを挿入する<code class="command">INSERT</code>だった場合、あるいは、適切な<code class="command">INSERT</code>を持つプリペアド問い合わせの<code class="command">EXECUTE</code>だった場合に、挿入された行のOIDを返します。
さもなくば<code class="literal">InvalidOid</code>を返します。
また、<code class="command">INSERT</code>文の影響を受けたテーブルがOIDを持たなかった場合、この関数は<code class="literal">InvalidOid</code>を返します。
</p><pre class="synopsis">
Oid PQoidValue(const PGresult *res);
</pre><p>
      </p></dd><dt id="LIBPQ-PQOIDSTATUS"><span class="term">
      <code class="function">PQoidStatus</code>
      <a id="id-1.7.3.10.5.3.4.1.2" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       This function is deprecated in favor of
       &lt;function&gt;PQoidValue&lt;/function&gt; and is not thread-safe.
       It returns a string with the OID of the inserted row, while
       &lt;function&gt;PQoidValue&lt;/function&gt; returns the OID value.
</span>
この関数は<code class="function">PQoidValue</code>のため廃止予定になりました。
またこれはスレッドセーフではありません。
これは挿入された行のOIDを文字列として返します。
一方<code class="function">PQoidValue</code>はOID値を返します。
</p><pre class="synopsis">
char *PQoidStatus(const PGresult *res);
</pre><p>
      </p></dd></dl></div></div><div class="sect2" id="LIBPQ-EXEC-ESCAPE-STRING"><div class="titlepage"><div><div><h3 class="title">34.3.4. SQLコマンドに含めるための文字列のエスケープ処理</h3></div></div></div><span class="original">
   &lt;title&gt;Escaping Strings for Inclusion in SQL Commands&lt;/title&gt;
</span><a id="id-1.7.3.10.6.2" class="indexterm"></a><div class="variablelist"><dl class="variablelist"><dt id="LIBPQ-PQESCAPELITERAL"><span class="term">
      <code class="function">PQescapeLiteral</code>
      <a id="id-1.7.3.10.6.3.1.1.2" class="indexterm"></a>
     </span></dt><dd><p>
</p><pre class="synopsis">
char *PQescapeLiteral(PGconn *conn, const char *str, size_t length);
</pre><p>
     </p><p>
<span class="original">
      &lt;function&gt;PQescapeLiteral&lt;/function&gt; escapes a string for
      use within an SQL command.  This is useful when inserting data
      values as literal constants in SQL commands.  Certain characters
      (such as quotes and backslashes) must be escaped to prevent them
      from being interpreted specially by the SQL parser.
      &lt;function&gt;PQescapeLiteral&lt;/function&gt; performs this operation.
</span>
<code class="function">PQescapeLiteral</code>は、SQLコマンド内で使用するために文字列をエスケープします。
これは、SQLコマンド内のリテラル定数としてデータ値を挿入する時に有用です。
特定の文字(引用符やバックスラッシュ)は、SQLパーサによって特殊な解釈がなされないようにエスケープされなければなりません。
<code class="function">PQescapeLiteral</code>はこの操作を行います。
     </p><p>
<span class="original">
      &lt;function&gt;PQescapeLiteral&lt;/function&gt; returns an escaped version of the
      &lt;parameter&gt;str&lt;/parameter&gt; parameter in memory allocated with
      &lt;function&gt;malloc()&lt;/function&gt;.  This memory should be freed using
      &lt;function&gt;PQfreemem()&lt;/function&gt; when the result is no longer needed.
      A terminating zero byte is not required, and should not be
      counted in &lt;parameter&gt;length&lt;/parameter&gt;.  (If a terminating zero byte is found
      before &lt;parameter&gt;length&lt;/parameter&gt; bytes are processed,
      &lt;function&gt;PQescapeLiteral&lt;/function&gt; stops at the zero; the behavior is
      thus rather like &lt;function&gt;strncpy&lt;/function&gt;.) The
      return string has all special characters replaced so that they can
      be properly processed by the &lt;productname&gt;PostgreSQL&lt;/productname&gt;
      string literal parser.  A terminating zero byte is also added.  The
      single quotes that must surround &lt;productname&gt;PostgreSQL&lt;/productname&gt;
      string literals are included in the result string.
</span>
<code class="function">PQescapeLiteral</code>は<em class="parameter"><code>str</code></em>パラメータをエスケープしたものを<code class="function">malloc()</code>で割り当てたメモリ内に返します。
その結果が不要になったら、そのメモリを<code class="function">PQfreemem()</code>を使用して解放しなければなりません。
ゼロバイト終端は必要なく、<em class="parameter"><code>length</code></em>に含めて数えてはいけません。
(<em class="parameter"><code>length</code></em>バイトを処理する前にゼロバイト終端が見つかると、<code class="function">PQescapeLiteral</code>はそのゼロで終了します。
この動作は<code class="function">strncpy</code>と似ています。)
返される文字列では、<span class="productname">PostgreSQL</span>文字列リテラルパーサで適切に処理することができるように、すべての特殊文字は置換されます。
ゼロバイト終端も追加されます。
<span class="productname">PostgreSQL</span>の文字列リテラルでは前後に必要となる単一引用符も、その結果文字列には含まれています。
     </p><p>
<span class="original">
      On error, &lt;function&gt;PQescapeLiteral&lt;/function&gt; returns &lt;symbol&gt;NULL&lt;/symbol&gt; and a suitable
      message is stored in the &lt;parameter&gt;conn&lt;/parameter&gt; object.
</span>
エラー時、<code class="function">PQescapeLiteral</code>は<code class="symbol">NULL</code>を返し、<em class="parameter"><code>conn</code></em>オブジェクト内に適切なメッセージを残します。
     </p><div class="tip"><h3 class="title">ヒント</h3><p>
<span class="original">
       It is especially important to do proper escaping when handling
       strings that were received from an untrustworthy source.
       Otherwise there is a security risk: you are vulnerable to
       &lt;quote&gt;SQL injection&lt;/quote&gt; attacks wherein unwanted SQL commands are
       fed to your database.
</span>
信用できない入力元から受けとった文字列を扱う場合に適切なエスケープ処理を行なうことは非常に重要です。
さもなくば、セキュリティ上の危険性が発生します。
<span class="quote">「<span class="quote">SQLインジェクション</span>」</span>攻撃という弱点となり、好ましくないSQLコマンドがデータベースに流れてしまいます。
      </p></div><p>
<span class="original">
      Note that it is neither necessary nor correct to do escaping when a data
      value is passed as a separate parameter in &lt;function&gt;PQexecParams&lt;/function&gt; or
      its sibling routines.
</span>
<code class="function">PQexecParams</code>または同義のルーチン内で別のパラメータとしてデータ値が渡される場合は、エスケープすることは必要でもなければ正しくもないことに注意してください。
     </p></dd><dt id="LIBPQ-PQESCAPEIDENTIFIER"><span class="term">
      <code class="function">PQescapeIdentifier</code>
      <a id="id-1.7.3.10.6.3.2.1.2" class="indexterm"></a>
     </span></dt><dd><p>
</p><pre class="synopsis">
char *PQescapeIdentifier(PGconn *conn, const char *str, size_t length);
</pre><p>
     </p><p>
<span class="original">
      &lt;function&gt;PQescapeIdentifier&lt;/function&gt; escapes a string for
      use as an SQL identifier, such as a table, column, or function name.
      This is useful when a user-supplied identifier might contain
      special characters that would otherwise not be interpreted as part
      of the identifier by the SQL parser, or when the identifier might
      contain upper case characters whose case should be preserved.
</span>
<code class="function">PQescapeIdentifier</code>は、テーブル、列、関数名などのSQL識別子として使用できるように文字列をエスケープします。
これはユーザが提供した識別子に、そのままではSQLパーサで識別子として解釈されない特殊な文字が含まれる可能性がある場合、または、大文字小文字の違いを維持しなければならない状況で識別子に大文字が含まれる可能性がある場合に有用です。
     </p><p>
<span class="original">
      &lt;function&gt;PQescapeIdentifier&lt;/function&gt; returns a version of the
      &lt;parameter&gt;str&lt;/parameter&gt; parameter escaped as an SQL identifier
      in memory allocated with &lt;function&gt;malloc()&lt;/function&gt;.  This memory must be
      freed using &lt;function&gt;PQfreemem()&lt;/function&gt; when the result is no longer
      needed.  A terminating zero byte is not required, and should not be
      counted in &lt;parameter&gt;length&lt;/parameter&gt;.  (If a terminating zero byte is found
      before &lt;parameter&gt;length&lt;/parameter&gt; bytes are processed,
      &lt;function&gt;PQescapeIdentifier&lt;/function&gt; stops at the zero; the behavior is
      thus rather like &lt;function&gt;strncpy&lt;/function&gt;.) The
      return string has all special characters replaced so that it
      will be properly processed as an SQL identifier.  A terminating zero byte
      is also added.  The return string will also be surrounded by double
      quotes.
</span>
<code class="function">PQescapeIdentifier</code>は<em class="parameter"><code>str</code></em>パラメータをSQL識別子としてエスケープしたものを<code class="function">malloc()</code>で割り当てたメモリ内に返します。
その結果が不要になったら、そのメモリを<code class="function">PQfreemem()</code>を使用して解放しなければなりません。
ゼロバイト終端は必要なく、<em class="parameter"><code>length</code></em>に含めて数えてはいけません。
(<em class="parameter"><code>length</code></em>バイトを処理する前にゼロバイト終端が見つかると、<code class="function">PQescapeIdentifier</code>はそのゼロで終了します。
この動作は<code class="function">strncpy</code>と似ています。)
返される文字列では、SQL識別子として適切に処理することができるように、すべての特殊文字は置換されます。
ゼロバイト終端も追加されます。
その結果文字列の前後には二重引用符が付与されます。
     </p><p>
<span class="original">
      On error, &lt;function&gt;PQescapeIdentifier&lt;/function&gt; returns &lt;symbol&gt;NULL&lt;/symbol&gt; and a suitable
      message is stored in the &lt;parameter&gt;conn&lt;/parameter&gt; object.
</span>
エラー時、<code class="function">PQescapeIdentifier</code>は<code class="symbol">NULL</code>を返し、<em class="parameter"><code>conn</code></em>オブジェクト内に適切なメッセージを残します。
     </p><div class="tip"><h3 class="title">ヒント</h3><p>
<span class="original">
       As with string literals, to prevent SQL injection attacks,
       SQL identifiers must be escaped when they are received from an
       untrustworthy source.
</span>
文字列リテラルと同様、SQLインジェクション攻撃を防ぐために、信頼できない入力元から受けとる場合にはSQL識別子をエスケープしなければなりません。
      </p></div></dd><dt id="LIBPQ-PQESCAPESTRINGCONN"><span class="term">
      <code class="function">PQescapeStringConn</code>
      <a id="id-1.7.3.10.6.3.3.1.2" class="indexterm"></a>
     </span></dt><dd><p>
</p><pre class="synopsis">
size_t PQescapeStringConn(PGconn *conn,
                          char *to, const char *from, size_t length,
                          int *error);
</pre><p>
     </p><p>
<span class="original">
      &lt;function&gt;PQescapeStringConn&lt;/function&gt; escapes string literals, much like
      &lt;function&gt;PQescapeLiteral&lt;/function&gt;.  Unlike &lt;function&gt;PQescapeLiteral&lt;/function&gt;,
      the caller is responsible for providing an appropriately sized buffer.
      Furthermore, &lt;function&gt;PQescapeStringConn&lt;/function&gt; does not generate the
      single quotes that must surround &lt;productname&gt;PostgreSQL&lt;/productname&gt; string
      literals; they should be provided in the SQL command that the
      result is inserted into.  The parameter &lt;parameter&gt;from&lt;/parameter&gt; points to
      the first character of the string that is to be escaped, and the
      &lt;parameter&gt;length&lt;/parameter&gt; parameter gives the number of bytes in this
      string.  A terminating zero byte is not required, and should not be
      counted in &lt;parameter&gt;length&lt;/parameter&gt;.  (If a terminating zero byte is found
      before &lt;parameter&gt;length&lt;/parameter&gt; bytes are processed,
      &lt;function&gt;PQescapeStringConn&lt;/function&gt; stops at the zero; the behavior is
      thus rather like &lt;function&gt;strncpy&lt;/function&gt;.) &lt;parameter&gt;to&lt;/parameter&gt; shall point
      to a buffer that is able to hold at least one more byte than twice
      the value of &lt;parameter&gt;length&lt;/parameter&gt;, otherwise the behavior is undefined.
      Behavior is likewise undefined if the &lt;parameter&gt;to&lt;/parameter&gt; and
      &lt;parameter&gt;from&lt;/parameter&gt; strings overlap.
</span>
<code class="function">PQescapeStringConn</code>は、<code class="function">PQescapeLiteral</code>とほぼ同様に文字列リテラルをエスケープします。
<code class="function">PQescapeLiteral</code>とは異なり、呼び出し元が適切な大きさのバッファを提供することに責任を持ちます。
さらに<code class="function">PQescapeStringConn</code>は<span class="productname">PostgreSQL</span>の文字リテラルとして囲まれなければならない単一引用符を生成しません。
これは、結果をSQLコマンドに挿入するときに付与しなければなりません。
<em class="parameter"><code>from</code></em>パラメータはエスケープ対象の文字列の先頭を指すポインタです。
<em class="parameter"><code>length</code></em>パラメータはこの文字列のバイト数を示します。
ゼロバイト終端は必要なく、また、<em class="parameter"><code>lenth</code></em>ではこれを数えてはなりません。
(もし<em class="parameter"><code>length</code></em>バイト処理する前にゼロバイト終端が存在すると、<code class="function">PQescapeStringConn</code>はそのゼロで終了します。
この動作は<code class="function">strncpy</code>と同様です。)
<em class="parameter"><code>to</code></em>は、最低でも<em class="parameter"><code>length</code></em>の2倍よりも1バイト多い文字を保持可能なバッファへのポインタにしなければなりません。
さもないと、動作は不定になります。
<em class="parameter"><code>to</code></em>と<em class="parameter"><code>from</code></em>文字領域が重なる場合の動作も不定です。
     </p><p>
<span class="original">
      If the &lt;parameter&gt;error&lt;/parameter&gt; parameter is not &lt;symbol&gt;NULL&lt;/symbol&gt;, then
      &lt;literal&gt;*error&lt;/literal&gt; is set to zero on success, nonzero on error.
      Presently the only possible error conditions involve invalid multibyte
      encoding in the source string.  The output string is still generated
      on error, but it can be expected that the server will reject it as
      malformed.  On error, a suitable message is stored in the
      &lt;parameter&gt;conn&lt;/parameter&gt; object, whether or not &lt;parameter&gt;error&lt;/parameter&gt; is &lt;symbol&gt;NULL&lt;/symbol&gt;.
</span>
<em class="parameter"><code>error</code></em>パラメータが<code class="symbol">NULL</code>でなければ、<code class="literal">*error</code>には成功の0か、エラーの0以外が設定されます。
現時点であり得る唯一のエラー条件は、元文字列に無効なマルチバイト符号が含まれている場合です。
出力文字列はエラーであっても生成されますが、サーバが不整合として却下することが想定できます。
エラーの際、適切なメッセージは<em class="parameter"><code>error</code></em>が<code class="symbol">NULL</code>かどうかにかかわらず<em class="parameter"><code>conn</code></em>オブジェクト内に格納されます。
     </p><p>
<span class="original">
      &lt;function&gt;PQescapeStringConn&lt;/function&gt; returns the number of bytes written
      to &lt;parameter&gt;to&lt;/parameter&gt;, not including the terminating zero byte.
</span>
<code class="function">PQescapeStringConn</code>は<em class="parameter"><code>to</code></em>に書き出したバイト数を返します。
ただし、文字数にはゼロバイト終端は含まれません。
     </p></dd><dt id="LIBPQ-PQESCAPESTRING"><span class="term">
      <code class="function">PQescapeString</code>
      <a id="id-1.7.3.10.6.3.4.1.2" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       &lt;function&gt;PQescapeString&lt;/function&gt; is an older, deprecated version of
       &lt;function&gt;PQescapeStringConn&lt;/function&gt;.
</span>
<code class="function">PQescapeString</code>は<code class="function">PQescapeStringConn</code>の推奨されない古いものです。
</p><pre class="synopsis">
size_t PQescapeString (char *to, const char *from, size_t length);
</pre><p>
     </p><p>
<span class="original">
      The only difference from &lt;function&gt;PQescapeStringConn&lt;/function&gt; is that
      &lt;function&gt;PQescapeString&lt;/function&gt; does not take &lt;structname&gt;PGconn&lt;/structname&gt;
      or &lt;parameter&gt;error&lt;/parameter&gt; parameters.
      Because of this, it cannot adjust its behavior depending on the
      connection properties (such as character encoding) and therefore
      &lt;emphasis&gt;it might give the wrong results&lt;/emphasis&gt;.  Also, it has no way
      to report error conditions.
</span>
<code class="function">PQescapeStringConn</code>との唯一の違いは、<code class="function">PQescapeString</code>は<code class="structname">PGconn</code>や<em class="parameter"><code>error</code></em>パラメータを取らないことです。
このため(文字符号化方式のような)接続属性に依存する振舞いを調整できません。
その結果<span class="emphasis"><em>間違った結果を返す可能性があります</em></span>。
また、エラー状態を通知する機能がありません。
     </p><p>
<span class="original">
      &lt;function&gt;PQescapeString&lt;/function&gt; can be used safely in
      client programs that work with only one &lt;productname&gt;PostgreSQL&lt;/productname&gt;
      connection at a time (in this case it can find out what it needs to
      know &lt;quote&gt;behind the scenes&lt;/quote&gt;).  In other contexts it is a security
      hazard and should be avoided in favor of
      &lt;function&gt;PQescapeStringConn&lt;/function&gt;.
</span>
<code class="function">PQescapeString</code>は、一度に1つの<span class="productname">PostgreSQL</span>接続のみで動作するクライアントプログラムでは安全に利用できます。
(この場合知らなければならない<span class="quote">「<span class="quote">裏側に隠された情報</span>」</span>を知ることができるからです。)
他の場合には、セキュリティ要因であり<code class="function">PQescapeStringConn</code>を利用することで避けなければなりません。
     </p></dd><dt id="LIBPQ-PQESCAPEBYTEACONN"><span class="term">
      <code class="function">PQescapeByteaConn</code>
      <a id="id-1.7.3.10.6.3.5.1.2" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       Escapes binary data for use within an SQL command with the type
       &lt;type&gt;bytea&lt;/type&gt;.  As with &lt;function&gt;PQescapeStringConn&lt;/function&gt;,
       this is only used when inserting data directly into an SQL command string.
</span>
<code class="type">bytea</code>型としてSQLコマンド内で使用するバイナリデータをエスケープします。
<code class="function">PQescapeStringConn</code>と同様、これは、SQLコマンド文字列にデータを直接含める場合にのみに使用されます。
</p><pre class="synopsis">
unsigned char *PQescapeByteaConn(PGconn *conn,
                                 const unsigned char *from,
                                 size_t from_length,
                                 size_t *to_length);
</pre><p>
      </p><p>
<span class="original">
       Certain byte values must be escaped when used as part of a
       &lt;type&gt;bytea&lt;/type&gt; literal in an &lt;acronym&gt;SQL&lt;/acronym&gt; statement.
       &lt;function&gt;PQescapeByteaConn&lt;/function&gt; escapes bytes using
       either hex encoding or backslash escaping.  See &lt;xref
       linkend="datatype-binary"/&gt; for more information.
</span>
<acronym class="acronym">SQL</acronym>文内の<code class="type">bytea</code>リテラルの一部として使用する場合、特定のバイト値はエスケープされなければなりません。
<code class="function">PQescapeByteaConn</code>は16進数符号化またはバックスラッシュエスケープ処理を使用してバイトをエスケープします。
詳しくは<a class="xref" href="datatype-binary.html" title="8.4. バイナリ列データ型">8.4</a>を参照してください。
      </p><p>
<span class="original">
       The &lt;parameter&gt;from&lt;/parameter&gt; parameter points to the first
       byte of the string that is to be escaped, and the
       &lt;parameter&gt;from_length&lt;/parameter&gt; parameter gives the number of
       bytes in this binary string.  (A terminating zero byte is
       neither necessary nor counted.)  The &lt;parameter&gt;to_length&lt;/parameter&gt;
       parameter points to a variable that will hold the resultant
       escaped string length. This result string length includes the terminating
       zero byte of the result.
</span>
<em class="parameter"><code>from</code></em>パラメータはエスケープ対象の文字列の先頭バイトを指し示すポインタです。
<em class="parameter"><code>from_length</code></em>パラメータは、このバイナリ列内のバイト数を指定します。
(ゼロバイト終端は不要、かつ、数えられません。)
<em class="parameter"><code>to_length</code></em>パラメータは結果となるエスケープされた文字列の長さを保持する変数へのポインタです。
この結果文字列長は、結果内のゼロバイト終端を含みます。
      </p><p>
<span class="original">
       &lt;function&gt;PQescapeByteaConn&lt;/function&gt; returns an escaped version of the
       &lt;parameter&gt;from&lt;/parameter&gt; parameter binary string in memory
       allocated with &lt;function&gt;malloc()&lt;/function&gt;.  This memory should be freed using
       &lt;function&gt;PQfreemem()&lt;/function&gt; when the result is no longer needed.  The
       return string has all special characters replaced so that they can
       be properly processed by the &lt;productname&gt;PostgreSQL&lt;/productname&gt;
       string literal parser, and the &lt;type&gt;bytea&lt;/type&gt; input function. A
       terminating zero byte is also added.  The single quotes that must
       surround &lt;productname&gt;PostgreSQL&lt;/productname&gt; string literals are
       not part of the result string.
</span>
<code class="function">PQescapeByteaConn</code>は、<em class="parameter"><code>from</code></em>パラメータが示すバイナリ文字列をエスケープしたものを<code class="function">malloc()</code>で確保したメモリ内に返します。
その結果が不要になったら、このメモリを<code class="function">PQfreemem</code>を使用して解放しなければなりません。
返される文字列では、<span class="productname">PostgreSQL</span>リテラル文字列パーサと<code class="type">bytea</code>入力関数によって適切に処理できるように、すべての特殊な文字が置換されています。
ゼロバイト終端も追加されます。
<span class="productname">PostgreSQL</span>のリテラル文字列をくくる単一引用符は結果文字列には含まれません。
      </p><p>
<span class="original">
       On error, a null pointer is returned, and a suitable error message
       is stored in the &lt;parameter&gt;conn&lt;/parameter&gt; object.  Currently, the only
       possible error is insufficient memory for the result string.
</span>
エラー時、ヌルポインタを返し適切なエラーメッセージを<em class="parameter"><code>conn</code></em>オブジェクトに格納します。
現在、唯一あり得るエラーは結果文字列のメモリ不足です。
      </p></dd><dt id="LIBPQ-PQESCAPEBYTEA"><span class="term">
      <code class="function">PQescapeBytea</code>
      <a id="id-1.7.3.10.6.3.6.1.2" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       &lt;function&gt;PQescapeBytea&lt;/function&gt; is an older, deprecated version of
       &lt;function&gt;PQescapeByteaConn&lt;/function&gt;.
</span>
<code class="function">PQescapeBytea</code>は、<code class="function">PQescapeByteaConn</code>の推奨されない古いものです。
</p><pre class="synopsis">
unsigned char *PQescapeBytea(const unsigned char *from,
                             size_t from_length,
                             size_t *to_length);
</pre><p>
      </p><p>
<span class="original">
       The only difference from &lt;function&gt;PQescapeByteaConn&lt;/function&gt; is that
       &lt;function&gt;PQescapeBytea&lt;/function&gt; does not take a &lt;structname&gt;PGconn&lt;/structname&gt;
       parameter.  Because of this, &lt;function&gt;PQescapeBytea&lt;/function&gt; can
       only be used safely in client programs that use a single
       &lt;productname&gt;PostgreSQL&lt;/productname&gt; connection at a time (in this case
       it can find out what it needs to know &lt;quote&gt;behind the
       scenes&lt;/quote&gt;).  It &lt;emphasis&gt;might give the wrong results&lt;/emphasis&gt; if
       used in programs that use multiple database connections (use
       &lt;function&gt;PQescapeByteaConn&lt;/function&gt; in such cases).
</span>
<code class="function">PQescapeBytea</code>の<code class="function">PQescapeByteaConn</code>との唯一の違いは、<code class="structname">PGconn</code>パラメータです。
このため<code class="function">PQescapeBytea</code>は、一度に１つの<span class="productname">PostgreSQL</span>接続を使用するクライアントプログラムのみで安全に利用することができます。
(この場合知らなければならない<span class="quote">「<span class="quote">裏側に隠された情報</span>」</span>を知ることができるからです。)
複数のデータベース接続を使用するプログラムでは<span class="emphasis"><em>間違った結果を返す可能性があります</em></span>。
（このような場合は<code class="function">PQescapeByteaConn</code>を使用してください。）
      </p></dd><dt id="LIBPQ-PQUNESCAPEBYTEA"><span class="term">
      <code class="function">PQunescapeBytea</code>
      <a id="id-1.7.3.10.6.3.7.1.2" class="indexterm"></a>
     </span></dt><dd><p>
<span class="original">
       Converts a string representation of binary data into binary data
       &amp;mdash; the reverse of &lt;function&gt;PQescapeBytea&lt;/function&gt;.  This
       is needed when retrieving &lt;type&gt;bytea&lt;/type&gt; data in text format,
       but not when retrieving it in binary format.
</span>
バイナリデータの文字列表現をバイナリデータに変換します。
つまり、<code class="function">PQescapeBytea</code>の逆です。
これは、<code class="type">bytea</code>データをテキスト書式で受けとった場合に必要とされます。
しかし、バイナリ書式で受けとった場合は不要です。

</p><pre class="synopsis">
unsigned char *PQunescapeBytea(const unsigned char *from, size_t *to_length);
</pre><p>
      </p><p>
<span class="original">
       The &lt;parameter&gt;from&lt;/parameter&gt; parameter points to a string
       such as might be returned by &lt;function&gt;PQgetvalue&lt;/function&gt; when applied
       to a &lt;type&gt;bytea&lt;/type&gt; column. &lt;function&gt;PQunescapeBytea&lt;/function&gt;
       converts this string representation into its binary representation.
       It returns a pointer to a buffer allocated with
       &lt;function&gt;malloc()&lt;/function&gt;, or &lt;symbol&gt;NULL&lt;/symbol&gt; on error, and puts the size of
       the buffer in &lt;parameter&gt;to_length&lt;/parameter&gt;. The result must be
       freed using &lt;function&gt;PQfreemem&lt;/function&gt; when it is no longer needed.
</span>
<em class="parameter"><code>from</code></em>パラメータは、例えば、<code class="type">bytea</code>列に<code class="function">PQgetvalue</code>を行なった場合に返される可能性がある、文字列を指し示すポインタです。
<code class="function">PQunescapeBytea</code>は、この文字列表現をバイナリ表現に変換します。
<code class="function">malloc()</code>で確保したバッファへのポインタを返します。
エラー時は<code class="symbol">NULL</code>です。
また、このバッファのサイズを<em class="parameter"><code>to_length</code></em>に格納します。
不要になったら、この結果を<code class="function">PQfreemem</code>を使用して解放しなければなりません。
      </p><p>
<span class="original">
       This conversion is not exactly the inverse of
       &lt;function&gt;PQescapeBytea&lt;/function&gt;, because the string is not expected
       to be &lt;quote&gt;escaped&lt;/quote&gt; when received from &lt;function&gt;PQgetvalue&lt;/function&gt;.
       In particular this means there is no need for string quoting considerations,
       and so no need for a &lt;structname&gt;PGconn&lt;/structname&gt; parameter.
</span>
この変換は、<code class="function">PQescapeBytea</code>の逆ではありません。
文字列は<code class="function">PQgetvalue</code>から受け取る場合<span class="quote">「<span class="quote">エスケープされた</span>」</span>ことを予想しないためです。
特にこれは、文字列の引用符付けを意識する必要がなく、そのため<code class="structname">PGconn</code>パラメータを持つ必要がないことを意味します。
      </p></dd></dl></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="libpq-status.html">前へ</a> </td><td width="20%" align="center"><a accesskey="u" href="libpq.html">上へ</a></td><td width="40%" align="right"> <a accesskey="n" href="libpq-async.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">34.2. 接続状態関数 </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> 34.4. 非同期コマンドの処理</td></tr></table></div></body></html>