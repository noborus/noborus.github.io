<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>pgbench</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="app-pgbasebackup.html" title="pg_basebackup" /><link rel="next" href="app-pgconfig.html" title="pg_config" /><meta name="viewport" content="width=device-width,initial-scale=1.0" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="4" align="center"><a accesskey="h" href="index.html">PostgreSQL 11.3文書</a></th></tr><tr><td width="10%" align="left"></td><td width="10%" align="left"></td><td width="60%" align="center"><a href="reference-client.html" title="PostgreSQLクライアントアプリケーション">PostgreSQLクライアントアプリケーション</a></td><td width="20%" align="right"><div class="actions"><a class="issue" title="github" href="https://github.com/pgsql-jp/jpug-doc/issues/new?title=version 11.3 &#10;                      pgbench.html">誤訳等の報告
                    </a></div></td></tr><tr><td width="10%" align="left"><a accesskey="p" href="app-pgbasebackup.html" title="pg_basebackup">前へ</a> </td><td width="10%" align="left"><a accesskey="u" href="reference-client.html" title="PostgreSQLクライアントアプリケーション">上へ</a></td><td width="60%" align="center"><span class="application">pgbench</span></td><td width="20%" align="right"> <a accesskey="n" href="app-pgconfig.html" title="pg_config">次へ</a></td></tr></table><hr /></div><div class="refentry" id="PGBENCH"><div class="titlepage"></div><a id="id-1.9.4.10.1" class="indexterm"></a><div class="refnamediv"><h2><span class="refentrytitle"><span class="application">pgbench</span></span></h2><p>pgbench<span class="original">
  &lt;refpurpose&gt;run a benchmark test on &lt;productname&gt;PostgreSQL&lt;/productname&gt;&lt;/refpurpose&gt;
</span> — <span class="productname">PostgreSQL</span>に対してベンチマーク試験を行う</p></div><div class="refsynopsisdiv"><h2>概要</h2><div class="cmdsynopsis"><p id="id-1.9.4.10.4.1"><code class="command">pgbench</code>  <code class="option">-i</code>  [<em class="replaceable"><code>option</code></em>...] [<em class="replaceable"><code>dbname</code></em>]</p></div><div class="cmdsynopsis"><p id="id-1.9.4.10.4.2"><code class="command">pgbench</code> [<em class="replaceable"><code>option</code></em>...] [<em class="replaceable"><code>dbname</code></em>]</p></div></div><div class="refsect1" id="id-1.9.4.10.5"><h2>説明</h2><span class="original">
  &lt;title&gt;Description&lt;/title&gt;
</span><p>
<span class="original">
  &lt;application&gt;pgbench&lt;/application&gt; is a simple program for running benchmark
  tests on &lt;productname&gt;PostgreSQL&lt;/productname&gt;.  It runs the same sequence of SQL
  commands over and over, possibly in multiple concurrent database sessions,
  and then calculates the average transaction rate (transactions per second).
  By default, &lt;application&gt;pgbench&lt;/application&gt; tests a scenario that is
  loosely based on TPC-B, involving five &lt;command&gt;SELECT&lt;/command&gt;,
  &lt;command&gt;UPDATE&lt;/command&gt;, and &lt;command&gt;INSERT&lt;/command&gt; commands per transaction.
  However, it is easy to test other cases by writing your own transaction
  script files.
</span>
<span class="application">pgbench</span>は<span class="productname">PostgreSQL</span>上でベンチマーク試験を行う単純なプログラムです。
これは同一のSQLコマンドの並びを何度も実行します。複数の同時実行データベースセッションで実行することもできます。
そして、トランザクションの速度（1秒当たりのトランザクション数）の平均を計算します。
デフォルトで<span class="application">pgbench</span>は、1トランザクション当たり5つの<code class="command">SELECT</code>、<code class="command">UPDATE</code>、<code class="command">INSERT</code>コマンドを含むおおよそTPC-Bに基いたシナリオを試験します。
しかし、独自のトランザクションスクリプトファイルを作成することで他の試験ケースを簡単に実行することができます。
 </p><p>
<span class="original">
  Typical output from &lt;application&gt;pgbench&lt;/application&gt; looks like:
</span>
pgbenchの典型的な出力を以下に示します。

</p><pre class="screen">
transaction type: &lt;builtin: TPC-B (sort of)&gt;
scaling factor: 10
query mode: simple
number of clients: 10
number of threads: 1
number of transactions per client: 1000
number of transactions actually processed: 10000/10000
tps = 85.184871 (including connections establishing)
tps = 85.296346 (excluding connections establishing)
</pre><p>

<span class="original">
  The first six lines report some of the most important parameter
  settings.  The next line reports the number of transactions completed
  and intended (the latter being just the product of number of clients
  and number of transactions per client); these will be equal unless the run
  failed before completion.  (In &lt;option&gt;-T&lt;/option&gt; mode, only the actual
  number of transactions is printed.)
  The last two lines report the number of transactions per second,
  figured with and without counting the time to start database sessions.
</span>
最初の6行はいくつかの最重要パラメータの設定を表示しています。
次行が完了トランザクション数と予定トランザクション数です（後者は単なるクライアント数とクライアント毎のトランザクション数の積算結果です。）
実行が完了する前に失敗しない限りこれは等しくなります。
(<code class="option">-T</code>モードでは、トランザクションの実際の数が表示されます)
最後の2行は、データベースセッションを開始するための時間を含める場合と含めない場合の1秒当たりのトランザクション数を示します。
 </p><p>
<span class="original">
   The default TPC-B-like transaction test requires specific tables to be
   set up beforehand.  &lt;application&gt;pgbench&lt;/application&gt; should be invoked with
   the &lt;option&gt;-i&lt;/option&gt; (initialize) option to create and populate these
   tables.  (When you are testing a custom script, you don't need this
   step, but will instead need to do whatever setup your test needs.)
   Initialization looks like:
</span>
デフォルトのTPC-Bと似たトランザクション試験では、あらかじめ設定する特定のテーブルが必要です。
これらのテーブルを作成し、データを投入するためには、<code class="option">-i</code>(初期化)オプションを付けて<span class="application">pgbench</span>を呼び出さなければなりません。
(独自スクリプトを試験する場合、この手順は必要ありません。
しかし代わりに試験に必要な何らかの設定を行わなければならないでしょう。)
初期化は以下のようになります。

</p><pre class="programlisting">
pgbench -i [<span class="optional"> <em class="replaceable"><code>other-options</code></em> </span>] <em class="replaceable"><code>dbname</code></em>
</pre><p>

<span class="original">
   where &lt;replaceable&gt;dbname&lt;/replaceable&gt; is the name of the already-created
   database to test in.  (You may also need &lt;option&gt;-h&lt;/option&gt;,
   &lt;option&gt;-p&lt;/option&gt;, and/or &lt;option&gt;-U&lt;/option&gt; options to specify how to
   connect to the database server.)
</span>
ここで<em class="replaceable"><code>dbname</code></em>は試験用に前もって作成されたデータベースの名前です。
（またデータベースサーバの接続方法を指定するために、<code class="option">-h</code>、<code class="option">-p</code>、<code class="option">-U</code>が必要になるかもしれません。）
  </p><div class="caution"><h3 class="title">注意</h3><p>
<span class="original">
    &lt;literal&gt;pgbench -i&lt;/literal&gt; creates four tables &lt;structname&gt;pgbench_accounts&lt;/structname&gt;,
    &lt;structname&gt;pgbench_branches&lt;/structname&gt;, &lt;structname&gt;pgbench_history&lt;/structname&gt;, and
    &lt;structname&gt;pgbench_tellers&lt;/structname&gt;,
    destroying any existing tables of these names.
    Be very careful to use another database if you have tables having these
    names!
</span>
<code class="literal">pgbench -i</code>は4つのテーブル<code class="structname">pgbench_accounts</code>、<code class="structname">pgbench_branches</code>、<code class="structname">pgbench_history</code>、<code class="structname">pgbench_tellers</code>を作成します。
もしあればこうした名前のテーブルは破壊されます。
もし同じ名前のテーブルが存在する場合にはよく注意してください。
   </p></div><p>
<span class="original">
   At the default &lt;quote&gt;scale factor&lt;/quote&gt; of 1, the tables initially
   contain this many rows:
</span>
デフォルトの<span class="quote">「<span class="quote">倍数</span>」</span>の1では、テーブルは初期状態で以下の行数を含みます。
</p><pre class="screen">
table                   # of rows
---------------------------------
pgbench_branches        1
pgbench_tellers         10
pgbench_accounts        100000
pgbench_history         0
</pre><p>
<span class="original">
   You can (and, for most purposes, probably should) increase the number
   of rows by using the &lt;option&gt;-s&lt;/option&gt; (scale factor) option.  The
   &lt;option&gt;-F&lt;/option&gt; (fillfactor) option might also be used at this point.
</span>
<code class="option">-s</code>（倍数）オプションを使用して行数を増加させることができます（また、ほとんどの目的ではおそらく増加させるべきです）。
また、<code class="option">-F</code> （フィルファクタ）オプションをここで使用しても構いません。
  </p><p>
<span class="original">
   Once you have done the necessary setup, you can run your benchmark
   with a command that doesn't include &lt;option&gt;-i&lt;/option&gt;, that is
</span>
一度この必要な設定を行った後、以下のように<code class="option">-i</code>を持たないコマンドでベンチマークを行うことができます。

</p><pre class="programlisting">
pgbench [<span class="optional"> <em class="replaceable"><code>options</code></em> </span>] <em class="replaceable"><code>dbname</code></em>
</pre><p>

<span class="original">
   In nearly all cases, you'll need some options to make a useful test.
   The most important options are &lt;option&gt;-c&lt;/option&gt; (number of clients),
   &lt;option&gt;-t&lt;/option&gt; (number of transactions), &lt;option&gt;-T&lt;/option&gt; (time limit),
   and &lt;option&gt;-f&lt;/option&gt; (specify a custom script file).
   See below for a full list.
</span>
ほとんどすべての場合、有用な試験とするためにいくつかのオプションが必要になります。
最重要オプションは<code class="option">-c</code>（クライアント数）、<code class="option">-t</code>（トランザクション数）、<code class="option">-T</code> (制限時間)、<code class="option">-f</code>（独自スクリプトファイルの指定）です。
以下の全一覧を参照してください。
  </p></div><div class="refsect1" id="id-1.9.4.10.6"><h2>オプション</h2><span class="original">
  &lt;title&gt;Options&lt;/title&gt;
</span><p>
<span class="original">
   The following is divided into three subsections.  Different options are
   used during database initialization and while running benchmarks, but some
   options are useful in both cases.
</span>
以下では、データベース初期化時に使用されるオプション、ベンチマーク実行時に使用されるオプション、どちらの場合でも使われるオプションの３つに分けて説明します。
  </p><div class="refsect2" id="PGBENCH-INIT-OPTIONS"><h3>初期化用のオプション</h3><span class="original">
  &lt;title&gt;Initialization Options&lt;/title&gt;
</span><p>
<span class="original">
    &lt;application&gt;pgbench&lt;/application&gt; accepts the following command-line
    initialization arguments:
</span>
<span class="application">pgbench</span>は以下の初期化用のコマンドライン引数を受け付けます。

    </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-i</code><br /></span><span class="term"><code class="option">--initialize</code></span></dt><dd><p>
<span class="original">
        Required to invoke initialization mode.
</span>
初期化モードを呼び出すために必要です。
       </p></dd><dt><span class="term"><code class="option">-I <em class="replaceable"><code>init_steps</code></em></code><br /></span><span class="term"><code class="option">--init-steps=<em class="replaceable"><code>init_steps</code></em></code></span></dt><dd><p>
<span class="original">
        Perform just a selected set of the normal initialization steps.
        &lt;replaceable&gt;init_steps&lt;/replaceable&gt; specifies the
        initialization steps to be performed, using one character per step.
        Each step is invoked in the specified order.
        The default is &lt;literal&gt;dtgvp&lt;/literal&gt;.
        The available steps are:
</span>
標準の初期化ステップの内、選択したものだけを実行します。
<em class="replaceable"><code>init_steps</code></em>では、各ステップ毎に1文字を使って、実行する初期化ステップを指定します。
各ステップは指定した順で実行されます。
デフォルトは<code class="literal">dtgvp</code>です。
有効なステップは以下の通りです。

        </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">d</code> (Drop)</span></dt><dd><p>
<span class="original">
            Drop any existing &lt;application&gt;pgbench&lt;/application&gt; tables.
</span>
既存の<span class="application">pgbench</span>のテーブルを全て削除します。
           </p></dd><dt><span class="term"><code class="literal">t</code> (create Tables)</span></dt><dd><p>
<span class="original">
            Create the tables used by the
            standard &lt;application&gt;pgbench&lt;/application&gt; scenario, namely
            &lt;structname&gt;pgbench_accounts&lt;/structname&gt;,
            &lt;structname&gt;pgbench_branches&lt;/structname&gt;,
            &lt;structname&gt;pgbench_history&lt;/structname&gt;, and
            &lt;structname&gt;pgbench_tellers&lt;/structname&gt;.
</span>
標準の<span class="application">pgbench</span>シナリオで使われるテーブル、すなわち<code class="structname">pgbench_accounts</code>、<code class="structname">pgbench_branches</code>、<code class="structname">pgbench_history</code>および<code class="structname">pgbench_tellers</code>を作成します。
           </p></dd><dt><span class="term"><code class="literal">g</code> (Generate data)</span></dt><dd><p>
<span class="original">
            Generate data and load it into the standard tables,
            replacing any data already present.
</span>
データを生成し、既存データを置き換えて、標準の各テーブルに読み込みます。
           </p></dd><dt><span class="term"><code class="literal">v</code> (Vacuum)</span></dt><dd><p>
<span class="original">
            Invoke &lt;command&gt;VACUUM&lt;/command&gt; on the standard tables.
</span>
標準の各テーブルに対して<code class="command">VACUUM</code>を実行します。
           </p></dd><dt><span class="term"><code class="literal">p</code> (create Primary keys)</span></dt><dd><p>
<span class="original">
            Create primary key indexes on the standard tables.
</span>
標準の各テーブルにプライマリキーインデックスを作成します。
           </p></dd><dt><span class="term"><code class="literal">f</code> (create Foreign keys)</span></dt><dd><p>
<span class="original">
            Create foreign key constraints between the standard tables.
            (Note that this step is not performed by default.)
</span>
標準のテーブル間に外部キー制約を作成します。
（このステップはデフォルトでは実行されないことに注意してください）
           </p></dd></dl></div><p>
       </p></dd><dt><span class="term"><code class="option">-F</code> <em class="replaceable"><code>fillfactor</code></em><br /></span><span class="term"><code class="option">--fillfactor=</code><em class="replaceable"><code>fillfactor</code></em></span></dt><dd><p>
<span class="original">
        Create the &lt;structname&gt;pgbench_accounts&lt;/structname&gt;,
        &lt;structname&gt;pgbench_tellers&lt;/structname&gt; and
        &lt;structname&gt;pgbench_branches&lt;/structname&gt; tables with the given fillfactor.
        Default is 100.
</span>
指定したフィルファクタで<code class="structname">pgbench_accounts</code>、<code class="structname">pgbench_tellers</code>、<code class="structname">pgbench_branches</code>テーブルを作成します。
デフォルトは100です。
       </p></dd><dt><span class="term"><code class="option">-n</code><br /></span><span class="term"><code class="option">--no-vacuum</code></span></dt><dd><p>
<span class="original">
        Perform no vacuuming during initialization.
        (This option suppresses the &lt;literal&gt;v&lt;/literal&gt; initialization step,
        even if it was specified in &lt;option&gt;-I&lt;/option&gt;.)
</span>
初期化でバキュームを実行しません。
（このオプションは<code class="option">-I</code>で指定されていたとしても初期化ステップ<code class="literal">v</code>を抑止します。）
       </p></dd><dt><span class="term"><code class="option">-q</code><br /></span><span class="term"><code class="option">--quiet</code></span></dt><dd><p>
<span class="original">
        Switch logging to quiet mode, producing only one progress message per 5
        seconds. The default logging prints one message each 100000 rows, which
        often outputs many lines per second (especially on good hardware).
</span>
ログ処理を、5秒に１つの進行メッセージのみを生成する静寂モードに切り替えます。
デフォルトのログ処理では、10000行毎にメッセージを１つ出力し、（特に優れたハードウェアでは）1秒当たりに多くのメッセージを出力します。
       </p></dd><dt><span class="term"><code class="option">-s</code> <em class="replaceable"><code>scale_factor</code></em><br /></span><span class="term"><code class="option">--scale=</code><em class="replaceable"><code>scale_factor</code></em></span></dt><dd><p>
<span class="original">
        Multiply the number of rows generated by the scale factor.
        For example, &lt;literal&gt;-s 100&lt;/literal&gt; will create 10,000,000 rows
        in the &lt;structname&gt;pgbench_accounts&lt;/structname&gt; table. Default is 1.
        When the scale is 20,000 or larger, the columns used to
        hold account identifiers (&lt;structfield&gt;aid&lt;/structfield&gt; columns)
        will switch to using larger integers (&lt;type&gt;bigint&lt;/type&gt;),
        in order to be big enough to hold the range of account
        identifiers.
</span>
この倍率で生成される行数を積算します。
例えば、<code class="literal">-s 100</code>は <code class="structname">pgbench_accounts</code>テーブルに10,000,000行を生成することを意味します。
デフォルトは1です。
この倍率が20000以上になると、アカウント識別子の範囲を保持できる程度に大きくなるように、アカウント識別子を保持するために使用される列（<code class="structfield">aid</code>列）はより大きな整数（<code class="type">bigint</code>）を使用するように切り替わります。
       </p></dd><dt><span class="term"><code class="option">--foreign-keys</code></span></dt><dd><p>
<span class="original">
        Create foreign key constraints between the standard tables.
        (This option adds the &lt;literal&gt;f&lt;/literal&gt; step to the initialization
        step sequence, if it is not already present.)
</span>
標準テーブル間で外部キー制約を作成します。
（このオプションは初期化ステップの並びに、もし無かったなら<code class="literal">f</code>ステップを追加します。）
       </p></dd><dt><span class="term"><code class="option">--index-tablespace=<em class="replaceable"><code>index_tablespace</code></em></code></span></dt><dd><p>
<span class="original">
        Create indexes in the specified tablespace, rather than the default
        tablespace.
</span>
デフォルトのテーブル空間ではなく、指定したテーブル空間の中にインデックスを作成します。
       </p></dd><dt><span class="term"><code class="option">--tablespace=<em class="replaceable"><code>tablespace</code></em></code></span></dt><dd><p>
<span class="original">
        Create tables in the specified tablespace, rather than the default
        tablespace.
</span>
デフォルトのテーブル空間ではなく、指定したテーブル空間の中にテーブルを作成します。
       </p></dd><dt><span class="term"><code class="option">--unlogged-tables</code></span></dt><dd><p>
<span class="original">
        Create all tables as unlogged tables, rather than permanent tables.
</span>
永続テーブルではなくログを取らないテーブルとしてテーブルを作成します。
       </p></dd></dl></div><p>
   </p></div><div class="refsect2" id="PGBENCH-RUN-OPTIONS"><h3>ベンチマーク用オプション</h3><span class="original">
  &lt;title&gt;Benchmarking Options&lt;/title&gt;
</span><p>
<span class="original">
    &lt;application&gt;pgbench&lt;/application&gt; accepts the following command-line
    benchmarking arguments:
</span>
<span class="application">pgbench</span>は以下のベンチマーク用コマンドライン引数を受け付けます。

    </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-b</code> <em class="replaceable"><code>scriptname[@weight]</code></em><br /></span><span class="term"><code class="option">--builtin</code>=<em class="replaceable"><code>scriptname[@weight]</code></em></span></dt><dd><p>
<span class="original">
        Add the specified built-in script to the list of executed scripts.
        An optional integer weight after &lt;literal&gt;@&lt;/literal&gt; allows to adjust the
        probability of drawing the script.  If not specified, it is set to 1.
        Available built-in scripts are: &lt;literal&gt;tpcb-like&lt;/literal&gt;,
        &lt;literal&gt;simple-update&lt;/literal&gt; and &lt;literal&gt;select-only&lt;/literal&gt;.
        Unambiguous prefixes of built-in names are accepted.
        With special name &lt;literal&gt;list&lt;/literal&gt;, show the list of built-in scripts
        and exit immediately.
</span>
指定の組み込みスクリプトを実行されたスクリプトのリストに追加します。
オプションで<code class="literal">@</code>の後に整数のweight（重み）をつけることで、そのスクリプトが選ばれる確率を調整することができます。
指定しなかった場合は1に設定されます。
利用可能な組み込みのスクリプトは、<code class="literal">tpcb-like</code>、<code class="literal">simple-update</code>、<code class="literal">select-only</code>です。
組み込みの名前の曖昧な接頭辞も受け付けられます。
特別な名前<code class="literal">list</code>を使うと、組み込みスクリプトのリストを表示して、即座に終了します。
       </p></dd><dt><span class="term"><code class="option">-c</code> <em class="replaceable"><code>clients</code></em><br /></span><span class="term"><code class="option">--client=</code><em class="replaceable"><code>clients</code></em></span></dt><dd><p>
<span class="original">
        Number of clients simulated, that is, number of concurrent database
        sessions.  Default is 1.
</span>
模擬するクライアント数、つまり、同時に実行されるデータベースセッション数です。
デフォルトは1です。
       </p></dd><dt><span class="term"><code class="option">-C</code><br /></span><span class="term"><code class="option">--connect</code></span></dt><dd><p>
<span class="original">
        Establish a new connection for each transaction, rather than
        doing it just once per client session.
        This is useful to measure the connection overhead.
</span>
各クライアントセッションが一度だけ接続を確立するのではなく、各トランザクションが新しい接続を確立します。
これは接続オーバーヘッドを測定する場合に有用です。
       </p></dd><dt><span class="term"><code class="option">-d</code><br /></span><span class="term"><code class="option">--debug</code></span></dt><dd><p>
<span class="original">
        Print debugging output.
</span>
デバッグ用出力を表示します。
       </p></dd><dt><span class="term"><code class="option">-D</code> <em class="replaceable"><code>varname</code></em><code class="literal">=</code><em class="replaceable"><code>value</code></em><br /></span><span class="term"><code class="option">--define=</code><em class="replaceable"><code>varname</code></em><code class="literal">=</code><em class="replaceable"><code>value</code></em></span></dt><dd><p>
<span class="original">
        Define a variable for use by a custom script (see below).
        Multiple &lt;option&gt;-D&lt;/option&gt; options are allowed.
</span>
独自スクリプト（後述）で使用される変数を定義します。
複数の<code class="option">-D</code>オプションを使用することができます。
       </p></dd><dt><span class="term"><code class="option">-f</code> <em class="replaceable"><code>filename[@weight]</code></em><br /></span><span class="term"><code class="option">--file=</code><em class="replaceable"><code>filename[@weight]</code></em></span></dt><dd><p>
<span class="original">
        Add a transaction script read from &lt;replaceable&gt;filename&lt;/replaceable&gt; to
        the list of executed scripts.
        An optional integer weight after &lt;literal&gt;@&lt;/literal&gt; allows to adjust the
        probability of drawing the test.
        See below for details.
</span>
<em class="replaceable"><code>filename</code></em>から読み取ったトランザクションスクリプトを実行されたスクリプトのリストに追加します。
オプションで<code class="literal">@</code>の後に整数のweight（重み）をつけることで、そのテストが選ばれる確率を調整することができます。
詳細は後で説明します。
       </p></dd><dt><span class="term"><code class="option">-j</code> <em class="replaceable"><code>threads</code></em><br /></span><span class="term"><code class="option">--jobs=</code><em class="replaceable"><code>threads</code></em></span></dt><dd><p>
<span class="original">
        Number of worker threads within &lt;application&gt;pgbench&lt;/application&gt;.
        Using more than one thread can be helpful on multi-CPU machines.
        Clients are distributed as evenly as possible among available threads.
        Default is 1.
</span>
<span class="application">pgbench</span>内のワーカスレッド数です。
複数のスレッドを使用することはマルチCPUマシンで有用になります。
クライアントは利用可能なスレッドの間でできる限り均等に分散されます。
デフォルトは1です。
       </p></dd><dt><span class="term"><code class="option">-l</code><br /></span><span class="term"><code class="option">--log</code></span></dt><dd><p>
<span class="original">
        Write information about each transaction to a log file.
        See below for details.
</span>
各トランザクションに関する情報をログファイルに書き出します。
後で詳細を説明します。
       </p></dd><dt><span class="term"><code class="option">-L</code> <em class="replaceable"><code>limit</code></em><br /></span><span class="term"><code class="option">--latency-limit=</code><em class="replaceable"><code>limit</code></em></span></dt><dd><p>
<span class="original">
        Transaction which last more than &lt;replaceable&gt;limit&lt;/replaceable&gt; milliseconds
        are counted and reported separately, as &lt;firstterm&gt;late&lt;/firstterm&gt;.
</span>
<em class="replaceable"><code>limit</code></em>ミリ秒以上続くトランザクションが計数され、別途<em class="firstterm">遅いトランザクション</em>として報告されます。
       </p><p>
<span class="original">
        When throttling is used (&lt;option&gt;&amp;#045;&amp;#045;rate=...&lt;/option&gt;), transactions that
        lag behind schedule by more than &lt;replaceable&gt;limit&lt;/replaceable&gt; ms, and thus
        have no hope of meeting the latency limit, are not sent to the server
        at all. They are counted and reported separately as
        &lt;firstterm&gt;skipped&lt;/firstterm&gt;.
</span>
制限が使用されると(<code class="option">--rate=...</code>)、<em class="replaceable"><code>limit</code></em>ミリ秒以上遅延がスケジュールされたトランザクションは遅延制限を満たす可能性がないため、サーバに送信されることは決してありません。
これらのトランザクションは計数され、別途<em class="firstterm">スキップされた</em>として報告されます。
       </p></dd><dt><span class="term"><code class="option">-M</code> <em class="replaceable"><code>querymode</code></em><br /></span><span class="term"><code class="option">--protocol=</code><em class="replaceable"><code>querymode</code></em></span></dt><dd><p>
<span class="original">
        Protocol to use for submitting queries to the server:
</span>
サーバへ問い合わせを送信するために使用するプロトコルです。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><span class="original">
            &lt;para&gt;&lt;literal&gt;simple&lt;/literal&gt;: use simple query protocol.&lt;/para&gt;
</span><p><code class="literal">simple</code>: 簡易問い合わせプロトコルを使用します。</p></li><li class="listitem"><span class="original">
            &lt;para&gt;&lt;literal&gt;extended&lt;/literal&gt;: use extended query protocol.&lt;/para&gt;
</span><p><code class="literal">extended</code>: 拡張問い合わせプロトコルを使用します。</p></li><li class="listitem"><span class="original">
            &lt;para&gt;&lt;literal&gt;prepared&lt;/literal&gt;: use extended query protocol with prepared statements.&lt;/para&gt;
</span><p><code class="literal">prepared</code>: プリペアドステートメントを伴う拡張問い合わせプロトコルを使用します。</p></li></ul></div><p>
<span class="original">
        The default is simple query protocol.  (See &lt;xref linkend="protocol"/&gt;
        for more information.)
</span>
デフォルトは簡易問い合わせプロトコルです。
（詳しい情報は<a class="xref" href="protocol.html" title="第53章 フロントエンド/バックエンドプロトコル">第53章</a>を参照してください）
       </p></dd><dt><span class="term"><code class="option">-n</code><br /></span><span class="term"><code class="option">--no-vacuum</code></span></dt><dd><p>
<span class="original">
        Perform no vacuuming before running the test.
        This option is &lt;emphasis&gt;necessary&lt;/emphasis&gt;
        if you are running a custom test scenario that does not include
        the standard tables &lt;structname&gt;pgbench_accounts&lt;/structname&gt;,
        &lt;structname&gt;pgbench_branches&lt;/structname&gt;, &lt;structname&gt;pgbench_history&lt;/structname&gt;, and
        &lt;structname&gt;pgbench_tellers&lt;/structname&gt;.
</span>
試験を実行する前にバキュームを行いません。
<code class="structname">pgbench_accounts</code>、<code class="structname">pgbench_branches</code>、<code class="structname">pgbench_history</code>、
<code class="structname">pgbench_tellers</code>標準テーブルを含まない独自試験シナリオを実行する場合、このオプションは<span class="emphasis"><em>必要</em></span>です。
       </p></dd><dt><span class="term"><code class="option">-N</code><br /></span><span class="term"><code class="option">--skip-some-updates</code></span></dt><dd><p>
<span class="original">
        Run built-in simple-update script.
        Shorthand for &lt;option&gt;-b simple-update&lt;/option&gt;.
</span>
組み込みのsimple-update（単純な更新）のスクリプトを実行します。
<code class="option">-b simple-update</code>の短縮形です。
       </p></dd><dt><span class="term"><code class="option">-P</code> <em class="replaceable"><code>sec</code></em><br /></span><span class="term"><code class="option">--progress=</code><em class="replaceable"><code>sec</code></em></span></dt><dd><p>
<span class="original">
        Show progress report every &lt;replaceable&gt;sec&lt;/replaceable&gt; seconds.  The report
        includes the time since the beginning of the run, the TPS since the
        last report, and the transaction latency average and standard
        deviation since the last report.  Under throttling (&lt;option&gt;-R&lt;/option&gt;),
        the latency is computed with respect to the transaction scheduled
        start time, not the actual transaction beginning time, thus it also
        includes the average schedule lag time.
</span>
<em class="replaceable"><code>sec</code></em>秒毎の進捗レポートを表示します。
レポートには起動からの経過時間、前回レポート時からのTPS、前回レポート時からのトランザクションの平均待ち時間、標準偏差を含んでいます。
(<code class="option">-R</code>)オプションによる制限下では、待ち時間はトランザクションの実開始時間ではなく、予定開始時間で算出されていますので、平均予定遅延時間が含まれています。
       </p></dd><dt><span class="term"><code class="option">-r</code><br /></span><span class="term"><code class="option">--report-latencies</code></span></dt><dd><p>
<span class="original">
        Report the average per-statement latency (execution time from the
        perspective of the client) of each command after the benchmark
        finishes.  See below for details.
</span>
ベンチマーク完了後の各コマンドにおけるステートメント毎の平均レイテンシ(クライアントから見た実行時間)を報告します。詳しくは下を参照してください。
       </p></dd><dt><span class="term"><code class="option">-R</code> <em class="replaceable"><code>rate</code></em><br /></span><span class="term"><code class="option">--rate=</code><em class="replaceable"><code>rate</code></em></span></dt><dd><p>
<span class="original">
        Execute transactions targeting the specified rate instead of running
        as fast as possible (the default).  The rate is given in transactions
        per second.  If the targeted rate is above the maximum possible rate,
        the rate limit won't impact the results.
</span>
トランザクションを可能な限り高速（デフォルト）で実行するのではなく、指定された目標レートで実行します。
レートは1秒あたりのトランザクション数で与えられます。目標レートが実施可能な最大レートを越えている場合、レート制限は結果に影響を与えません。
       </p><p>
<span class="original">
        The rate is targeted by starting transactions along a
        Poisson-distributed schedule time line.  The expected start time
        schedule moves forward based on when the client first started, not
        when the previous transaction ended.  That approach means that when
        transactions go past their original scheduled end time, it is
        possible for later ones to catch up again.
</span>
レートはトランザクションの開始予定タイムラインがポアソン分布に沿う事を目標としています。
期待される開始時刻の予定は、前トランザクションの終了時ではなくクライアントの初期起動時に基づいて動かします。
このアプローチはトランザクションがオリジナルの終了予定時刻を過ぎた場合でも、後でまた追い付けることを意味します。
       </p><p>
<span class="original">
        When throttling is active, the transaction latency reported at the
        end of the run is calculated from the scheduled start times, so it
        includes the time each transaction had to wait for the previous
        transaction to finish. The wait time is called the schedule lag time,
        and its average and maximum are also reported separately. The
        transaction latency with respect to the actual transaction start time,
        i.e. the time spent executing the transaction in the database, can be
        computed by subtracting the schedule lag time from the reported
        latency.
</span>
制限がアクティブになると、実行終了時に報告されるトランザクション待ち時間は、予定開始時刻から計算されるので、
各トランザクションが前トランザクションの終了を待たねばならなかった時間を含んでいます。
この待ち時間はスケジュールラグタイムと呼ばれ、平均と最大値も別々に報告されます。
実トランザクション開始時刻についてのトランザクション待ち時間、つまりデータベース内でトランザクションの実行に要した時間は、報告された待ち時間からスケジュールラグタイムを減算することで算出することができます。
       </p><p>
<span class="original">
        If &lt;option&gt;#045;&amp;#045;latency-limit&lt;/option&gt; is used together with &lt;option&gt;#045;&amp;#045;rate&lt;/option&gt;,
        a transaction can lag behind so much that it is already over the
        latency limit when the previous transaction ends, because the latency
        is calculated from the scheduled start time. Such transactions are
        not sent to the server, but are skipped altogether and counted
        separately.
</span>
<code class="option">--latency-limit</code>が<code class="option">--rate</code>と一緒に指定された場合、トランザクションは、先行するトランザクションが終了した際にすでに遅延制限を超えていて、非常に遅れてしまうことがあり得ます。
そのようなトランザクションはサーバに送信さることなくスキップされ、別途カウントされます。
       </p><p>
<span class="original">
        A high schedule lag time is an indication that the system cannot
        process transactions at the specified rate, with the chosen number of
        clients and threads. When the average transaction execution time is
        longer than the scheduled interval between each transaction, each
        successive transaction will fall further behind, and the schedule lag
        time will keep increasing the longer the test run is. When that
        happens, you will have to reduce the specified transaction rate.
</span>
スケジュールラグタイムの高い値は、システムが選択されたクライアント数とスレッド数で、指定されたレートでトランザクションを処理できなかったことを示しています。
トランザクションの平均実行時間が各トランザクション間で予定されていた間隔より長い場合、各逐次トランザクションは更に遅くなり、
スケジュールラグタイムはテスト実行がより長く増加し続けます。
これが起こる場合、指定トランザクションレートを減らす必要があります。
       </p></dd><dt><span class="term"><code class="option">-s</code> <em class="replaceable"><code>scale_factor</code></em><br /></span><span class="term"><code class="option">--scale=</code><em class="replaceable"><code>scale_factor</code></em></span></dt><dd><p>
<span class="original">
        Report the specified scale factor in &lt;application&gt;pgbench&lt;/application&gt;'s
        output.  With the built-in tests, this is not necessary; the
        correct scale factor will be detected by counting the number of
        rows in the &lt;structname&gt;pgbench_branches&lt;/structname&gt; table.
        However, when testing only custom benchmarks (&lt;option&gt;-f&lt;/option&gt; option),
        the scale factor will be reported as 1 unless this option is used.
</span>
<span class="application">pgbench</span>の出力で指定した倍率を報告します。
これは組み込みの試験では必要ありません。
正確な倍率が<code class="structname">pgbench_branches</code>テーブルの行数を数えることで検出されます。
しかし、独自ベンチマーク（<code class="option">-f</code>オプション）のみを試験している場合、このオプションを使用しない限り、倍率は1として報告されます。
       </p></dd><dt><span class="term"><code class="option">-S</code><br /></span><span class="term"><code class="option">--select-only</code></span></dt><dd><p>
<span class="original">
        Run built-in select-only script.
        Shorthand for &lt;option&gt;-b select-only&lt;/option&gt;.
</span>
組み込みのselect-only（SELECTのみ）のスクリプトを実行します。
<code class="option">-b select-only</code>の短縮形です。
       </p></dd><dt><span class="term"><code class="option">-t</code> <em class="replaceable"><code>transactions</code></em><br /></span><span class="term"><code class="option">--transactions=</code><em class="replaceable"><code>transactions</code></em></span></dt><dd><p>
<span class="original">
        Number of transactions each client runs.  Default is 10.
</span>
各クライアントが実行するトランザクション数です。
デフォルトは10です。
       </p></dd><dt><span class="term"><code class="option">-T</code> <em class="replaceable"><code>seconds</code></em><br /></span><span class="term"><code class="option">--time=</code><em class="replaceable"><code>seconds</code></em></span></dt><dd><p>
<span class="original">
        Run the test for this many seconds, rather than a fixed number of
        transactions per client. &lt;option&gt;-t&lt;/option&gt; and
        &lt;option&gt;-T&lt;/option&gt; are mutually exclusive.
</span>
クライアントあたりのトランザクション数を固定で指定するよりも長くテストを実行したい場合、ここに指定した秒数でテストを実行します。
<code class="option">-t</code>と<code class="option">-T</code>は互いに排他的です。
       </p></dd><dt><span class="term"><code class="option">-v</code><br /></span><span class="term"><code class="option">--vacuum-all</code></span></dt><dd><p>
<span class="original">
        Vacuum all four standard tables before running the test.
        With neither &lt;option&gt;-n&lt;/option&gt; nor &lt;option&gt;-v&lt;/option&gt;, &lt;application&gt;pgbench&lt;/application&gt; will vacuum the
        &lt;structname&gt;pgbench_tellers&lt;/structname&gt; and &lt;structname&gt;pgbench_branches&lt;/structname&gt;
        tables, and will truncate &lt;structname&gt;pgbench_history&lt;/structname&gt;.
</span>
試験前に4つの標準テーブルすべてをバキュームします。
<code class="option">-n</code>も<code class="option">-v</code>もなければ、pgbenchは<code class="structname">pgbench_tellers</code>と<code class="structname">pgbench_branches</code>テーブルをバキュームし、<code class="structname">pgbench_history</code>内のデータをすべて消去します。
       </p></dd><dt><span class="term"><code class="option">--aggregate-interval=<em class="replaceable"><code>seconds</code></em></code></span></dt><dd><p>
<span class="original">
        Length of aggregation interval (in seconds).  May be used only
        with &lt;option&gt;-l&lt;/option&gt; option.  With this option, the log contains
        per-interval summary data, as described below.
</span>
集約間隔の長さ（秒単位）です。
これは<span class="application">-l</span>と一緒でのみ使用できます。
このオプションを付けると、ログには以下で説明するような指定間隔単位の要約が含まれます。
       </p></dd><dt><span class="term"><code class="option">--log-prefix=<em class="replaceable"><code>prefix</code></em></code></span></dt><dd><p>
<span class="original">
        Set the filename prefix for the log files created by
        &lt;option&gt;&amp;#045;&amp;#045;log&lt;/option&gt;.  The default is &lt;literal&gt;pgbench_log&lt;/literal&gt;.
</span>
<code class="option">--log</code>により作成されるログファイルのファイル名の先頭につける文字列を設定します。
デフォルトは<code class="literal">pgbench_log</code>です。
       </p></dd><dt><span class="term"><code class="option">--progress-timestamp</code></span></dt><dd><p>
<span class="original">
        When showing progress (option &lt;option&gt;-P&lt;/option&gt;), use a timestamp
        (Unix epoch) instead of the number of seconds since the
        beginning of the run.  The unit is in seconds, with millisecond
        precision after the dot.
        This helps compare logs generated by various tools.
</span>
進捗を表示（<code class="option">-P</code>オプション）しているとき、実行開始以後の経過秒数の代わりにタイムスタンプ（Unixエポック時刻）を使用します。
単位は秒で、ドットの後にミリ秒の精度が付きます。
これは様々なツールで生成されたログを比較するのに役立つでしょう。
       </p></dd><dt><span class="term"><code class="option">--random-seed=</code><em class="replaceable"><code>SEED</code></em></span></dt><dd><p>
<span class="original">
        Set random generator seed.  Seeds the system random number generator,
        which then produces a sequence of initial generator states, one for
        each thread.
        Values for &lt;replaceable&gt;SEED&lt;/replaceable&gt; may be:
        &lt;literal&gt;time&lt;/literal&gt; (the default, the seed is based on the current time),
        &lt;literal&gt;rand&lt;/literal&gt; (use a strong random source, failing if none
        is available), or an unsigned decimal integer value.
        The random generator is invoked explicitly from a pgbench script
        (&lt;literal&gt;random...&lt;/literal&gt; functions) or implicitly (for instance option
        &lt;option&gt;-&amp;#045;rate&lt;/option&gt; uses it to schedule transactions).
        When explicitly set, the value used for seeding is shown on the terminal.
        Any value allowed for &lt;replaceable&gt;SEED&lt;/replaceable&gt; may also be
        provided through the environment variable
        &lt;literal&gt;PGBENCH_RANDOM_SEED&lt;/literal&gt;.
        To ensure that the provided seed impacts all possible uses, put this option
        first or use the environment variable.
</span>
ランダムジェネレータのシードを設定します。
各スレッド毎の初期ジェネレータ状態から一連の値を生成する、システム乱数ジェネレータの種となります。
<em class="replaceable"><code>SEED</code></em>の値は以下が可能です。
<code class="literal">time</code>（デフォルト、現在時刻に基づくシード）、<code class="literal">rand</code>（強いランダムソースを使用、使用できなければ失敗します）、あるいは符号無し整数値です。
ランダムジェネレータはpgbenchスクリプト（<code class="literal">random...</code>関数）から明示的に、あるいは暗黙に（例えばオプション<code class="option">--rate</code>がトランザクションのスケジュールに使用します）、実行されます。
明示的に設定した場合、シードに使われる値はターミナルにあらわれます。
<em class="replaceable"><code>SEED</code></em>に与えることのできる値は何であれ、環境変数<code class="literal">PGBENCH_RANDOM_SEED</code>を通して付与しても良いです。
設定したシードがありうる全ての実行に影響を及ぼすようにするためには、本オプションを最初に置くか、環境変数を使ってください。
      </p><p>
<span class="original">
        Setting the seed explicitly allows to reproduce a &lt;command&gt;pgbench&lt;/command&gt;
        run exactly, as far as random numbers are concerned.
        As the random state is managed per thread, this means the exact same
        &lt;command&gt;pgbench&lt;/command&gt; run for an identical invocation if there is one
        client per thread and there are no external or data dependencies.
        From a statistical viewpoint reproducing runs exactly is a bad idea because
        it can hide the performance variability or improve performance unduly,
        e.g. by hitting the same pages as a previous run.
        However, it may also be of great help for debugging, for instance
        re-running a tricky case which leads to an error.
        Use wisely.
</span>
明示的にシードを設定することは、乱数に関しては、正確に<code class="command">pgbench</code>実行を再現することを可能にします。
ランダム状態はスレッド毎に制御されているので、スレッド毎に一つのクライアントであり、外的な依存やデータ依存が無い場合、同一の起動に対して正確に同じ<code class="command">pgbench</code>実行することを意味します。
統計的観点からは、性能のばらつきを隠したり、例えば前回実行と同じページにヒットすることで不当に性能改善するので、正確な再現実行は悪い考えです。
しかしながら、例えばエラーを起こすトリッキーなケースを再実行するなど、デバッグには大きな助けとなるでしょう。
賢く使ってください。
       </p></dd><dt><span class="term"><code class="option">--sampling-rate=<em class="replaceable"><code>rate</code></em></code></span></dt><dd><p>
<span class="original">
        Sampling rate, used when writing data into the log, to reduce the
        amount of log generated. If this option is given, only the specified
        fraction of transactions are logged. 1.0 means all transactions will
        be logged, 0.05 means only 5% of the transactions will be logged.
</span>
データをログに書き出す際に使用される、生成されるログの量を減少するためのサンプリング割合です。
このオプションが指定された場合、指定された割合のトランザクションがログに残ります。
1.0はすべてのトランザクションが、0.05はトランザクションの5%のみがログに残ることを意味します。
       </p><p>
<span class="original">
        Remember to take the sampling rate into account when processing the
        log file. For example, when computing TPS values, you need to multiply
        the numbers accordingly (e.g. with 0.01 sample rate, you'll only get
        1/100 of the actual TPS).
</span>
ログファイルを処理する際にはこのサンプリング割合を考慮することを忘れないでください。
例えば、TPS値を計算する際には、比例した数を掛け合わせなければなりません（例：サンプリング割合が0.01の場合実際のTPSの1/100を得るだけです。）
       </p></dd></dl></div><p>
   </p></div><div class="refsect2" id="PGBENCH-COMMON-OPTIONS"><h3>共通オプション</h3><span class="original">
  &lt;title&gt;Common Options&lt;/title&gt;
</span><p>
<span class="original">
    &lt;application&gt;pgbench&lt;/application&gt; accepts the following command-line
    common arguments:
</span>
<span class="application">pgbench</span>は以下の共通コマンドライン引数を受け付けます。

    </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-h</code> <em class="replaceable"><code>hostname</code></em><br /></span><span class="term"><code class="option">--host=</code><em class="replaceable"><code>hostname</code></em></span></dt><dd><p>
<span class="original">
        The database server's host name
</span>
      データベースサーバのホスト名
       </p></dd><dt><span class="term"><code class="option">-p</code> <em class="replaceable"><code>port</code></em><br /></span><span class="term"><code class="option">--port=</code><em class="replaceable"><code>port</code></em></span></dt><dd><p>
<span class="original">
        The database server's port number
</span>
データベースサーバのポート番号
       </p></dd><dt><span class="term"><code class="option">-U</code> <em class="replaceable"><code>login</code></em><br /></span><span class="term"><code class="option">--username=</code><em class="replaceable"><code>login</code></em></span></dt><dd><p>
<span class="original">
        The user name to connect as
</span>
      接続ユーザ名
       </p></dd><dt><span class="term"><code class="option">-V</code><br /></span><span class="term"><code class="option">--version</code></span></dt><dd><p>
<span class="original">
        Print the &lt;application&gt;pgbench&lt;/application&gt; version and exit.
</span>
<span class="application">pgbench</span>のバージョンを表示し、終了します。
       </p></dd><dt><span class="term"><code class="option">-?</code><br /></span><span class="term"><code class="option">--help</code></span></dt><dd><p>
<span class="original">
        Show help about &lt;application&gt;pgbench&lt;/application&gt; command line
        arguments, and exit.
</span>
<span class="application">pgbench</span>のコマンドライン引数の説明を表示し、終了します。
       </p></dd></dl></div><p>
   </p></div></div><div class="refsect1" id="id-1.9.4.10.7"><h2>注釈</h2><span class="original">
  &lt;title&gt;Notes&lt;/title&gt;
</span><div class="refsect2" id="id-1.9.4.10.7.2"><h3><span class="application">pgbench</span>で実際に実行される<span class="quote">「<span class="quote">トランザクション</span>」</span>は何か?</h3><span class="original">
  &lt;title&gt;What is the &lt;quote&gt;Transaction&lt;/quote&gt; Actually Performed in &lt;application&gt;pgbench&lt;/application&gt;?&lt;/title&gt;
</span><p>
<span class="original">
   &lt;application&gt;pgbench&lt;/application&gt; executes test scripts chosen randomly
   from a specified list.
   They include built-in scripts with &lt;option&gt;-b&lt;/option&gt; and
   user-provided custom scripts with &lt;option&gt;-f&lt;/option&gt;.
   Each script may be given a relative weight specified after a
   &lt;literal&gt;@&lt;/literal&gt; so as to change its drawing probability.
   The default weight is &lt;literal&gt;1&lt;/literal&gt;.
   Scripts with a weight of &lt;literal&gt;0&lt;/literal&gt; are ignored.
</span>
<span class="application">pgbench</span>は指定したリストからランダムに選択したテストスクリプトを実行します。
これには<code class="option">-b</code>の組み込みスクリプトと<code class="option">-f</code>のユーザ定義カスタムスクリプトが含まれます。
各スクリプトには<code class="literal">@</code>の後に指定される相対的な重みを与えることができ、それが選ばれる確率を変更することができます。
デフォルトの重みは<code class="literal">1</code>です。
重みが<code class="literal">0</code>のスクリプトは無視されます。
 </p><p>
<span class="original">
   The default built-in transaction script (also invoked with &lt;option&gt;-b tpcb-like&lt;/option&gt;)
   issues seven commands per transaction over randomly chosen &lt;literal&gt;aid&lt;/literal&gt;,
   &lt;literal&gt;tid&lt;/literal&gt;, &lt;literal&gt;bid&lt;/literal&gt; and &lt;literal&gt;balance&lt;/literal&gt;.
   The scenario is inspired by the TPC-B benchmark, but is not actually TPC-B,
   hence the name.
</span>
デフォルトの組み込みトランザクションスクリプト（<code class="option">-b tpcb-like</code>とすることでも実行されます）は、<code class="literal">aid</code>、<code class="literal">tid</code>、<code class="literal">bid</code>、<code class="literal">balance</code>からランダムに選択され、トランザクション毎に7つのコマンドを発行します。
このシナリオはTPC-Bベンチマークに示唆を受けたものですが、実際にはTPC-Bではないので、この名前になっています。
  </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p><code class="literal">BEGIN;</code></p></li><li class="listitem"><p><code class="literal">UPDATE pgbench_accounts SET abalance = abalance + :delta WHERE aid = :aid;</code></p></li><li class="listitem"><p><code class="literal">SELECT abalance FROM pgbench_accounts WHERE aid = :aid;</code></p></li><li class="listitem"><p><code class="literal">UPDATE pgbench_tellers SET tbalance = tbalance + :delta WHERE tid = :tid;</code></p></li><li class="listitem"><p><code class="literal">UPDATE pgbench_branches SET bbalance = bbalance + :delta WHERE bid = :bid;</code></p></li><li class="listitem"><p><code class="literal">INSERT INTO pgbench_history (tid, bid, aid, delta, mtime) VALUES (:tid, :bid, :aid, :delta, CURRENT_TIMESTAMP);</code></p></li><li class="listitem"><p><code class="literal">END;</code></p></li></ol></div><p>
<span class="original">
   If you select the &lt;literal&gt;simple-update&lt;/literal&gt; built-in (also &lt;option&gt;-N&lt;/option&gt;),
   steps 4 and 5 aren't included in the transaction.
   This will avoid update contention on these tables, but
   it makes the test case even less like TPC-B.
</span>
<code class="literal">simple-update</code>の組み込みを選択した（あるいは<code class="option">-N</code>を指定した）場合、第4ステップと第5ステップはトランザクションに含まれません。
これにより、これらのテーブルに対する更新の競合を避けられますが、テストケースはさらにTPC-Bらしくなくなります。
  </p><p>
<span class="original">
   If you select the &lt;literal&gt;select-only&lt;/literal&gt; built-in (also &lt;option&gt;-S&lt;/option&gt;),
   only the &lt;command&gt;SELECT&lt;/command&gt; is issued.
</span>
<code class="literal">select-only</code>の組み込みを選択した（あるいは<code class="option">-S</code>を指定した）場合、<code class="command">SELECT</code>のみが発行されます。
  </p></div><div class="refsect2" id="id-1.9.4.10.7.3"><h3>独自スクリプト</h3><span class="original">
  &lt;title&gt;Custom Scripts&lt;/title&gt;
</span><p>
<span class="original">
   &lt;application&gt;pgbench&lt;/application&gt; has support for running custom
   benchmark scenarios by replacing the default transaction script
   (described above) with a transaction script read from a file
   (&lt;option&gt;-f&lt;/option&gt; option).  In this case a &lt;quote&gt;transaction&lt;/quote&gt;
   counts as one execution of a script file.
</span>
<span class="application">pgbench</span>は、ファイルから読み込んだトランザクションスクリプト（<code class="option">-f</code>オプション）でデフォルトのトランザクションスクリプト（上述）を置き換えて独自のベンチマークシナリオを実行する機能をサポートします。
この場合、<span class="quote">「<span class="quote">トランザクション</span>」</span>はスクリプトファイルの1回の実行として数えられます。
  </p><p>
<span class="original">
   A script file contains one or more SQL commands terminated by
   semicolons.  Empty lines and lines beginning with
   &lt;literal&gt;&amp;#045;&amp;#045;&lt;/literal&gt; are ignored.  Script files can also contain
   &lt;quote&gt;meta commands&lt;/quote&gt;, which are interpreted by &lt;application&gt;pgbench&lt;/application&gt;
   itself, as described below.
</span>
スクリプトファイルにはセミコロンで終了するSQLコマンドが1つ以上含まれます。
空行および<code class="literal">--</code>から始まる行は無視されます。
スクリプトファイルの行には、<span class="application">pgbench</span>自身が解釈する<span class="quote">「<span class="quote">メタコマンド</span>」</span>（後述）も記述することができます。
  </p><div class="note"><h3 class="title">注記</h3><p>
<span class="original">
    Before &lt;productname&gt;PostgreSQL&lt;/productname&gt; 9.6, SQL commands in script files
    were terminated by newlines, and so they could not be continued across
    lines.  Now a semicolon is &lt;emphasis&gt;required&lt;/emphasis&gt; to separate consecutive
    SQL commands (though a SQL command does not need one if it is followed
    by a meta command).  If you need to create a script file that works with
    both old and new versions of &lt;application&gt;pgbench&lt;/application&gt;, be sure to write
    each SQL command on a single line ending with a semicolon.
</span>
<span class="productname">PostgreSQL</span>の9.6より前では、スクリプトファイル内のSQLコマンドは改行で終了しており、そのため行をまたがって継続することができませんでした。
これからは連続するSQLコマンドを区切るためにセミコロンが<span class="emphasis"><em>必要</em></span>です（ただし、SQLコマンドの後にメタコマンドが続く場合は、セミコロンは必要ありません）。
<span class="application">pgbench</span>の古いバージョンと新しいバージョンの両方で動作するスクリプトを作る必要があるなら、各SQLコマンドを1行で書き、終わりにセミコロンを付けるようにしてください。
   </p></div><p>
<span class="original">
   There is a simple variable-substitution facility for script files.
   Variable names must consist of letters (including non-Latin letters),
   digits, and underscores.
   Variables can be set by the command-line &lt;option&gt;-D&lt;/option&gt; option,
   explained above, or by the meta commands explained below.
   In addition to any variables preset by &lt;option&gt;-D&lt;/option&gt; command-line options,
   there are a few variables that are preset automatically, listed in
   &lt;xref linkend="pgbench-automatic-variables"/&gt;. A value specified for these
   variables using &lt;option&gt;-D&lt;/option&gt; takes precedence over the automatic presets.
   Once set, a variable's
   value can be inserted into a SQL command by writing
   &lt;literal&gt;:&lt;/literal&gt;&lt;replaceable&gt;variablename&lt;/replaceable&gt;.  When running more than
   one client session, each session has its own set of variables.
</span>
スクリプトファイル向けの簡単な変数置換機能があります。
変数名は文字（非ラテン文字を含む）、数字およびアンダースコアで構成されていなければなりません。
上で説明したように変数を<code class="option">-D</code>コマンドラインオプションで設定することができます。
また、後で説明するようにメタコマンドで設定することもできます。
<code class="option">-D</code>コマンドラインオプションで設定された変数の他に、<a class="xref" href="pgbench.html#PGBENCH-AUTOMATIC-VARIABLES" title="表241 自動変数">表 241</a>に記載されているように、自動的に設定される変数がいくつかあります。
<code class="option">-D</code> を使ってこれらの変数に設定された値は、自動設定の値より優先されます。
一度設定すると、変数の値は、<code class="literal">:</code><em class="replaceable"><code>variablename</code></em>と書かれてSQLコマンドに挿入されます。
1つ以上のクライアントセッションが実行される場合、セッション毎に独自の変数群を持ちます。
  </p><div class="table" id="PGBENCH-AUTOMATIC-VARIABLES"><p class="title"><strong>表241 自動変数</strong></p><div class="table-contents"><span class="original">
    &lt;title&gt;Automatic Variables&lt;/title&gt;
</span><table class="table" summary="自動変数" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>変数</th><th>説明</th></tr></thead><tbody><tr><td> <code class="literal">client_id</code> </td><td>クライアントセッションを識別する一意の数値（ゼロから始まる）</td></tr><tr><td> <code class="literal">default_seed</code> </td><td>デフォルトでハッシュ関数で使われるシード</td></tr><tr><td> <code class="literal">random_seed</code> </td><td>ランダムジェネレータのシード（<code class="option">-D</code>で上書きされていないなら）</td></tr><tr><td> <code class="literal">scale</code> </td><td>現在のスケールファクタ</td></tr></tbody></table></div></div><br class="table-break" /><p>
<span class="original">
   Script file meta commands begin with a backslash (&lt;literal&gt;\&lt;/literal&gt;) and
   normally extend to the end of the line, although they can be continued
   to additional lines by writing backslash-return.
   Arguments to a meta command are separated by white space.
   These meta commands are supported:
</span>
スクリプトファイルのメタコマンドはバックスラッシュ（<code class="literal">\</code>）から始まり、通常は行末まで続きますが、バックスラッシュと改行を書くことで、追加の行に続けることができます。
メタコマンドへの引数は空白文字で区切られます。
以下のメタコマンドがサポートされています。
  </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">\if</code> <em class="replaceable"><code>expression</code></em><br /></span><span class="term"><code class="literal">\elif</code> <em class="replaceable"><code>expression</code></em><br /></span><span class="term"><code class="literal">\else</code><br /></span><span class="term"><code class="literal">\endif</code></span></dt><dd><p>
<span class="original">
      This group of commands implements nestable conditional blocks,
      similarly to &lt;literal&gt;psql&lt;/literal&gt;'s &lt;xref linkend="psql-metacommand-if"/&gt;.
      Conditional expressions are identical to those with &lt;literal&gt;\set&lt;/literal&gt;,
      with non-zero values interpreted as true.
</span>
このコマンド群は<code class="literal">psql</code>の<a class="xref" href="app-psql.html#PSQL-METACOMMAND-IF"><code class="literal">\if</code> <em class="replaceable"><code>expression</code></em></a>と似た、入れ子にできる条件ブロックを実現します。
条件式は<code class="literal">\set</code>と同じで、非ゼロ値は真と解釈されます。
     </p></dd><dt id="PGBENCH-METACOMMAND-SET"><span class="term">
     <code class="literal">\set <em class="replaceable"><code>varname</code></em> <em class="replaceable"><code>expression</code></em></code>
    </span></dt><dd><p>
<span class="original">
      Sets variable &lt;replaceable&gt;varname&lt;/replaceable&gt; to a value calculated
      from &lt;replaceable&gt;expression&lt;/replaceable&gt;.
      The expression may contain the &lt;literal&gt;NULL&lt;/literal&gt; constant,
      Boolean constants &lt;literal&gt;TRUE&lt;/literal&gt; and &lt;literal&gt;FALSE&lt;/literal&gt;,
      integer constants such as &lt;literal&gt;5432&lt;/literal&gt;,
      double constants such as &lt;literal&gt;3.14159&lt;/literal&gt;,
      references to variables &lt;literal&gt;:&lt;/literal&gt;&lt;replaceable&gt;variablename&lt;/replaceable&gt;,
      &lt;link linkend="pgbench-builtin-operators"&gt;operators&lt;/link&gt;
      with their usual SQL precedence and associativity,
      &lt;link linkend="pgbench-builtin-functions"&gt;function calls&lt;/link&gt;,
      SQL &lt;link linkend="functions-case"&gt;&lt;token&gt;CASE&lt;/token&gt; generic conditional
      expressions&lt;/link&gt; and parentheses.
</span>
<em class="replaceable"><code>varname</code></em>変数を<em class="replaceable"><code>expression</code></em>から計算された値に設定します。
式（expression）には、<code class="literal">NULL</code>定数、真理値定数の<code class="literal">TRUE</code>と<code class="literal">FALSE</code>、<code class="literal">5432</code>のような整数の定数、<code class="literal">3.14159</code>のような倍精度実数の定数、変数を参照する <code class="literal">:</code><em class="replaceable"><code>variablename</code></em>、通常のSQLの優先度と結合規則での<a class="link" href="pgbench.html#PGBENCH-BUILTIN-OPERATORS" title="組み込み演算子">演算子</a>、<a class="link" href="pgbench.html#PGBENCH-BUILTIN-FUNCTIONS" title="組み込み関数">関数呼び出し</a>、SQLの<a class="link" href="functions-conditional.html#FUNCTIONS-CASE" title="9.17.1. CASE"><code class="token">CASE</code>一般条件式</a>および括弧を含むことができます。
     </p><p>
<span class="original">
      Functions and most operators return &lt;literal&gt;NULL&lt;/literal&gt; on
      &lt;literal&gt;NULL&lt;/literal&gt; input.
</span>
関数と大部分の演算子は<code class="literal">NULL</code>入力に<code class="literal">NULL</code>を返します。
     </p><p>
<span class="original">
      For conditional purposes, non zero numerical values are
      &lt;literal&gt;TRUE&lt;/literal&gt;, zero numerical values and &lt;literal&gt;NULL&lt;/literal&gt;
      are &lt;literal&gt;FALSE&lt;/literal&gt;.
</span>
条件の用途では非ゼロの数値は<code class="literal">TRUE</code>、ゼロ数値と<code class="literal">NULL</code>は<code class="literal">FALSE</code>です。
     </p><p>
<span class="original">
      When no final &lt;token&gt;ELSE&lt;/token&gt; clause is provided to a
      &lt;token&gt;CASE&lt;/token&gt;, the default value is &lt;literal&gt;NULL&lt;/literal&gt;.
</span>
<code class="token">CASE</code>に最後の<code class="token">ELSE</code>句が与えられないとき、デフォルト値は<code class="literal">NULL</code>です。
     </p><p>
<span class="original">
      Examples:
</span>
例
</p><pre class="programlisting">
\set ntellers 10 * :scale
\set aid (1021 * random(1, 100000 * :scale)) % \
           (100000 * :scale) + 1
\set divx CASE WHEN :x &lt;&gt; 0 THEN :y/:x ELSE NULL END
</pre></dd><dt><span class="term">
     <code class="literal">\sleep <em class="replaceable"><code>number</code></em> [ us | ms | s ]</code>
    </span></dt><dd><p>
<span class="original">
      Causes script execution to sleep for the specified duration in
      microseconds (&lt;literal&gt;us&lt;/literal&gt;), milliseconds (&lt;literal&gt;ms&lt;/literal&gt;) or seconds
      (&lt;literal&gt;s&lt;/literal&gt;).  If the unit is omitted then seconds are the default.
      &lt;replaceable&gt;number&lt;/replaceable&gt; can be either an integer constant or a
      &lt;literal&gt;:&lt;/literal&gt;&lt;replaceable&gt;variablename&lt;/replaceable&gt; reference to a variable
      having an integer value.
</span>
スクリプトの実行をマイクロ秒（<code class="literal">us</code>）、ミリ秒（<code class="literal">ms</code>）、秒（<code class="literal">s</code>）単位で指定した間待機させます。
単位を省略した場合、デフォルトは秒です。
<em class="replaceable"><code>number</code></em>は整数定数か整数値を持つ変数への<code class="literal">:</code><em class="replaceable"><code>variablename</code></em>参照のいずれかです。
     </p><p>
<span class="original">
      Example:
</span>
例
</p><pre class="programlisting">
\sleep 10 ms
</pre></dd><dt><span class="term">
     <code class="literal">\setshell <em class="replaceable"><code>varname</code></em> <em class="replaceable"><code>command</code></em> [ <em class="replaceable"><code>argument</code></em> ... ]</code>
    </span></dt><dd><p>
<span class="original">
      Sets variable &lt;replaceable&gt;varname&lt;/replaceable&gt; to the result of the shell command
      &lt;replaceable&gt;command&lt;/replaceable&gt; with the given &lt;replaceable&gt;argument&lt;/replaceable&gt;(s).
      The command must return an integer value through its standard output.
</span>
<em class="replaceable"><code>command</code></em>シェルコマンドを指定の<em class="replaceable"><code>argument</code></em>で実行した結果を<em class="replaceable"><code>varname</code></em>変数に設定します。
このコマンドは標準出力を通して整数値を返さなければなりません。
     </p><p>
<span class="original">
      &lt;replaceable&gt;command&lt;/replaceable&gt; and each &lt;replaceable&gt;argument&lt;/replaceable&gt; can be either
      a text constant or a &lt;literal&gt;:&lt;/literal&gt;&lt;replaceable&gt;variablename&lt;/replaceable&gt; reference
      to a variable. If you want to use an &lt;replaceable&gt;argument&lt;/replaceable&gt; starting
      with a colon, write an additional colon at the beginning of
      &lt;replaceable&gt;argument&lt;/replaceable&gt;.
</span>
<em class="replaceable"><code>command</code></em>および各<em class="replaceable"><code>argument</code></em>は、テキスト定数または変数を参照する<code class="literal">:</code><em class="replaceable"><code>variablename</code></em>とすることができます。
コロンから始まる<em class="replaceable"><code>argument</code></em>を使用したい場合、<em class="replaceable"><code>argument</code></em>の先頭にさらにコロンを付けなければなりません。
     </p><p>
<span class="original">
      Example:
</span>
例:
</p><pre class="programlisting">
\setshell variable_to_be_assigned command literal_argument :variable ::literal_starting_with_colon
</pre></dd><dt><span class="term">
     <code class="literal">\shell <em class="replaceable"><code>command</code></em> [ <em class="replaceable"><code>argument</code></em> ... ]</code>
    </span></dt><dd><p>
<span class="original">
      Same as &lt;literal&gt;\setshell&lt;/literal&gt;, but the result of the command
      is discarded.
</span>
<code class="literal">\setshell</code>と同じですが、コマンドの結果は廃棄されます。
     </p><p>
<span class="original">
      Example:
</span>
例:
</p><pre class="programlisting">
\shell command literal_argument :variable ::literal_starting_with_colon
</pre></dd></dl></div></div><div class="refsect2" id="PGBENCH-BUILTIN-OPERATORS"><h3>組み込み演算子</h3><span class="original">
  &lt;title&gt;Built-In Operators&lt;/title&gt;
</span><p>
<span class="original">
   The arithmetic, bitwise, comparison and logical operators listed in
   &lt;xref linkend="pgbench-operators"/&gt; are built into &lt;application&gt;pgbench&lt;/application&gt;
   and may be used in expressions appearing in
   &lt;link linkend="pgbench-metacommand-set"&gt;&lt;literal&gt;\set&lt;/literal&gt;&lt;/link&gt;.
</span>
<a class="xref" href="pgbench.html#PGBENCH-OPERATORS" title="表242 pgbenchの演算子（優先度が低い順）">表 242</a>に載っている算術、ビットごと、比較、論理の演算子は<span class="application">pgbench</span>に組み込まれていて、<a class="link" href="pgbench.html#PGBENCH-METACOMMAND-SET"><code class="literal">\set</code></a>の式で使用することができます。
  </p><div class="table" id="PGBENCH-OPERATORS"><p class="title"><strong>表242 pgbenchの演算子（優先度が低い順）</strong></p><div class="table-contents"><span class="original">
   &lt;title&gt;pgbench Operators by increasing precedence&lt;/title&gt;
</span><table class="table" summary="pgbenchの演算子（優先度が低い順）" border="1"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th>演算子</th><th>説明</th><th>例</th><th>結果</th></tr></thead><tbody><tr><td><code class="literal">OR</code></td><td>論理or</td><td><code class="literal">5 or 0</code></td><td><code class="literal">TRUE</code></td></tr><tr><td><code class="literal">AND</code></td><td>論理and</td><td><code class="literal">3 and 0</code></td><td><code class="literal">FALSE</code></td></tr><tr><td><code class="literal">NOT</code></td><td>論理not</td><td><code class="literal">not false</code></td><td><code class="literal">TRUE</code></td></tr><tr><td><code class="literal">IS [NOT] (NULL|TRUE|FALSE)</code></td><td>値のテスト</td><td><code class="literal">1 is null</code></td><td><code class="literal">FALSE</code></td></tr><tr><td><code class="literal">ISNULL|NOTNULL</code></td><td>NULLテスト</td><td><code class="literal">1 notnull</code></td><td><code class="literal">TRUE</code></td></tr><tr><td><code class="literal">=</code></td><td>等価</td><td><code class="literal">5 = 4</code></td><td><code class="literal">FALSE</code></td></tr><tr><td><code class="literal">&lt;&gt;</code></td><td>不等</td><td><code class="literal">5 &lt;&gt; 4</code></td><td><code class="literal">TRUE</code></td></tr><tr><td><code class="literal">!=</code></td><td>不等</td><td><code class="literal">5 != 5</code></td><td><code class="literal">FALSE</code></td></tr><tr><td><code class="literal">&lt;</code></td><td>より小さい</td><td><code class="literal">5 &lt; 4</code></td><td><code class="literal">FALSE</code></td></tr><tr><td><code class="literal">&lt;=</code></td><td>以下</td><td><code class="literal">5 &lt;= 4</code></td><td><code class="literal">FALSE</code></td></tr><tr><td><code class="literal">&gt;</code></td><td>より大きい</td><td><code class="literal">5 &gt; 4</code></td><td><code class="literal">TRUE</code></td></tr><tr><td><code class="literal">&gt;=</code></td><td>以上</td><td><code class="literal">5 &gt;= 4</code></td><td><code class="literal">TRUE</code></td></tr><tr><td><code class="literal">|</code></td><td>整数のビット毎OR</td><td><code class="literal">1 | 2</code></td><td><code class="literal">3</code></td></tr><tr><td><code class="literal">#</code></td><td>整数のビット毎XOR</td><td><code class="literal">1 # 3</code></td><td><code class="literal">2</code></td></tr><tr><td><code class="literal">&amp;</code></td><td>整数のビット毎AND</td><td><code class="literal">1 &amp; 3</code></td><td><code class="literal">1</code></td></tr><tr><td><code class="literal">~</code></td><td>整数のビット毎NOT</td><td><code class="literal">~ 1</code></td><td><code class="literal">-2</code></td></tr><tr><td><code class="literal">&lt;&lt;</code></td><td>整数のビット毎の左シフト</td><td><code class="literal">1 &lt;&lt; 2</code></td><td><code class="literal">4</code></td></tr><tr><td><code class="literal">&gt;&gt;</code></td><td>整数のビット毎の右シフト</td><td><code class="literal">8 &gt;&gt; 2</code></td><td><code class="literal">2</code></td></tr><tr><td><code class="literal">+</code></td><td>加算</td><td><code class="literal">5 + 4</code></td><td><code class="literal">9</code></td></tr><tr><td><code class="literal">-</code></td><td>減算</td><td><code class="literal">3 - 2.0</code></td><td><code class="literal">1.0</code></td></tr><tr><td><code class="literal">*</code></td><td>乗算</td><td><code class="literal">5 * 4</code></td><td><code class="literal">20</code></td></tr><tr><td><code class="literal">/</code></td><td>除算（整数切捨て)</td><td><code class="literal">5 / 3</code></td><td><code class="literal">1</code></td></tr><tr><td><code class="literal">%</code></td><td>剰余</td><td><code class="literal">3 % 2</code></td><td><code class="literal">1</code></td></tr><tr><td><code class="literal">-</code></td><td>反転</td><td><code class="literal">- 2.0</code></td><td><code class="literal">-2.0</code></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="refsect2" id="PGBENCH-BUILTIN-FUNCTIONS"><h3>組み込み関数</h3><span class="original">
  &lt;title&gt;Built-In Functions&lt;/title&gt;
</span><p>
<span class="original">
   The functions listed in &lt;xref linkend="pgbench-functions"/&gt; are built
   into &lt;application&gt;pgbench&lt;/application&gt; and may be used in expressions appearing in
   &lt;link linkend="pgbench-metacommand-set"&gt;&lt;literal&gt;\set&lt;/literal&gt;&lt;/link&gt;.
</span>
<a class="xref" href="pgbench.html#PGBENCH-FUNCTIONS" title="表243 pgbenchの関数">表 243</a>に示す関数は<span class="application">pgbench</span>に組み込まれており、<a class="link" href="pgbench.html#PGBENCH-METACOMMAND-SET"><code class="literal">\set</code></a>に現れる式の中で使うことができます。
  </p><span class="original"> list pgbench functions in alphabetical order </span><div class="table" id="PGBENCH-FUNCTIONS"><p class="title"><strong>表243 pgbenchの関数</strong></p><div class="table-contents"><span class="original">
    &lt;title&gt;pgbench Functions&lt;/title&gt;
</span><table class="table" summary="pgbenchの関数" border="1"><colgroup><col /><col /><col /><col /><col /></colgroup><thead><tr><th>関数</th><th>戻り型</th><th>説明</th><th>例</th><th>結果</th></tr></thead><tbody><tr><td><code class="literal"><code class="function">abs(<em class="replaceable"><code>a</code></em>)</code></code></td><td><em class="replaceable"><code>a</code></em>と同じ</td><td>絶対値</td><td><code class="literal">abs(-17)</code></td><td><code class="literal">17</code></td></tr><tr><td><code class="literal"><code class="function">debug(<em class="replaceable"><code>a</code></em>)</code></code></td><td><em class="replaceable"><code>a</code></em>と同じ</td><td><em class="replaceable"><code>a</code></em>を<span class="systemitem">stderr</span>に出力し、<em class="replaceable"><code>a</code></em>を返す</td><td><code class="literal">debug(5432.1)</code></td><td><code class="literal">5432.1</code></td></tr><tr><td><code class="literal"><code class="function">double(<em class="replaceable"><code>i</code></em>)</code></code></td><td>double</td><td>倍精度実数にキャストする</td><td><code class="literal">double(5432)</code></td><td><code class="literal">5432.0</code></td></tr><tr><td><code class="literal"><code class="function">exp(<em class="replaceable"><code>x</code></em>)</code></code></td><td>double</td><td>指数</td><td><code class="literal">exp(1.0)</code></td><td><code class="literal">2.718281828459045</code></td></tr><tr><td><code class="literal"><code class="function">greatest(<em class="replaceable"><code>a</code></em> [, <em class="replaceable"><code>...</code></em> ] )</code></code></td><td><em class="replaceable"><code>a</code></em>のどれかがdoubleならdouble、そうでなければinteger</td><td>引数の中で最大の値</td><td><code class="literal">greatest(5, 4, 3, 2)</code></td><td><code class="literal">5</code></td></tr><tr><td><code class="literal"><code class="function">hash(<em class="replaceable"><code>a</code></em> [, <em class="replaceable"><code>seed</code></em> ] )</code></code></td><td>integer</td><td><code class="literal">hash_murmur2()</code>の別名</td><td><code class="literal">hash(10, 5432)</code></td><td><code class="literal">-5817877081768721676</code></td></tr><tr><td><code class="literal"><code class="function">hash_fnv1a(<em class="replaceable"><code>a</code></em> [, <em class="replaceable"><code>seed</code></em> ] )</code></code></td><td>integer</td><td><a class="ulink" href="https://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function" target="_top">FNV-1a hash</a></td><td><code class="literal">hash_fnv1a(10, 5432)</code></td><td><code class="literal">-7793829335365542153</code></td></tr><tr><td><code class="literal"><code class="function">hash_murmur2(<em class="replaceable"><code>a</code></em> [, <em class="replaceable"><code>seed</code></em> ] )</code></code></td><td>integer</td><td><a class="ulink" href="https://en.wikipedia.org/wiki/MurmurHash" target="_top">MurmurHash2 hash</a></td><td><code class="literal">hash_murmur2(10, 5432)</code></td><td><code class="literal">-5817877081768721676</code></td></tr><tr><td><code class="literal"><code class="function">int(<em class="replaceable"><code>x</code></em>)</code></code></td><td>integer</td><td>整数にキャストする</td><td><code class="literal">int(5.4 + 3.8)</code></td><td><code class="literal">9</code></td></tr><tr><td><code class="literal"><code class="function">least(<em class="replaceable"><code>a</code></em> [, <em class="replaceable"><code>...</code></em> ] )</code></code></td><td><em class="replaceable"><code>a</code></em>のどれかがdoubleならdouble、そうでなければinteger</td><td>引数の中で最小の値</td><td><code class="literal">least(5, 4, 3, 2.1)</code></td><td><code class="literal">2.1</code></td></tr><tr><td><code class="literal"><code class="function">ln(<em class="replaceable"><code>x</code></em>)</code></code></td><td>double</td><td>自然対数</td><td><code class="literal">ln(2.718281828459045)</code></td><td><code class="literal">1.0</code></td></tr><tr><td><code class="literal"><code class="function">mod(<em class="replaceable"><code>i</code></em>, <em class="replaceable"><code>j</code></em>)</code></code></td><td>integer</td><td>剰余</td><td><code class="literal">mod(54, 32)</code></td><td><code class="literal">22</code></td></tr><tr><td><code class="literal"><code class="function">pi()</code></code></td><td>double</td><td>定数PI（円周率）の値</td><td><code class="literal">pi()</code></td><td><code class="literal">3.14159265358979323846</code></td></tr><tr><td><code class="literal"><code class="function">pow(<em class="replaceable"><code>x</code></em>, <em class="replaceable"><code>y</code></em>)</code>, <code class="function">power(<em class="replaceable"><code>x</code></em>, <em class="replaceable"><code>y</code></em>)</code></code></td><td>double</td><td>exponentiation</td><td><code class="literal">pow(2.0, 10)</code>, <code class="literal">power(2.0, 10)</code></td><td><code class="literal">1024.0</code></td></tr><tr><td><code class="literal"><code class="function">random(<em class="replaceable"><code>lb</code></em>, <em class="replaceable"><code>ub</code></em>)</code></code></td><td>integer</td><td><code class="literal">[lb, ub]</code>内の一様分布の整数の乱数</td><td><code class="literal">random(1, 10)</code></td><td><code class="literal">1</code>と<code class="literal">10</code>の間の整数</td></tr><tr><td><code class="literal"><code class="function">random_exponential(<em class="replaceable"><code>lb</code></em>, <em class="replaceable"><code>ub</code></em>, <em class="replaceable"><code>parameter</code></em>)</code></code></td><td>integer</td><td><code class="literal">[lb, ub]</code>内の指数分布の整数の乱数、後述</td><td><code class="literal">random_exponential(1, 10, 3.0)</code></td><td>an integer between <code class="literal">1</code> and <code class="literal">10</code></td></tr><tr><td><code class="literal"><code class="function">random_gaussian(<em class="replaceable"><code>lb</code></em>, <em class="replaceable"><code>ub</code></em>, <em class="replaceable"><code>parameter</code></em>)</code></code></td><td>integer</td><td><code class="literal">[lb, ub]</code>内のガウス分布の整数の乱数、後述</td><td><code class="literal">random_gaussian(1, 10, 2.5)</code></td><td><code class="literal">1</code>と<code class="literal">10</code>の間の整数</td></tr><tr><td><code class="literal"><code class="function">random_zipfian(<em class="replaceable"><code>lb</code></em>, <em class="replaceable"><code>ub</code></em>, <em class="replaceable"><code>parameter</code></em>)</code></code></td><td>integer</td><td><code class="literal">[lb, ub]</code>内のジップ分布のランダム整数、後述</td><td><code class="literal">random_zipfian(1, 10, 1.5)</code></td><td><code class="literal">1</code>と<code class="literal">10</code>の間の整数</td></tr><tr><td><code class="literal"><code class="function">sqrt(<em class="replaceable"><code>x</code></em>)</code></code></td><td>double</td><td>平方根</td><td><code class="literal">sqrt(2.0)</code></td><td><code class="literal">1.414213562</code></td></tr></tbody></table></div></div><br class="table-break" /><p>
<span class="original">
    The &lt;literal&gt;random&lt;/literal&gt; function generates values using a uniform
    distribution, that is all the values are drawn within the specified
    range with equal probability. The &lt;literal&gt;random_exponential&lt;/literal&gt;,
    &lt;literal&gt;random_gaussian&lt;/literal&gt; and &lt;literal&gt;random_zipfian&lt;/literal&gt;
    functions require an additional double parameter which determines the precise
    shape of the distribution.
</span>
<code class="literal">random</code>関数は一様分布を使って値を生成します。
つまり、すべての値は指定された範囲内で同じ確率で発生します。
<code class="literal">random_exponential</code>、<code class="literal">random_gaussian</code>、および、<code class="literal">random_zipfian</code>関数は追加の倍精度実数のパラメータを必要とし、それによって分布の正確な形が決まります。
   </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
<span class="original">
      For an exponential distribution, &lt;replaceable&gt;parameter&lt;/replaceable&gt;
      controls the distribution by truncating a quickly-decreasing
      exponential distribution at &lt;replaceable&gt;parameter&lt;/replaceable&gt;, and then
      projecting onto integers between the bounds.
      To be precise, with
</span>
指数分布では、<em class="replaceable"><code>parameter</code></em>が分布を制御します。
急速に減少する指数分布を<em class="replaceable"><code>parameter</code></em>で切り捨て、境界範囲内の整数に射影します。
正確には、以下の式に従います。
</p><div class="literallayout"><p><br />
f(x) = exp(-parameter * (x - min) / (max - min + 1)) / (1 - exp(-parameter))<br />
</p></div><p>
<span class="original">
      Then value &lt;replaceable&gt;i&lt;/replaceable&gt; between &lt;replaceable&gt;min&lt;/replaceable&gt; and
      &lt;replaceable&gt;max&lt;/replaceable&gt; inclusive is drawn with probability:
      &lt;literal&gt;f(i) - f(i + 1)&lt;/literal&gt;.
</span>
これにより、<em class="replaceable"><code>min</code></em>と<em class="replaceable"><code>max</code></em>の間（両端を含む）の間の値<em class="replaceable"><code>i</code></em>が<code class="literal">f(i) - f(i + 1)</code>の確率で生成されます。
     </p><p>
<span class="original">
      Intuitively, the larger the &lt;replaceable&gt;parameter&lt;/replaceable&gt;, the more
      frequently values close to &lt;replaceable&gt;min&lt;/replaceable&gt; are accessed, and the
      less frequently values close to &lt;replaceable&gt;max&lt;/replaceable&gt; are accessed.
      The closer to 0 &lt;replaceable&gt;parameter&lt;/replaceable&gt; is, the flatter (more
      uniform) the access distribution.
      A crude approximation of the distribution is that the most frequent 1%
      values in the range, close to &lt;replaceable&gt;min&lt;/replaceable&gt;, are drawn
      &lt;replaceable&gt;parameter&lt;/replaceable&gt;% of the time.
      The &lt;replaceable&gt;parameter&lt;/replaceable&gt; value must be strictly positive.
</span>
直感的には、<em class="replaceable"><code>parameter</code></em>が大きければ、<em class="replaceable"><code>min</code></em>に近い値が発生する確率が高くなり、<em class="replaceable"><code>max</code></em>に近い値が発生する確率が低くなります。
<em class="replaceable"><code>parameter</code></em>が0に近ければ、発生の分布はより平ら（より一様）になります。
大雑把に分布を近似すると、<em class="replaceable"><code>min</code></em>に近い最頻の1%の範囲の値は、<em class="replaceable"><code>parameter</code></em>%の割合で発生します。
<em class="replaceable"><code>parameter</code></em>の値は厳密に正でなければなりません。
     </p></li><li class="listitem"><p>
<span class="original">
      For a Gaussian distribution, the interval is mapped onto a standard
      normal distribution (the classical bell-shaped Gaussian curve) truncated
      at &lt;literal&gt;-parameter&lt;/literal&gt; on the left and &lt;literal&gt;+parameter&lt;/literal&gt;
      on the right.
      Values in the middle of the interval are more likely to be drawn.
      To be precise, if &lt;literal&gt;PHI(x)&lt;/literal&gt; is the cumulative distribution
      function of the standard normal distribution, with mean &lt;literal&gt;mu&lt;/literal&gt;
      defined as &lt;literal&gt;(max + min) / 2.0&lt;/literal&gt;, with
</span>
ガウス分布では、標準的な正規分布（古典的なベルの形をしたガウス曲線）で、左に<code class="literal">-parameter</code>、右に<code class="literal">+parameter</code>のところで切り捨てられたものに間隔が射影されます。
間隔の中間の値が発生する確率が最も高くなります。
正確に言うと、<code class="literal">PHI(x)</code>は標準正規分布の累積分布関数、平均値<code class="literal">mu</code>を<code class="literal">(max + min) / 2.0</code>と定義し、さらに
</p><div class="literallayout"><p><br />
f(x) = PHI(2.0 * parameter * (x - mu) / (max - min + 1)) /<br />
       (2.0 * PHI(parameter) - 1)<br />
</p></div><p>
<span class="original">
      then value &lt;replaceable&gt;i&lt;/replaceable&gt; between &lt;replaceable&gt;min&lt;/replaceable&gt; and
      &lt;replaceable&gt;max&lt;/replaceable&gt; inclusive is drawn with probability:
      &lt;literal&gt;f(i + 0.5) - f(i - 0.5)&lt;/literal&gt;.
      Intuitively, the larger the &lt;replaceable&gt;parameter&lt;/replaceable&gt;, the more
      frequently values close to the middle of the interval are drawn, and the
      less frequently values close to the &lt;replaceable&gt;min&lt;/replaceable&gt; and
      &lt;replaceable&gt;max&lt;/replaceable&gt; bounds. About 67% of values are drawn from the
      middle &lt;literal&gt;1.0 / parameter&lt;/literal&gt;, that is a relative
      &lt;literal&gt;0.5 / parameter&lt;/literal&gt; around the mean, and 95% in the middle
      &lt;literal&gt;2.0 / parameter&lt;/literal&gt;, that is a relative
      &lt;literal&gt;1.0 / parameter&lt;/literal&gt; around the mean; for instance, if
      &lt;replaceable&gt;parameter&lt;/replaceable&gt; is 4.0, 67% of values are drawn from the
      middle quarter (1.0 / 4.0) of the interval (i.e. from
      &lt;literal&gt;3.0 / 8.0&lt;/literal&gt; to &lt;literal&gt;5.0 / 8.0&lt;/literal&gt;) and 95% from
      the middle half (&lt;literal&gt;2.0 / 4.0&lt;/literal&gt;) of the interval (second and third
      quartiles). The minimum &lt;replaceable&gt;parameter&lt;/replaceable&gt; is 2.0 for performance
      of the Box-Muller transform.
</span>
とすると、<em class="replaceable"><code>min</code></em>と<em class="replaceable"><code>max</code></em>の間（両端を含む）の値<em class="replaceable"><code>i</code></em>が発生する確率は<code class="literal">f(i + 0.5) - f(i - 0.5)</code>になります。
直感的には、<em class="replaceable"><code>parameter</code></em>が大きくなれば、間隔の中間に近い値になる確率が高く、また、<em class="replaceable"><code>min</code></em>と<em class="replaceable"><code>max</code></em>の境界に近い値になる確率は低くなります。
約67%の値は、中間の<code class="literal">1.0 / parameter</code>の範囲、つまり平均値から<code class="literal">0.5 / parameter</code>の範囲から、また95%は中間の<code class="literal">2.0 / parameter</code>の範囲、つまり平均値から<code class="literal">1.0 / parameter</code>の範囲に発生します。
例えば<em class="replaceable"><code>parameter</code></em>が4.0なら、67%の値は間隔の中間の4分の1(1.0/4.0)から（つまり<code class="literal">3.0 / 8.0</code>から<code class="literal">5.0 / 8.0</code>まで）、95%は間隔の中間の半分（<code class="literal">2.0 / 4.0</code>）から（2番目と3番目の四分位）から発生します。
ボックス＝ミュラーの変換のパフォーマンスのため、最小の<em class="replaceable"><code>parameter</code></em>は2.0です。
     </p></li><li class="listitem"><p>
<span class="original">
      &lt;literal&gt;random_zipfian&lt;/literal&gt; generates an approximated bounded Zipfian
      distribution. For &lt;replaceable&gt;parameter&lt;/replaceable&gt; in (0, 1), an
      approximated algorithm is taken from
      "Quickly Generating Billion-Record Synthetic Databases",
      Jim Gray et al, SIGMOD 1994. For &lt;replaceable&gt;parameter&lt;/replaceable&gt;
      in (1, 1000), a rejection method is used, based on
      "Non-Uniform Random Variate Generation", Luc Devroye, p. 550-551,
      Springer 1986. The distribution is not defined when the parameter's
      value is 1.0. The function's performance is poor for parameter values
      close and above 1.0 and on a small range.
</span>
<code class="literal">random_zipfian</code>は近似範囲のジフ分布を生成します。
(0, 1)の<em class="replaceable"><code>parameter</code></em>に対して、
「Quickly Generating Billion-Record Synthetic Databases」Jim Gray(SIGMOD 1994)から近似アルゴリズムがとられています。
(0, 1000)の<em class="replaceable"><code>parameter</code></em>に対しては、
「Non-Uniform Random Variate Generation」Luc Devroye(Springer 1986, p. 550-551)に基づく棄却法が用いられます。
パラメータの値が1.0のときには分布は定義されません。
パラメータ値が1.0を超えて1.0に近く小さい範囲に対しての関数の性能は劣ります。
     </p><p>
<span class="original">
      &lt;replaceable&gt;parameter&lt;/replaceable&gt; defines how skewed the distribution
      is. The larger the &lt;replaceable&gt;parameter&lt;/replaceable&gt;, the more
      frequently values closer to the beginning of the interval are drawn.
      The closer to 0 &lt;replaceable&gt;parameter&lt;/replaceable&gt; is,
      the flatter (more uniform) the output distribution.
      The distribution is such that, assuming the range starts from 1,
      the ratio of the probability of drawing &lt;replaceable&gt;k&lt;/replaceable&gt;
      versus drawing &lt;replaceable&gt;k+1&lt;/replaceable&gt; is
      &lt;literal&gt;((&lt;replaceable&gt;k&lt;/replaceable&gt;+1)/&lt;replaceable&gt;k&lt;/replaceable&gt;)**&lt;replaceable&gt;parameter&lt;/replaceable&gt;&lt;/literal&gt;.
      For example, &lt;literal&gt;random_zipfian(1, ..., 2.5)&lt;/literal&gt; produces
      the value &lt;literal&gt;1&lt;/literal&gt; about &lt;literal&gt;(2/1)**2.5 =
      5.66&lt;/literal&gt; times more frequently than &lt;literal&gt;2&lt;/literal&gt;, which
      itself is produced &lt;literal&gt;(3/2)*2.5 = 2.76&lt;/literal&gt; times more
      frequently than &lt;literal&gt;3&lt;/literal&gt;, and so on.
</span>
<em class="replaceable"><code>parameter</code></em>はどれほど歪んだ分布かを定義します。
より大きい<em class="replaceable"><code>parameter</code></em>ほど、より高頻度に区間の始点に近い値が描かれます。
より0に近い<em class="replaceable"><code>parameter</code></em>は、より平坦（より均一）な出力分布です。
範囲が1から始まるとして、<em class="replaceable"><code>k</code></em>を描く確率と<em class="replaceable"><code>k+1</code></em>を描く確率の比が<code class="literal">((<em class="replaceable"><code>k</code></em>+1)/<em class="replaceable"><code>k</code></em>)**<em class="replaceable"><code>parameter</code></em></code>という分布になります。
例えば、<code class="literal">random_zipfian(1, ..., 2.5)</code>は、値<code class="literal">1</code>を<code class="literal">2</code>の約<code class="literal">(2/1)**2.5 = 5.66</code>倍高い頻度で生成し、値<code class="literal">2</code>を<code class="literal">3</code>の約<code class="literal">(3/2)**2.5 = 2.76</code>倍高い頻度で生成し、以下同様に続きます。
     </p></li></ul></div><p>
<span class="original">
    Hash functions &lt;literal&gt;hash&lt;/literal&gt;, &lt;literal&gt;hash_murmur2&lt;/literal&gt; and
    &lt;literal&gt;hash_fnv1a&lt;/literal&gt; accept an input value and an optional seed parameter.
    In case the seed isn't provided the value of &lt;literal&gt;:default_seed&lt;/literal&gt;
    is used, which is initialized randomly unless set by the command-line
    &lt;literal&gt;-D&lt;/literal&gt; option. Hash functions can be used to scatter the
    distribution of random functions such as &lt;literal&gt;random_zipfian&lt;/literal&gt; or
    &lt;literal&gt;random_exponential&lt;/literal&gt;. For instance, the following pgbench
    script simulates possible real world workload typical for social media and
    blogging platforms where few accounts generate excessive load:
</span>
ハッシュ関数<code class="literal">hash</code>、<code class="literal">hash_murmur2</code>および<code class="literal">hash_fnv1a</code>は入力値とオプションシードパラメータを受け付けます。
シードが与えられなかった場合、<code class="literal">:default_seed</code>の値が使われます。これは、コマンドライン<code class="literal">-D</code>オプションで設定されない限りランダムに初期化されたものです。
ハッシュ関数は<code class="literal">random_zipfian</code>や<code class="literal">random_exponential</code>などのランダム関数の分布を散らすのに使用できます。
例えば、以下のpgbenchスクリプトは起こりえる現実世界のソーシャルメディアとブログプラットフォームに対する僅かなアカウントしか過大な負荷をかけないという典型的な負荷をシミュレートします。

</p><pre class="programlisting">
\set r random_zipfian(0, 100000000, 1.07)
\set k abs(hash(:r)) % 1000000
</pre><p>

<span class="original">
    In some cases several distinct distributions are needed which don't correlate
    with each other and this is when implicit seed parameter comes in handy:
</span>
一部のケースでは、互いに無関係ないくつかの異なる分布が必要で、これは暗黙のシードパラメータが役立ちます。

</p><pre class="programlisting">
\set k1 abs(hash(:r, :default_seed + 123)) % 1000000
\set k2 abs(hash(:r, :default_seed + 321)) % 1000000
</pre><p>
  </p><p>
<span class="original">
   As an example, the full definition of the built-in TPC-B-like
   transaction is:
</span>
例えば、組み込みのTPC-Bのようなトランザクションの完全な定義を示します。

</p><pre class="programlisting">
\set aid random(1, 100000 * :scale)
\set bid random(1, 1 * :scale)
\set tid random(1, 10 * :scale)
\set delta random(-5000, 5000)
BEGIN;
UPDATE pgbench_accounts SET abalance = abalance + :delta WHERE aid = :aid;
SELECT abalance FROM pgbench_accounts WHERE aid = :aid;
UPDATE pgbench_tellers SET tbalance = tbalance + :delta WHERE tid = :tid;
UPDATE pgbench_branches SET bbalance = bbalance + :delta WHERE bid = :bid;
INSERT INTO pgbench_history (tid, bid, aid, delta, mtime) VALUES (:tid, :bid, :aid, :delta, CURRENT_TIMESTAMP);
END;
</pre><p>

<span class="original">
   This script allows each iteration of the transaction to reference
   different, randomly-chosen rows.  (This example also shows why it's
   important for each client session to have its own variables &amp;mdash;
   otherwise they'd not be independently touching different rows.)
</span>
 このスクリプトにより、トランザクションを繰り返す度に異なる、ランダムに選ばれた行を参照することができます。
 （この例はまた、各クライアントセッションがなぜ独自の変数を持つことが重要なのかも表しています。
 これがないと、異なる行を独立して参照することができないのです。）
  </p></div><div class="refsect2" id="id-1.9.4.10.7.6"><h3>トランザクション毎のログ処理</h3><span class="original">
  &lt;title&gt;Per-Transaction Logging&lt;/title&gt;
</span><p>
<span class="original">
   With the &lt;option&gt;-l&lt;/option&gt; option (but without
   the &lt;option&gt;&amp;#045;&amp;#045;aggregate-interval&lt;/option&gt; option),
   &lt;application&gt;pgbench&lt;/application&gt; writes information about each transaction
   to a log file.  The log file will be named
   &lt;filename&gt;&lt;replaceable&gt;prefix&lt;/replaceable&gt;.&lt;replaceable&gt;nnn&lt;/replaceable&gt;&lt;/filename&gt;,
   where &lt;replaceable&gt;prefix&lt;/replaceable&gt; defaults to &lt;literal&gt;pgbench_log&lt;/literal&gt;, and
   &lt;replaceable&gt;nnn&lt;/replaceable&gt; is the PID of the
   &lt;application&gt;pgbench&lt;/application&gt; process.
   The prefix can be changed by using the &lt;option&gt;&amp;#045;&amp;#045;log-prefix&lt;/option&gt; option.
   If the &lt;option&gt;-j&lt;/option&gt; option is 2 or higher, so that there are multiple
   worker threads, each will have its own log file. The first worker will
   use the same name for its log file as in the standard single worker case.
   The additional log files for the other workers will be named
   &lt;filename&gt;&lt;replaceable&gt;prefix&lt;/replaceable&gt;.&lt;replaceable&gt;nnn&lt;/replaceable&gt;.&lt;replaceable&gt;mmm&lt;/replaceable&gt;&lt;/filename&gt;,
   where &lt;replaceable&gt;mmm&lt;/replaceable&gt; is a sequential number for each worker starting
   with 1.
</span>
（<code class="option">--aggregate-interval</code>オプションなしで）<code class="option">-l</code>オプションを使用すると、<span class="application">pgbench</span>は各トランザクションに関する情報をログファイルに書き出します。
ログファイルの名前は<code class="filename"><em class="replaceable"><code>prefix</code></em>.<em class="replaceable"><code>nnn</code></em></code>で、<em class="replaceable"><code>prefix</code></em>のデフォルトは<code class="literal">pgbench_log</code>、<em class="replaceable"><code>nnn</code></em>は<span class="application">pgbench</span>プロセスのPIDです。
ファイル名の先頭の文字列は<code class="option">--log-prefix</code>オプションを使って変更することができます。
<code class="option">-j</code>オプションが2以上で複数のワーカスレッドがある場合、それぞれが独自のログファイルを持つことになります。
最初のワーカは標準的な単一ワーカの場合と同じ名前を持つログファイルを使用します。
他のワーカ用の追加のログファイルは<code class="filename"><em class="replaceable"><code>prefix</code></em>.<em class="replaceable"><code>nnn</code></em>.<em class="replaceable"><code>mmm</code></em></code>と命名され、ここで<em class="replaceable"><code>mmm</code></em>は1から始まる各ワーカの連番です。
  </p><p>
<span class="original">
   The format of the log is:
</span>
ログの書式は以下の通りです。

</p><pre class="synopsis">
<em class="replaceable"><code>client_id</code></em> <em class="replaceable"><code>transaction_no</code></em> <em class="replaceable"><code>time</code></em> <em class="replaceable"><code>script_no</code></em> <em class="replaceable"><code>time_epoch</code></em> <em class="replaceable"><code>time_us</code></em> [<span class="optional"> <em class="replaceable"><code>schedule_lag</code></em> </span>]
</pre><p>

<span class="original">
   where
   &lt;replaceable&gt;client_id&lt;/replaceable&gt; indicates which client session ran the transaction,
   &lt;replaceable&gt;transaction_no&lt;/replaceable&gt; counts how many transactions have been
   run by that session,
   &lt;replaceable&gt;time&lt;/replaceable&gt; is the total elapsed transaction time in microseconds,
   &lt;replaceable&gt;script_no&lt;/replaceable&gt; identifies which script file was used (useful when
   multiple scripts were specified with &lt;option&gt;-f&lt;/option&gt; or &lt;option&gt;-b&lt;/option&gt;),
   and &lt;replaceable&gt;time_epoch&lt;/replaceable&gt;/&lt;replaceable&gt;time_us&lt;/replaceable&gt; are a
   Unix-epoch time stamp and an offset
   in microseconds (suitable for creating an ISO 8601
   time stamp with fractional seconds) showing when
   the transaction completed.
   The &lt;replaceable&gt;schedule_lag&lt;/replaceable&gt; field is the difference between the
   transaction's scheduled start time, and the time it actually started, in
   microseconds. It is only present when the &lt;option&gt;&amp;#045;&amp;#045;rate&lt;/option&gt; option is used.
   When both &lt;option&gt;&amp;#045;&amp;#045;rate&lt;/option&gt; and &lt;option&gt;&amp;#045;&amp;#045;latency-limit&lt;/option&gt; are used,
   the &lt;replaceable&gt;time&lt;/replaceable&gt; for a skipped transaction will be reported as
   &lt;literal&gt;skipped&lt;/literal&gt;.
</span>
<em class="replaceable"><code>client_id</code></em>はどのクライアントセッションがそのトランザクションを実行したかを示します。
<em class="replaceable"><code>transaction_no</code></em>はそのセッションで何個のトランザクションが実行されたかを示します。
<em class="replaceable"><code>time</code></em>はトランザクションの合計消費時間をミリ秒単位で示します。
<em class="replaceable"><code>script_no</code></em>はどのスクリプトファイルが使用されたかを識別するものです（<code class="option">-f</code>または<code class="option">-b</code>で複数のスクリプトが指定された場合に有用です）。
<em class="replaceable"><code>time_epoch</code></em>/<em class="replaceable"><code>time_us</code></em>はトランザクション完了時のUnixエポック時間とマイクロ秒単位のオフセットです（小数秒付きのISO 8601タイムスタンプの作成に適します）。
<em class="replaceable"><code>schedule_lag</code></em>フィールドは、マイクロ秒単位のトランザクションの予定開始時刻と実開始時刻の差です。
これは<code class="option">--rate</code>オプションを使用した時だけ表示されます。
<code class="option">--rate</code>と<code class="option">--latency-limit</code>の両方のオプションを使用した時は、スキップされたトランザクションの<em class="replaceable"><code>time</code></em>が<code class="literal">skipped</code>として表示されます。
  </p><p>
<span class="original">
   Here is a snippet of a log file generated in a single-client run:
</span>
単一クライアントでの実行で生成されたログファイルの一部を示します。
</p><pre class="screen">
0 199 2241 0 1175850568 995598
0 200 2465 0 1175850568 998079
0 201 2513 0 1175850569 608
0 202 2038 0 1175850569 2663
</pre><p>

<span class="original">
   Another example with &lt;literal&gt;&amp;#045;&amp;#045;rate=100&lt;/literal&gt;
   and &lt;literal&gt;&amp;#045;&amp;#045;latency-limit=5&lt;/literal&gt; (note the additional
   &lt;replaceable&gt;schedule_lag&lt;/replaceable&gt; column):
</span>
<code class="literal">--rate=100</code>と<code class="literal">--latency-limit=5</code>を指定した例を示します。(<em class="replaceable"><code>schedule_lag</code></em>列が追加されていることに注意)
</p><pre class="screen">
0 81 4621 0 1412881037 912698 3005
0 82 6173 0 1412881037 914578 4304
0 83 skipped 0 1412881037 914578 5217
0 83 skipped 0 1412881037 914578 5099
0 83 4722 0 1412881037 916203 3108
0 84 4142 0 1412881037 918023 2333
0 85 2465 0 1412881037 919759 740
</pre><p>
<span class="original">
   In this example, transaction 82 was late, because its latency (6.173 ms) was
   over the 5 ms limit. The next two transactions were skipped, because they
   were already late before they were even started.
</span>
この例では、トランザクション82は遅延(6.173ミリ秒)が5ミリ秒を越えており、遅れています。
次の2つのトランザクションは、開始する前にすでに遅れてしまっているため、スキップされています。
  </p><p>
<span class="original">
   When running a long test on hardware that can handle a lot of transactions,
   the log files can become very large.  The &lt;option&gt;&amp;#045;&amp;#045;sampling-rate&lt;/option&gt; option
   can be used to log only a random sample of transactions.
</span>
大量のトランザクションを処理することができるハードウェアで長時間試験を実行する場合、ログファイルは非常に大きくなる可能性があります。
<code class="option">--sampling-rate</code>オプションを使用して、トランザクションのランダムなサンプルだけをログに記録することができます。
  </p></div><div class="refsect2" id="id-1.9.4.10.7.7"><h3>ログ処理の集約</h3><span class="original">
  &lt;title&gt;Aggregated Logging&lt;/title&gt;
</span><p>
<span class="original">
   With the &lt;option&gt;&amp;#045;&amp;#045;aggregate-interval&lt;/option&gt; option, a different
   format is used for the log files:
</span>
<code class="option">--aggregate-interval</code>オプションを付ける場合、以下のようにログの書式が異なります。

</p><pre class="synopsis">
<em class="replaceable"><code>interval_start</code></em> <em class="replaceable"><code>num_transactions</code></em> <em class="replaceable"><code>sum_latency</code></em> <em class="replaceable"><code>sum_latency_2</code></em> <em class="replaceable"><code>min_latency</code></em> <em class="replaceable"><code>max_latency</code></em> [<span class="optional"> <em class="replaceable"><code>sum_lag</code></em> <em class="replaceable"><code>sum_lag_2</code></em> <em class="replaceable"><code>min_lag</code></em> <em class="replaceable"><code>max_lag</code></em> [<span class="optional"> <em class="replaceable"><code>skipped</code></em> </span>] </span>]
</pre><p>

<span class="original">
   where
   &lt;replaceable&gt;interval_start&lt;/replaceable&gt; is the start of the interval (as a Unix
   epoch time stamp),
   &lt;replaceable&gt;num_transactions&lt;/replaceable&gt; is the number of transactions
   within the interval,
   &lt;replaceable&gt;sum_latency&lt;/replaceable&gt; is the sum of the transaction
   latencies within the interval,
   &lt;replaceable&gt;sum_latency_2&lt;/replaceable&gt; is the sum of squares of the
   transaction latencies within the interval,
   &lt;replaceable&gt;min_latency&lt;/replaceable&gt; is the minimum latency within the interval,
   and
   &lt;replaceable&gt;max_latency&lt;/replaceable&gt; is the maximum latency within the interval.
   The next fields,
   &lt;replaceable&gt;sum_lag&lt;/replaceable&gt;, &lt;replaceable&gt;sum_lag_2&lt;/replaceable&gt;, &lt;replaceable&gt;min_lag&lt;/replaceable&gt;,
   and &lt;replaceable&gt;max_lag&lt;/replaceable&gt;, are only present if the &lt;option&gt;&amp;#045;&amp;#045;rate&lt;/option&gt;
   option is used.
   They provide statistics about the time each transaction had to wait for the
   previous one to finish, i.e. the difference between each transaction's
   scheduled start time and the time it actually started.
   The very last field, &lt;replaceable&gt;skipped&lt;/replaceable&gt;,
   is only present if the &lt;option&gt;&amp;#045;&amp;#045;latency-limit&lt;/option&gt; option is used, too.
   It counts the number of transactions skipped because they would have
   started too late.
   Each transaction is counted in the interval when it was committed.
</span>
<em class="replaceable"><code>interval_start</code></em>はインターバルの開始時刻（Unixエポック時間）です。
<em class="replaceable"><code>num_of_transactions</code></em>はインターバル内のトランザクション数です。
<em class="replaceable"><code>latency_sum</code></em>はインターバル内のトランザクションレイテンシの総和です。
<em class="replaceable"><code>sum_latency_2</code></em>はインターバル内のトランザクションレイテンシの2乗の総和です。
<em class="replaceable"><code>min_latency</code></em>はインターバル内の最小レイテンシです。
<em class="replaceable"><code>max_latency</code></em>はインターバル内の最大レイテンシです。
これに続くフィールド<em class="replaceable"><code>sum_lag</code></em>、<em class="replaceable"><code>sum_lag_2</code></em>、<em class="replaceable"><code>min_lag</code></em>、<em class="replaceable"><code>max_lag</code></em>は<code class="option">--rate</code>オプションが指定された場合にのみ表示されます。
これらは、各トランザクションが直前のトランザクションの終了を待機しなければならなかった時間、つまりトランザクションの予定開始時刻と実際の開始時刻の差に関する統計を提供します。
一番最後のフィールド<em class="replaceable"><code>skipped</code></em>は<code class="option">--latency-limit</code>オプションも使用されたときにのみ表示されます。
これは開始時刻が遅くなったためにスキップされたトランザクションの数を数えます。
各トランザクションはインターバル内でコミットされた時に数えられます。
  </p><p>
<span class="original">
   Here is some example output:
</span>
いくつか出力例を示します。
</p><pre class="screen">
1345828501 5601 1542744 483552416 61 2573
1345828503 7884 1979812 565806736 60 1479
1345828505 7208 1979422 567277552 59 1391
1345828507 7685 1980268 569784714 60 1398
1345828509 7073 1979779 573489941 236 1411
</pre><p>
<span class="original">
   Notice that while the plain (unaggregated) log file shows which script
   was used for each transaction, the aggregated log does not. Therefore if
   you need per-script data, you need to aggregate the data on your own.
</span>
通常の（集約されていない）ログファイルは、各トランザクションについてどのスクリプトファイルが使用されたかを示しますが、集約されたログにはそれがないことに注意してください。
このためスクリプト単位のデータが必要な場合は、自身でデータを集約する必要があります。
  </p></div><div class="refsect2" id="id-1.9.4.10.7.8"><h3>ステートメント毎のレイテンシ</h3><span class="original">
  &lt;title&gt;Per-Statement Latencies&lt;/title&gt;
</span><p>
<span class="original">
   With the &lt;option&gt;-r&lt;/option&gt; option, &lt;application&gt;pgbench&lt;/application&gt; collects
   the elapsed transaction time of each statement executed by every
   client.  It then reports an average of those values, referred to
   as the latency for each statement, after the benchmark has finished.
</span>
<code class="option">-r</code>オプションを付けると、<span class="application">pgbench</span>は各クライアントにより実行されたトランザクションのステートメント毎の経過時間を収集します。
ベンチマークが終了した後、各値の平均値(各ステートメントのレイテンシと呼びます)が報告されます。
  </p><p>
<span class="original">
   For the default script, the output will look similar to this:
</span>
標準スクリプトでは、次のような出力になります。
</p><pre class="screen">
starting vacuum...end.
transaction type: &lt;builtin: TPC-B (sort of)&gt;
scaling factor: 1
query mode: simple
number of clients: 10
number of threads: 1
number of transactions per client: 1000
number of transactions actually processed: 10000/10000
latency average = 15.844 ms
latency stddev = 2.715 ms
tps = 618.764555 (including connections establishing)
tps = 622.977698 (excluding connections establishing)
statement latencies in milliseconds:
        0.002  \set aid random(1, 100000 * :scale)
        0.005  \set bid random(1, 1 * :scale)
        0.002  \set tid random(1, 10 * :scale)
        0.001  \set delta random(-5000, 5000)
        0.326  BEGIN;
        0.603  UPDATE pgbench_accounts SET abalance = abalance + :delta WHERE aid = :aid;
        0.454  SELECT abalance FROM pgbench_accounts WHERE aid = :aid;
        5.528  UPDATE pgbench_tellers SET tbalance = tbalance + :delta WHERE tid = :tid;
        7.335  UPDATE pgbench_branches SET bbalance = bbalance + :delta WHERE bid = :bid;
        0.371  INSERT INTO pgbench_history (tid, bid, aid, delta, mtime) VALUES (:tid, :bid, :aid, :delta, CURRENT_TIMESTAMP);
        1.212  END;
</pre><p>
  </p><p>
<span class="original">
   If multiple script files are specified, the averages are reported
   separately for each script file.
</span>
複数のスクリプトファイルが定義された場合、平均値はそれぞれのスクリプトファイル毎に分けて報告されます。
  </p><p>
<span class="original">
   Note that collecting the additional timing information needed for
   per-statement latency computation adds some overhead.  This will slow
   average execution speed and lower the computed TPS.  The amount
   of slowdown varies significantly depending on platform and hardware.
   Comparing average TPS values with and without latency reporting enabled
   is a good way to measure if the timing overhead is significant.
</span>
ステートメント毎のレイテンシを計算するために必要となる、追加のタイミング情報を収集することは、オーバーヘッドが加わることに注意してください。
これは平均実行速度を遅くし、計測TPSを小さくするでしょう。
低下量はプラットフォームとハードウェアに依存して著しく変わります。
レイテンシの報告を有効にする、有効にしないで平均TPS値を比較することは、タイミング・オーバーヘッドが顕著かどうかを測定するには良い方法です。
  </p></div><div class="refsect2" id="id-1.9.4.10.7.9"><h3>優れた実践</h3><span class="original">
  &lt;title&gt;Good Practices&lt;/title&gt;
</span><p>
<span class="original">
   It is very easy to use &lt;application&gt;pgbench&lt;/application&gt; to produce completely
   meaningless numbers.  Here are some guidelines to help you get useful
   results.
</span>
まったく無意味な数値を生み出すように<span class="application">pgbench</span>を使用することは非常に簡単です。
以下に有意な結果を生み出す手助けとなるガイドラインをいくつか示します。
  </p><p>
<span class="original">
   In the first place, &lt;emphasis&gt;never&lt;/emphasis&gt; believe any test that runs
   for only a few seconds.  Use the &lt;option&gt;-t&lt;/option&gt; or &lt;option&gt;-T&lt;/option&gt; option
   to make the run last at least a few minutes, so as to average out noise.
   In some cases you could need hours to get numbers that are reproducible.
   It's a good idea to try the test run a few times, to find out if your
   numbers are reproducible or not.
</span>
まず第一に、数秒で終わる試験を<span class="emphasis"><em>決して</em></span>信用しないでください。
<code class="option">-t</code>または<code class="option">-T</code>オプションを使って、雑音を取り除くために、少なくとも数分試験にかかるようにしてください。
再現可能な数値を得るために数時間必要になる場合もあります。
数回試験を繰り返し、数値が再現できるかどうか確認することを勧めます。
  </p><p>
<span class="original">
   For the default TPC-B-like test scenario, the initialization scale factor
   (&lt;option&gt;-s&lt;/option&gt;) should be at least as large as the largest number of
   clients you intend to test (&lt;option&gt;-c&lt;/option&gt;); else you'll mostly be
   measuring update contention.  There are only &lt;option&gt;-s&lt;/option&gt; rows in
   the &lt;structname&gt;pgbench_branches&lt;/structname&gt; table, and every transaction wants to
   update one of them, so &lt;option&gt;-c&lt;/option&gt; values in excess of &lt;option&gt;-s&lt;/option&gt;
   will undoubtedly result in lots of transactions blocked waiting for
   other transactions.
</span>
デフォルトのTPC-Bのような試験シナリオでは、初期倍率（<code class="option">-s</code>）を試験予定のクライアント数（<code class="option">-c</code>）の最大値と同程度にしなければなりません。
<code class="structname">pgbench_branches</code>テーブルには<code class="option">-s</code>行しかありません。
また、全トランザクションはその内の1つを更新しようとします。
ですので、<code class="option">-c</code>値を<code class="option">-s</code>より大きくすると、他のトランザクションを待機するためにブロックされるトランザクションが多くなることは間違いありません。
  </p><p>
<span class="original">
   The default test scenario is also quite sensitive to how long it's been
   since the tables were initialized: accumulation of dead rows and dead space
   in the tables changes the results.  To understand the results you must keep
   track of the total number of updates and when vacuuming happens.  If
   autovacuum is enabled it can result in unpredictable changes in measured
   performance.
</span>
デフォルトの試験シナリオはまた、テーブルを初期化してからの経過時間に非常に敏感です。
テーブル内の不要行や不要空間の累積により結果が変わります。
結果を理解するためには、更新された行数とバキューム時期を把握する必要があります。
自動バキュームが有効な場合、性能を測定する上で結果は予測できないほど変わる可能性があります。
  </p><p>
<span class="original">
   A limitation of &lt;application&gt;pgbench&lt;/application&gt; is that it can itself become
   the bottleneck when trying to test a large number of client sessions.
   This can be alleviated by running &lt;application&gt;pgbench&lt;/application&gt; on a different
   machine from the database server, although low network latency will be
   essential.  It might even be useful to run several &lt;application&gt;pgbench&lt;/application&gt;
   instances concurrently, on several client machines, against the same
   database server.
</span>
<span class="application">pgbench</span>の制限は、多くのクライアントセッションを試験しようとする際に<span class="application">pgbench</span>自身がボトルネックになる可能性があることです。
これは、データベースサーバとは別のマシンで<span class="application">pgbench</span>を実行することで緩和させることが可能です。
しかし、多少のネットワーク遅延が重要です。
同一データベースサーバに対し複数のクライアントマシンから複数の<span class="application">pgbench</span>インスタンスを同時に実行することが有用かもしれません。
  </p></div><div class="refsect2" id="id-1.9.4.10.7.10"><h3>セキュリティ</h3><span class="original">
  &lt;title&gt;Security&lt;/title&gt;
</span><p>
<span class="original">
    If untrusted users have access to a database that has not adopted a
    &lt;link linkend="ddl-schemas-patterns"&gt;secure schema usage pattern&lt;/link&gt;,
    do not run &lt;application&gt;pgbench&lt;/application&gt; in that
    database.  &lt;application&gt;pgbench&lt;/application&gt; uses unqualified names and
    does not manipulate the search path.
</span>
<a class="link" href="ddl-schemas.html#DDL-SCHEMAS-PATTERNS" title="5.8.6. 使用パターン">安全なスキーマの利用パターン</a>を適用していないデータベースに信頼できないユーザがアクセス可能な場合、そのデータベースで<span class="application">pgbench</span>を実行しないでください。
<span class="application">pgbench</span>は修飾していない名前を使っており、またサーチパスを操作していません。
  </p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="app-pgbasebackup.html">前へ</a> </td><td width="20%" align="center"><a accesskey="u" href="reference-client.html">上へ</a></td><td width="40%" align="right"> <a accesskey="n" href="app-pgconfig.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">pg_basebackup </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> pg_config</td></tr></table></div></body></html>