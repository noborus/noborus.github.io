<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>34.1. データベース接続制御関数</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="libpq.html" title="第34章 libpq - C ライブラリ" /><link rel="next" href="libpq-status.html" title="34.2. 接続状態関数" /><meta name="viewport" content="width=device-width,initial-scale=1.0" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="4" align="center"><a accesskey="h" href="index.html">PostgreSQL 11.4文書</a></th></tr><tr><td width="10%" align="left"></td><td width="10%" align="left"></td><td width="60%" align="center"><a href="libpq.html" title="第34章 libpq - C ライブラリ">第34章 <span class="application">libpq</span> - C ライブラリ</a></td><td width="20%" align="right"></td></tr><tr><td width="10%" align="left"><a accesskey="p" href="libpq.html" title="第34章 libpq - C ライブラリ">前へ</a> </td><td width="10%" align="left"><a accesskey="u" href="libpq.html" title="第34章 libpq - C ライブラリ">上へ</a></td><td width="60%" align="center">34.1. データベース接続制御関数</td><td width="20%" align="right"> <a accesskey="n" href="libpq-status.html" title="34.2. 接続状態関数">次へ</a></td></tr></table><hr /></div><div class="sect1" id="LIBPQ-CONNECT"><div class="titlepage"><div><div><h2 class="title" style="clear: both">34.1. データベース接続制御関数</h2></div></div></div><!--
  <title>Database Connection Control Functions</title>
--><p>
<!--
   The following functions deal with making a connection to a
   <productname>PostgreSQL</productname> backend server.  An
   application program can have several backend connections open at
   one time.  (One reason to do that is to access more than one
   database.)  Each connection is represented by a
   <structname>PGconn</structname><indexterm><primary>PGconn</primary></indexterm> object, which
   is obtained from the function <function>PQconnectdb</function>,
   <function>PQconnectdbParams</function>, or
   <function>PQsetdbLogin</function>.  Note that these functions will always
   return a non-null object pointer, unless perhaps there is too
   little memory even to allocate the <structname>PGconn</structname> object.
   The <function>PQstatus</function> function should be called to check
   the return value for a successful connection before queries are sent
   via the connection object.
-->
<span class="productname">PostgreSQL</span>のバックエンドサーバとの接続を作成するには、以下の関数を使用します。
アプリケーションプログラムはバックエンドとの接続を一度に複数個開くことができます。
（1つの理由として、複数のデータベースへのアクセスが挙げられます。）
個々の接続は、<code class="function">PQconnectdb</code>、<code class="function">PQconnectdbParams</code>または<code class="function">PQsetdbLogin</code>関数を呼び出すことで得られる<code class="structname">PGconn</code><a id="id-1.7.3.8.2.6" class="indexterm"></a>オブジェクトによって表されます。
なお、これらの関数は、<code class="structname">PGconn</code>オブジェクトに割り当てるほんのわずかなメモリの余裕さえもない場合を除き、NULLではなく常にオブジェクトのポインタを返します。
また、この接続オブジェクトを通じて問い合わせを送る前に、<code class="function">PQstatus</code>関数を呼び出して、データベースとの接続に成功したか戻り値を検査しなければなりません。

   </p><div class="warning"><h3 class="title">警告</h3><p>
<!--
     If untrusted users have access to a database that has not adopted a
     <link linkend="ddl-schemas-patterns">secure schema usage pattern</link>,
     begin each session by removing publicly-writable schemas from
     <varname>search_path</varname>.  One can set parameter key
     word <literal>options</literal> to
     value <literal>-csearch_path=</literal>.  Alternately, one can
     issue <literal>PQexec(<replaceable>conn</replaceable>, "SELECT
     pg_catalog.set_config('search_path', '', false)")</literal> after
     connecting.  This consideration is not specific
     to <application>libpq</application>; it applies to every interface for
     executing arbitrary SQL commands.
-->
信頼できないユーザが、<a class="link" href="ddl-schemas.html#DDL-SCHEMAS-PATTERNS" title="5.8.6. 使用パターン">安全なスキーマ使用パターン</a>を適用していないデータベースへアクセスする際には、セッション開始時に<code class="varname">search_path</code>から、第三者が書き込みができるスキーマを削除してください。
これは<code class="literal">options</code>パラメータキーワードに値<code class="literal">-csearch_path=</code>を設定することで可能となります。
別の方法としては、接続後に<code class="literal">PQexec(<em class="replaceable"><code>conn</code></em>, "SELECT pg_catalog.set_config('search_path', '', false)")</code>を発行しても構いません。
このような配慮は、<span class="application">libpq</span>に限ったことではありません。
任意のSQLコマンドを実行するすべてのインタフェースに当てはまります。
    </p></div><p>

   </p><div class="warning"><h3 class="title">警告</h3><p>
<!--
     On Unix, forking a process with open libpq connections can lead to
     unpredictable results because the parent and child processes share
     the same sockets and operating system resources.  For this reason,
     such usage is not recommended, though doing an <function>exec</function> from
     the child process to load a new executable is safe.
-->
Unix上で、libpq接続を開いたプロセスのフォークは、親と子のプロセスが同じソケットとオペレーティングシステムの資源を共有するため、予期せぬ結果を招くことがあります。
この理由により、新規実行形式を子プロセスが読み込むため<code class="function">exec</code>を行うことが安全と言っても、このような使用方法は推奨されません。
    </p></div><p>

   </p><div class="note"><h3 class="title">注記</h3><p>
<!--
     On Windows, there is a way to improve performance if a single
     database connection is repeatedly started and shutdown.  Internally,
     libpq calls <function>WSAStartup()</function> and <function>WSACleanup()</function> for connection startup
     and shutdown, respectively.  <function>WSAStartup()</function> increments an internal
     Windows library reference count which is decremented by <function>WSACleanup()</function>.
     When the reference count is just one, calling <function>WSACleanup()</function> frees
     all resources and all DLLs are unloaded.  This is an expensive
     operation.  To avoid this, an application can manually call
     <function>WSAStartup()</function> so resources will not be freed when the last database
     connection is closed.
-->
Windowsでは、単一のデータベース接続が反復して開始と終了を繰り返す場合、性能を向上させる方法があります。
内部的には、接続開始と終了に対して、libpqはそれぞれ<code class="function">WSAStartup()</code>と<code class="function">WSACleanup()</code>を呼び出します。
<code class="function">WSAStartup()</code>は<code class="function">WSACleanup()</code>で値が減少させられた内部Windowsライブラリ参照カウントを増加させます。
参照カウントがたった１の場合、<code class="function">WSACleanup()</code>呼び出しはすべてのリソースを解放し、すべてのDLLはアンロードされます。
これは高価な操作です。
これを回避するには、最後のデータベース接続が閉じられる時、リソースが解放されないようにアプリケーションが手動で<code class="function">WSAStartup()</code>を呼び出すことができます。
    </p></div><p>

   </p><div class="variablelist"><dl class="variablelist"><dt id="LIBPQ-PQCONNECTDBPARAMS"><span class="term"><code class="function">PQconnectdbParams</code><a id="id-1.7.3.8.2.12.1.1.2" class="indexterm"></a></span></dt><dd><p>
<!--
       Makes a new connection to the database server.
-->
新たにデータベースサーバへの接続を作成します。

</p><pre class="synopsis">
PGconn *PQconnectdbParams(const char * const *keywords,
                          const char * const *values,
                          int expand_dbname);
</pre><p>
      </p><p>
<!--
       This function opens a new database connection using the parameters taken
       from two <symbol>NULL</symbol>-terminated arrays. The first,
       <literal>keywords</literal>, is defined as an array of strings, each one
       being a key word. The second, <literal>values</literal>, gives the value
       for each key word. Unlike <function>PQsetdbLogin</function> below, the parameter
       set can be extended without changing the function signature, so use of
       this function (or its nonblocking analogs <function>PQconnectStartParams</function>
       and <function>PQconnectPoll</function>) is preferred for new application
       programming.
-->
この関数は、2つの<code class="symbol">NULL</code>終端の配列から取得したパラメータを使用して、データベースとの接続を新たに1つ確立します。
1つ目は文字列配列として定義される<code class="literal">keywords</code>で、それぞれがキーワードとなります。
2つ目は<code class="literal">values</code>で、各キーワードの値を提供します。
後述の<code class="function">PQsetdbLogin</code>とは異なり、関数のシグネチャを変更せずにパラメータ集合を拡張できますので、アプリケーションプログラムを新たに作成する際には、この関数(もしくは非ブロックモードでよく似た処理をする<code class="function">PQconnectStartParams</code>と<code class="function">PQconnectPoll</code>)を使用することをお勧めします。
      </p><p>
<!--
       The currently recognized parameter key words are listed in
       <xref linkend="libpq-paramkeywords"/>.
-->
現在有効なパラメータキーワードを<a class="xref" href="libpq-connect.html#LIBPQ-PARAMKEYWORDS" title="34.1.2. パラメータキーワード">34.1.2</a>に示します。
      </p><p>
<!--
       When <literal>expand_dbname</literal> is non-zero, the
       <parameter>dbname</parameter> key word value is allowed to be recognized
       as a connection string. Only the first occurrence of
       <parameter>dbname</parameter> is expanded this way, any subsequent
       <parameter>dbname</parameter> value is processed as plain database name. More
       details on the possible connection string formats appear in
       <xref linkend="libpq-connstring"/>.
-->
<code class="literal">expand_dbname</code>が非ゼロの場合、<em class="parameter"><code>dbname</code></em>キーワードの値を接続文字列として認識させることができます。
最初に出現した<em class="parameter"><code>dbname</code></em>だけがこのように展開され、後続の<em class="parameter"><code>dbname</code></em>値は通常のデータベース名として処理されます。
接続文字列の取り得る書式に関する詳細については<a class="xref" href="libpq-connect.html#LIBPQ-CONNSTRING" title="34.1.1. 接続文字列">34.1.1</a>を参照してください。
      </p><p>
<!--
       The passed arrays can be empty to use all default parameters, or can
       contain one or more parameter settings. They should be matched in length.
       Processing will stop at the first <symbol>NULL</symbol> element
       in the <literal>keywords</literal> array.
-->
空の配列を渡してすべてデフォルトパラメータを使用することができます。
また渡される配列に1つ以上のパラメータ設定を持たせることもできます。
これらの長さは一致しなければなりません。
<code class="literal">keywords</code>配列の最初の<code class="symbol">NULL</code>要素で処理は停止します。
      </p><p>
<!--
       If  any  parameter is <symbol>NULL</symbol> or an empty string, the corresponding
       environment variable (see <xref linkend="libpq-envars"/>) is checked.
       If the  environment  variable is not set either, then the indicated
       built-in defaults are used.
-->
パラメータが<code class="symbol">NULL</code>や空文字列の場合には、対応する環境変数（<a class="xref" href="libpq-envars.html" title="34.14. 環境変数">34.14</a>参照）が検査されます。
環境変数も設定されていない場合は、組み込みのデフォルト値が使用されます。
      </p><p>
<!--
       In general key words are processed from the beginning of these arrays in index
       order. The effect of this is that when key words are repeated, the last processed
       value is retained. Therefore, through careful placement of the
       <parameter>dbname</parameter> key word, it is possible to determine what may
       be overridden by a <parameter>conninfo</parameter> string, and what may not.
-->
一般的にキーワードはこれらの配列の先頭からインデックス順で処理されます。
この影響はキーワードが繰り返された場合で、最後に処理された値が残ることになります。
このため、<em class="parameter"><code>dbname</code></em>キーワードの記述場所に注意することで、<em class="parameter"><code>conninfo</code></em>文字列により何が上書きされるか、何が上書きされないかを決定することができます。
      </p></dd><dt id="LIBPQ-PQCONNECTDB"><span class="term"><code class="function">PQconnectdb</code><a id="id-1.7.3.8.2.12.2.1.2" class="indexterm"></a></span></dt><dd><p>
<!--
       Makes a new connection to the database server.
-->
新たにデータベースサーバへの接続を作成します。

</p><pre class="synopsis">
PGconn *PQconnectdb(const char *conninfo);
</pre><p>
      </p><p>
<!--
       This function opens a new database connection using the parameters taken
       from the string <literal>conninfo</literal>.
-->
この関数は<code class="literal">conninfo</code>文字列から取得されるパラメータを使用して、新しいデータベース接続を開きます。
      </p><p>
<!--
       The passed string can be empty to use all default parameters, or it can
       contain one or more parameter settings separated by whitespace,
       or it can contain a <acronym>URI</acronym>.
       See <xref linkend="libpq-connstring"/> for details.
-->
空の文字列を渡してすべてデフォルトパラメータを使用することができます。
また空白文字で区切ることで1つ以上のパラメータ設定を持たせることもできます。
さらに<acronym class="acronym">URI</acronym>を含めることができます。
詳細については<a class="xref" href="libpq-connect.html#LIBPQ-CONNSTRING" title="34.1.1. 接続文字列">34.1.1</a>を参照してください。
     </p></dd><dt id="LIBPQ-PQSETDBLOGIN"><span class="term"><code class="function">PQsetdbLogin</code><a id="id-1.7.3.8.2.12.3.1.2" class="indexterm"></a></span></dt><dd><p>
<!--
       Makes a new connection to the database server.
-->
新たにデータベースサーバへの接続を作成します。
</p><pre class="synopsis">
PGconn *PQsetdbLogin(const char *pghost,
                     const char *pgport,
                     const char *pgoptions,
                     const char *pgtty,
                     const char *dbName,
                     const char *login,
                     const char *pwd);
</pre><p>
       </p><p>
<!--
        This is the predecessor of <function>PQconnectdb</function> with a fixed
        set of parameters.  It has the same functionality except that the
        missing parameters will always take on default values.  Write <symbol>NULL</symbol> or an
        empty string for any one of the fixed parameters that is to be defaulted.
-->
これはパラメータ群を固定した<code class="function">PQconnectdb</code>の前身です。
設定できないパラメータが常にデフォルト値になる点を除き、同一の機能を持ちます。
固定のパラメータに対して<code class="symbol">NULL</code>もしくは空文字列とすると、それはデフォルトを使用することになります。
      </p><p>
<!--
        If the <parameter>dbName</parameter> contains
        an <symbol>=</symbol> sign or has a valid connection <acronym>URI</acronym> prefix, it
        is taken as a <parameter>conninfo</parameter> string in exactly the same way as
        if it had been passed to <function>PQconnectdb</function>, and the remaining
        parameters are then applied as specified for <function>PQconnectdbParams</function>.
-->
<em class="parameter"><code>dbName</code></em>内に<code class="symbol">=</code>記号が含まれる場合、または有効な接続<acronym class="acronym">URI</acronym>接頭辞を持つ場合、<code class="function">PQconnectdb</code>に渡された場合とまったく同じ扱いで<em class="parameter"><code>conninfo</code></em>文字列として扱われます。
その後残りのパラメータが<code class="function">PQconnectdbParams</code>の指定のように適用されます。
      </p></dd><dt id="LIBPQ-PQSETDB"><span class="term"><code class="function">PQsetdb</code><a id="id-1.7.3.8.2.12.4.1.2" class="indexterm"></a></span></dt><dd><p>
<!--
   Makes a new connection to the database server.
-->
新たにデータベースサーバへの接続を作成します。
</p><pre class="synopsis">
PGconn *PQsetdb(char *pghost,
                char *pgport,
                char *pgoptions,
                char *pgtty,
                char *dbName);
</pre><p>
     </p><p>
<!--
      This is a macro that calls <function>PQsetdbLogin</function> with null pointers
      for the <parameter>login</parameter> and <parameter>pwd</parameter> parameters.  It is provided
      for backward compatibility with very old programs.
-->
これは、<em class="parameter"><code>login</code></em>と<em class="parameter"><code>pwd</code></em>にNULLポインタを設定する<code class="function">PQsetdbLogin</code>を呼び出すマクロです。
非常に古いプログラムへの後方互換性のために提供されています。
     </p></dd><dt id="LIBPQ-PQCONNECTSTARTPARAMS"><span class="term"><code class="function">PQconnectStartParams</code><a id="id-1.7.3.8.2.12.5.1.2" class="indexterm"></a><br /></span><span class="term"><code class="function">PQconnectStart</code><a id="id-1.7.3.8.2.12.5.2.2" class="indexterm"></a><br /></span><span class="term"><code class="function">PQconnectPoll</code><a id="id-1.7.3.8.2.12.5.3.2" class="indexterm"></a></span></dt><dd><p>
<!--
       <indexterm><primary>nonblocking connection</primary></indexterm>
-->
       <a id="id-1.7.3.8.2.12.5.4.1.1" class="indexterm"></a>
<!--
       Make a connection to the database server in a nonblocking manner.
-->
ブロックしない方法で、データベースサーバへの接続を作成します。

</p><pre class="synopsis">
PGconn *PQconnectStartParams(const char * const *keywords,
                             const char * const *values,
                             int expand_dbname);

PGconn *PQconnectStart(const char *conninfo);

PostgresPollingStatusType PQconnectPoll(PGconn *conn);
</pre><p>
      </p><p>
<!--
       These three functions are used to open a connection to a database server such
       that your application's thread of execution is not blocked on remote I/O
       whilst doing so. The point of this approach is that the waits for I/O to
       complete can occur in the application's main loop, rather than down inside
       <function>PQconnectdbParams</function> or <function>PQconnectdb</function>, and so the
       application can manage this operation in parallel with other activities.
-->
これら3つの関数は、リモートI/Oの実行時にアプリケーションスレッドの実行がブロックされないようなデータベースサーバへの接続を作成するために使われます。
この手法の利点は、I/Oの終了待ちが<code class="function">PQconnectdbParams</code>または<code class="function">PQconnectdb</code>内部ではなく、アプリケーションプログラムのメインループでできることにあります。
これによって、アプリケーションは他の処理と並行してこの処理を管理することができます。
      </p><p>
<!--
       With <function>PQconnectStartParams</function>, the database connection is made
       using the parameters taken from the <literal>keywords</literal> and
       <literal>values</literal> arrays, and controlled by <literal>expand_dbname</literal>,
       as described above for <function>PQconnectdbParams</function>.
-->
<code class="function">PQconnectStartParams</code>では、上で<code class="function">PQconnectdbParams</code>で説明したように、データベース接続は<code class="literal">keywords</code>および<code class="literal">values</code>配列から取得され、<code class="literal">expand_dbname</code>によって制御されたパラメータを使用して確立します。
      </p><p>
<!--
       With <function>PQconnectStart</function>, the database connection is made
       using the parameters taken from the string <literal>conninfo</literal> as
       described above for <function>PQconnectdb</function>.
-->
<code class="function">PQconnectStart</code>では、上で<code class="function">PQconnectdb</code>で説明したように、<code class="literal">conninfo</code>文字列から取得されたパラメータを使用してデータベース接続を確立します。
      </p><p>
<!--
       Neither <function>PQconnectStartParams</function> nor <function>PQconnectStart</function>
       nor <function>PQconnectPoll</function> will block, so long as a number of
       restrictions are met:
-->
<code class="function">PQconnectStartParams</code>、<code class="function">PQconnectStart</code>と<code class="function">PQconnectPoll</code>のどちらも以下の制限に適合する場合ブロックしません。
       </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
<!--
          The <literal>hostaddr</literal> parameter must be used appropriately
          to prevent DNS queries from being made.  See the documentation of
          this parameter in <xref linkend="libpq-paramkeywords"/> for details.
-->
<code class="literal">hostaddr</code>パラメータは、DNS問い合わせが発生するのを防ぐように適切に使用されなければいけません。
詳細については<a class="xref" href="libpq-connect.html#LIBPQ-PARAMKEYWORDS" title="34.1.2. パラメータキーワード">34.1.2</a>内のパラメータ説明を参照してください。
         </p></li><li class="listitem"><p>
<!--
          If you call <function>PQtrace</function>, ensure that the stream object
          into which you trace will not block.
-->
<code class="function">PQtrace</code>を呼び出す場合は、トレースに使用するストリームオブジェクトがブロックされないことが保証されていなくてはなりません。
         </p></li><li class="listitem"><p>
<!--
          You must ensure that the socket is in the appropriate state
          before calling <function>PQconnectPoll</function>, as described below.
-->
プログラマ自身が、後に示すように、<code class="function">PQconnectPoll</code>を呼び出す前にソケットが適切な状態にあることを保証しなくてはいけません。
         </p></li></ul></div><p>
      </p><p>
<!--
       To begin a nonblocking connection request,
       call <function>PQconnectStart</function>
       or <function>PQconnectStartParams</function>.  If the result is null,
       then <application>libpq</application> has been unable to allocate a
       new <structname>PGconn</structname> structure.  Otherwise, a
       valid <structname>PGconn</structname> pointer is returned (though not
       yet representing a valid connection to the database).  Next
       call <literal>PQstatus(conn)</literal>.  If the result
       is <symbol>CONNECTION_BAD</symbol>, the connection attempt has already
       failed, typically because of invalid connection parameters.
-->
非ブロック接続要求を始めるにはまず、<code class="literal">PQconnectStart</code>か<code class="function">PQconnectStartParams</code>を呼び出します。
その結果がNULLの場合、<span class="application">libpq</span>は新たな<code class="structname">PGconn</code>構造体を割り当てられませんでした。
そうでない場合は、適切な<code class="structname">PGconn</code>へのポインタが返されます
（ただし、未だデータベースへの有効な接続を示しているわけではありません）。
次に<code class="literal">PQstatus(conn)</code>を呼び出します。
もし、結果が<code class="symbol">CONNECTION_BAD</code>であった場合、接続の試みは失敗しています。典型的には無効な接続パラメータに因ります。
      </p><p>
<!--
       If <function>PQconnectStart</function>
       or <function>PQconnectStartParams</function> succeeds, the next stage
       is to poll <application>libpq</application> so that it can proceed with
       the connection sequence.
       Use <function>PQsocket(conn)</function> to obtain the descriptor of the
       socket underlying the database connection.
       (Caution: do not assume that the socket remains the same
       across <function>PQconnectPoll</function> calls.)
       Loop thus: If <function>PQconnectPoll(conn)</function> last returned
       <symbol>PGRES_POLLING_READING</symbol>, wait until the socket is ready to
       read (as indicated by <function>select()</function>, <function>poll()</function>, or
       similar system function).
       Then call <function>PQconnectPoll(conn)</function> again.
       Conversely, if <function>PQconnectPoll(conn)</function> last returned
       <symbol>PGRES_POLLING_WRITING</symbol>, wait until the socket is ready
       to write, then call <function>PQconnectPoll(conn)</function> again.
       On the first iteration, i.e. if you have yet to call
       <function>PQconnectPoll</function>, behave as if it last returned
       <symbol>PGRES_POLLING_WRITING</symbol>.  Continue this loop until
       <function>PQconnectPoll(conn)</function> returns
       <symbol>PGRES_POLLING_FAILED</symbol>, indicating the connection procedure
       has failed, or <symbol>PGRES_POLLING_OK</symbol>, indicating the connection
       has been successfully made.
-->
<code class="function">PQconnectStart</code>あるいは<code class="function">PQconnectStartParams</code>が成功したら、次は接続シーケンスを進めるために、<span class="application">libpq</span>をポーリングします。
データベース接続の背後にあるソケットの記述子を取り出すには、<code class="function">PQsocket(conn)</code>を使用します。
（注意：複数の<code class="function">PQconnectPoll</code>呼び出しでソケットが同じままであると思わないでください。）
以下の繰り返しです。
直前の<code class="function">PQconnectPoll(conn)</code>が<code class="symbol">PGRES_POLLING_READING</code>の場合、（<code class="function">select()</code>や<code class="function">poll()</code>などのシステム関数で示されて）ソケットの読み込み準備が整うまで待機します。
そして、再度<code class="function">PQconnectPoll(conn)</code>を呼び出します。
反対に直前の<code class="function">PQconnectPoll(conn)</code>が<code class="symbol">PGRES_POLLING_WRITING</code>の場合、ソケットの書き込み準備が整うまで待機し、その後、<code class="function">PQconnectPoll(conn)</code>を再度呼び出します。
繰り返しの最初、すなわち、未だ<code class="function">PQconnectPoll</code>を呼び出していない場合、最後に<code class="symbol">PGRES_POLLING_WRITING</code>を返したかのように振舞います。
この繰り返しを<code class="function">PQconnectPoll(conn)</code>が、接続手続きの失敗を示す<code class="symbol">PGRES_POLLING_FAILED</code>、もしくは、接続確立に成功したことを示す<code class="symbol">PGRES_POLLING_OK</code>を返すまで継続します。
      </p><p>
<!--
       At any time during connection, the status of the connection can be
       checked by calling <function>PQstatus</function>. If this call returns <symbol>CONNECTION_BAD</symbol>, then the
       connection procedure has failed; if the call returns <function>CONNECTION_OK</function>, then the
       connection is ready.  Both of these states are equally detectable
       from the return value of <function>PQconnectPoll</function>, described above. Other states might also occur
       during (and only during) an asynchronous connection procedure. These
       indicate the current stage of the connection procedure and might be useful
       to provide feedback to the user for example. These statuses are:
-->
接続している間は、いつでも<code class="function">PQstatus</code>を呼び出すことで、接続の状態を検査することができます。
この関数呼び出しが<code class="symbol">CONNECTION_BAD</code>を返す場合、接続手続きは失敗しており、<code class="symbol">CONNECTION_OK</code>を返す場合、接続が確立しています。
上述のように、このいずれの状態も、<code class="function">PQconnectPoll</code>の戻り値から同様に検出できます。
これ以外の状態は、非同期の接続手続きの間（のみに）現れることがあります。
これらは、接続手続きの現在の段階を示すものであり、例えばユーザへのフィードバックを提供することに使用できます。
以下の状態があります。

       </p><div class="variablelist"><dl class="variablelist"><dt id="LIBPQ-CONNECTION-STARTED"><span class="term"><code class="symbol">CONNECTION_STARTED</code></span></dt><dd><p>
<!--
           Waiting for connection to be made.
-->
接続の確立待ち状態です。
          </p></dd><dt id="LIBPQ-CONNECTION-MADE"><span class="term"><code class="symbol">CONNECTION_MADE</code></span></dt><dd><p>
<!--
           Connection OK; waiting to send.
-->
接続はOKです。送信待ち状態です。
          </p></dd><dt id="LIBPQ-CONNECTION-AWAITING-RESPONSE"><span class="term"><code class="symbol">CONNECTION_AWAITING_RESPONSE</code></span></dt><dd><p>
<!--
           Waiting for a response from the server.
-->
サーバからの応答待ち状態です。
          </p></dd><dt id="LIBPQ-CONNECTION-AUTH-OK"><span class="term"><code class="symbol">CONNECTION_AUTH_OK</code></span></dt><dd><p>
<!--
           Received authentication; waiting for backend start-up to finish.
-->
        認証済みです。バックエンドの起動待ち状態です。
          </p></dd><dt id="LIBPQ-CONNECTION-SSL-STARTUP"><span class="term"><code class="symbol">CONNECTION_SSL_STARTUP</code></span></dt><dd><p>
<!--
           Negotiating SSL encryption.
-->
SSL暗号化の調停状態です。
          </p></dd><dt id="LIBPQ-CONNECTION-SETENV"><span class="term"><code class="symbol">CONNECTION_SETENV</code></span></dt><dd><p>
<!--
           Negotiating environment-driven parameter settings.
-->
環境が提供するパラメータ設定の調停状態です。
          </p></dd><dt id="LIBPQ-CONNECTION-CHECK-WRITABLE"><span class="term"><code class="symbol">CONNECTION_CHECK_WRITABLE</code></span></dt><dd><p>
<!--
           Checking if connection is able to handle write transactions.
-->
接続が書き込みトランザクションを扱えるかどうかを調べています。
          </p></dd><dt id="LIBPQ-CONNECTION-CONSUME"><span class="term"><code class="symbol">CONNECTION_CONSUME</code></span></dt><dd><p>
<!--
           Consuming any remaining response messages on connection.
-->
接続の残りの応答メッセージを消費しています。
          </p></dd></dl></div><p>

<!--
       Note that, although these constants will remain (in order to maintain
       compatibility), an application should never rely upon these occurring in a
       particular order, or at all, or on the status always being one of these
       documented values. An application might do something like this:
-->
これらの定数は（互換性を保つため）なくなることはありませんが、アプリケーションは、これらが特定の順で出現したり、本書に書いてある値のどれかに必ずステータス値が該当するということを決して当てにしてはいけません。
アプリケーションは、以下に示すようにするべきです。

</p><pre class="programlisting">
switch(PQstatus(conn))
{
        case CONNECTION_STARTED:
            feedback = "Connecting...";
            break;

        case CONNECTION_MADE:
            feedback = "Connected to server...";
            break;
.
.
.
        default:
            feedback = "Connecting...";
}
</pre><p>
      </p><p>
<!--
       The <literal>connect_timeout</literal> connection parameter is ignored
       when using <function>PQconnectPoll</function>; it is the application's
       responsibility to decide whether an excessive amount of time has elapsed.
       Otherwise, <function>PQconnectStart</function> followed by a
       <function>PQconnectPoll</function> loop is equivalent to
       <function>PQconnectdb</function>.
-->
<code class="function">PQconnectPoll</code>を使用する場合、<code class="literal">connect_timeout</code>接続パラメータは無視されます。
経過時間が長過ぎるかどうかの判定はアプリケーションの責任で行ないます。
さもないと、<code class="function">PQconnectStart</code>の後の<code class="function">PQconnectPoll</code>の繰り返しが<code class="function">PQconnectdb</code>と同じになります。
      </p><p>
<!--
       Note that when <function>PQconnectStart</function>
       or <function>PQconnectStartParams</function> returns a non-null
       pointer, you must call <function>PQfinish</function> when you are
       finished with it, in order to dispose of the structure and any
       associated memory blocks.  This must be done even if the connection
       attempt fails or is abandoned.
-->
<code class="function">PQconnectStart</code>や<code class="function">PQconnectStartParams</code>が非NULLポインタを返した場合、処理を終了する際には、構造体や関連するメモリブロックを始末するために、<code class="function">PQfinish</code>を呼び出さなくてはならないことに注意してください。
この処理は、接続試行が失敗した場合やその試行を中断する場合にも、必ず実行されなければいけません。
      </p></dd><dt id="LIBPQ-PQCONNDEFAULTS"><span class="term"><code class="function">PQconndefaults</code><a id="id-1.7.3.8.2.12.6.1.2" class="indexterm"></a></span></dt><dd><p>
<!--
       Returns the default connection options.
-->
デフォルトの接続オプションを返します。
</p><pre class="synopsis">
PQconninfoOption *PQconndefaults(void);

typedef struct
{
<!--
    char   *keyword;   /* The keyword of the option */
    char   *envvar;    /* Fallback environment variable name */
    char   *compiled;  /* Fallback compiled in default value */
    char   *val;       /* Option's current value, or NULL */
    char   *label;     /* Label for field in connect dialog */
    char   *dispchar;  /* Indicates how to display this field
                          in a connect dialog. Values are:
                          ""        Display entered value as is
                          "*"       Password field - hide value
                          "D"       Debug option - don't show by default */
    int     dispsize;  /* Field size in characters for dialog */
-->
    char   *keyword;   /* このオプションのキーワード */
    char   *envvar;    /* 代替となる環境変数の名前 */
    char   *compiled;  /* 代替となるコンパイル時に組み込まれたデフォルト値 */
    char   *val;       /* オプションの現在値、もしくは、NULL */
    char   *label;     /* 接続ダイアログ内の当該フィールドのラベル */
    char   *dispchar;  /* 接続ダイアログ内の当該フィールドをどのように表示するかの指示
                          値:
                          ""        入力された値をそのまま表示
                          "*"       値を隠すパスワードフィールド用
                          "D"       デバッグオプション。デフォルトで何も表示しません */
    int     dispsize;  /* ダイアログ用のフィールドの大きさ(文字数単位) */
} PQconninfoOption;
</pre><p>
      </p><p>
<!--
       Returns a connection options array.  This can be used to determine
       all possible <function>PQconnectdb</function> options and their
       current default values.  The return value points to an array of
       <structname>PQconninfoOption</structname> structures, which ends
       with an entry having a null <structfield>keyword</structfield> pointer.  The
       null pointer is returned if memory could not be allocated. Note that
       the current default values (<structfield>val</structfield> fields)
       will depend on environment variables and other context.  A
       missing or invalid service file will be silently ignored.  Callers
       must treat the connection options data as read-only.
-->
接続オプションの配列を返します。
これは、使用可能な<code class="function">PQconnectdb</code>用オプションのすべてや、その時点でのデフォルト値を決定するために使用することができます。
戻り値は、<code class="structname">PQconninfoOption</code>構造体の配列へのポインタで、<code class="structfield">keyword</code>ポインタがヌルとなる項目が配列の末尾にきます。
メモリが確保できなかった場合にはヌルポインタを返します。
現在のデフォルト値(<code class="structfield">val</code> フィールド）は、環境変数や他のコンテキストに依存します。
呼び出し側では、接続オプションの情報は、読み込み専用として取り扱わなければいけません。
      </p><p>
<!--
       After processing the options array, free it by passing it to
       <function>PQconninfoFree</function>.  If this is not done, a small amount of memory
       is leaked for each call to <function>PQconndefaults</function>.
-->
オプションの配列を処理した後は、それを<code class="function">PQconninfoFree</code>に渡して解放します。
この処理をしないと、<code class="function">PQconndefaults</code>が呼び出されるたびに少しずつメモリリークが発生します。
      </p></dd><dt id="LIBPQ-PQCONNINFO"><span class="term"><code class="function">PQconninfo</code><a id="id-1.7.3.8.2.12.7.1.2" class="indexterm"></a></span></dt><dd><p>
<!--
       Returns the connection options used by a live connection.
-->
所在する接続で使用される接続オプションを返します。
</p><pre class="synopsis">
PQconninfoOption *PQconninfo(PGconn *conn);
</pre><p>
      </p><p>
<!--
       Returns a connection options array.  This can be used to determine
       all possible <function>PQconnectdb</function> options and the
       values that were used to connect to the server. The return
       value points to an array of <structname>PQconninfoOption</structname>
       structures, which ends with an entry having a null <structfield>keyword</structfield>
       pointer. All notes above for <function>PQconndefaults</function> also
       apply to the result of <function>PQconninfo</function>.
-->
接続オプション配列を返します。これは全ての可能性のある<code class="function">PQconnectdb</code>オプションとサーバに接続するのに使用される値を確定するために使用することができます。
返り値は<code class="structname">PQconninfoOption</code>構造体の配列を指し示します。それはnull <code class="structfield">keyword</code> ポインタを持つ項目で終結します。<code class="function">PQconndefaults</code>に対する上記の全ての注釈はまた<code class="function">PQconninfo</code>の結果に適用されます。
      </p></dd><dt id="LIBPQ-PQCONNINFOPARSE"><span class="term"><code class="function">PQconninfoParse</code><a id="id-1.7.3.8.2.12.8.1.2" class="indexterm"></a></span></dt><dd><p>
<!--
       Returns parsed connection options from the provided connection string.
-->
提供された接続文字列から構文解析された接続オプションを返します。

</p><pre class="synopsis">
PQconninfoOption *PQconninfoParse(const char *conninfo, char **errmsg);
</pre><p>
      </p><p>
<!--
       Parses a connection string and returns the resulting options as an
       array; or returns <symbol>NULL</symbol> if there is a problem with the connection
       string.  This function can be used to extract
       the <function>PQconnectdb</function> options in the provided
       connection string.  The return value points to an array of
       <structname>PQconninfoOption</structname> structures, which ends
       with an entry having a null <structfield>keyword</structfield> pointer.
-->
接続文字列の構文解析を行い、配列として結果オプションを返すか、または接続文字列に問題があった場合に<code class="symbol">NULL</code>を返します。
この関数を提供された接続文字列の中の<code class="function">PQconnectdb</code>オプションを取り出すために使用することができます。
戻り値は<code class="structname">PQconninfoOption</code>構造体の配列を指し示し、それはヌルの<code class="structfield">keyword</code>ポインタを持つ項目で終結します。
      </p><p>
<!--
       All legal options will be present in the result array, but the
       <literal>PQconninfoOption</literal> for any option not present
       in the connection string will have <literal>val</literal> set to
       <literal>NULL</literal>; default values are not inserted.
-->
正規なオプションはすべて、結果配列内に現れます。
しかし接続文字列内に現れない、何らかのオプション用の<code class="literal">PQconninfoOption</code>は<code class="literal">NULL</code>に設定された<code class="literal">val</code>を持ちます。
デフォルトは挿入されません。
      </p><p>
<!--
       If <literal>errmsg</literal> is not <symbol>NULL</symbol>, then <literal>*errmsg</literal> is set
       to <symbol>NULL</symbol> on success, else to a <function>malloc</function>'d error string explaining
       the problem.  (It is also possible for <literal>*errmsg</literal> to be
       set to <symbol>NULL</symbol> and the function to return <symbol>NULL</symbol>;
       this indicates an out-of-memory condition.)
-->
<code class="literal">errmsg</code>が非<code class="symbol">NULL</code>であれば、成功した場合<code class="literal">*errmsg</code>は<code class="symbol">NULL</code>に設定され、そうでなければ、問題を説明した<code class="function">malloc</code>されたエラー文字列になります。
（<code class="literal">*errmsg</code>が<code class="symbol">NULL</code>に設定され、かつ、この関数が<code class="symbol">NULL</code>を返すこともあり得ます。
これはメモリ不足状態を意味します。）
      </p><p>
<!--
       After processing the options array, free it by passing it to
       <function>PQconninfoFree</function>.  If this is not done, some memory
       is leaked for each call to <function>PQconninfoParse</function>.
       Conversely, if an error occurs and <literal>errmsg</literal> is not <symbol>NULL</symbol>,
       be sure to free the error string using <function>PQfreemem</function>.
-->
オプション配列を処理した後、それを<code class="function">PQconninfoFree</code>に渡して解放してください。
これが行われない場合、<code class="function">PQconninfoParse</code>へのそれぞれの呼び出しに対してメモリーリークが起こります。
反対に、エラーが起こり、そして<code class="literal">errmsg</code>が非<code class="symbol">NULL</code>であれば、<code class="function">PQfreemem</code>を使用してエラー文字列を必ず解放してください。
      </p></dd><dt id="LIBPQ-PQFINISH"><span class="term"><code class="function">PQfinish</code><a id="id-1.7.3.8.2.12.9.1.2" class="indexterm"></a></span></dt><dd><p>
<!--
       Closes  the  connection to the server.  Also frees
       memory used by the <structname>PGconn</structname> object.
-->
サーバとの接続を閉ざします。
また、<code class="structname">PGconn</code>オブジェクトが占めるメモリも解放します。
</p><pre class="synopsis">
void PQfinish(PGconn *conn);
</pre><p>
      </p><p>
<!--
       Note that even if the server connection attempt fails (as
       indicated by <function>PQstatus</function>), the application should call <function>PQfinish</function>
       to free the memory used by the <structname>PGconn</structname> object.
       The <structname>PGconn</structname> pointer must not be used again after
       <function>PQfinish</function> has been called.
-->
たとえサーバへの接続試行が失敗しても（<code class="function">PQstatus</code>で調べます）、アプリケーションは<code class="function">PQfinish</code>を呼び出し<code class="structname">PGconn</code>オブジェクトが占めるメモリを解放するべきです。
そして<code class="function">PQfinish</code>を呼び出したら、もう<code class="structname">PGconn</code>へのポインタを使ってはいけません。
      </p></dd><dt id="LIBPQ-PQRESET"><span class="term"><code class="function">PQreset</code><a id="id-1.7.3.8.2.12.10.1.2" class="indexterm"></a></span></dt><dd><p>
<!--
       Resets the communication channel to the server.
-->
サーバへの通信チャンネルをリセットします。
</p><pre class="synopsis">
void PQreset(PGconn *conn);
</pre><p>
      </p><p>
<!--
       This function will close the connection
       to the server and attempt to  reestablish  a  new
       connection to the same server, using all the same
       parameters previously used.  This might be useful for
       error recovery if a working connection is lost.
-->
この関数はサーバへの接続を閉じ、以前使用したパラメータをすべて使用して、同一のサーバへ新しく接続を確立します。
これは、作業中の接続が失われた場合のエラーの修復に役立つでしょう。
      </p></dd><dt id="LIBPQ-PQRESETSTART"><span class="term"><code class="function">PQresetStart</code><a id="id-1.7.3.8.2.12.11.1.2" class="indexterm"></a><br /></span><span class="term"><code class="function">PQresetPoll</code><a id="id-1.7.3.8.2.12.11.2.2" class="indexterm"></a></span></dt><dd><p>
<!--
       Reset the communication channel to the server, in a nonblocking manner.
-->
非ブロッキング方式で、サーバへの接続チャンネルをリセットします。

</p><pre class="synopsis">
int PQresetStart(PGconn *conn);

PostgresPollingStatusType PQresetPoll(PGconn *conn);
</pre><p>
      </p><p>
<!--
       These functions will close the connection to the server and attempt to
       reestablish a new connection to the same server, using all the same
       parameters previously used. This can be useful for error recovery if a
       working connection is lost. They differ from <function>PQreset</function> (above) in that they
       act in a nonblocking manner. These functions suffer from the same
       restrictions as <function>PQconnectStartParams</function>, <function>PQconnectStart</function>
       and <function>PQconnectPoll</function>.
-->
これらの関数はサーバへの接続を閉じ、それから再度、以前使用したパラメータをすべて使用して、同じサーバと新たな接続を確立しようとします。
これらは作業中の接続が失われた場合のエラー修復に役立つでしょう。
<code class="function">PQreset</code>（前述）との違いは、この2つの関数が非ブロック方式で動作することです。
また、これらの関数は<code class="function">PQconnectStartParams</code>、<code class="function">PQconnectStart</code>および<code class="function">PQconnectPoll</code>と同じ制限を受けます。
      </p><p>
<!--
       To initiate a connection reset, call
       <function>PQresetStart</function>. If it returns 0, the reset has
       failed. If it returns 1, poll the reset using
       <function>PQresetPoll</function> in exactly the same way as you
       would create the connection using <function>PQconnectPoll</function>.
-->
接続のリセットを始めるためには<code class="function">PQresetStart</code>を呼び出します。
この関数がゼロを返す場合、リセットに失敗しています。
戻り値が1ならば、<code class="function">PQconnectPoll</code>を使って接続を確立した時とまったく同じに、<code class="function">PQresetPoll</code>を使用してリセットのポーリングを行います。
      </p></dd><dt id="LIBPQ-PQPINGPARAMS"><span class="term"><code class="function">PQpingParams</code><a id="id-1.7.3.8.2.12.12.1.2" class="indexterm"></a></span></dt><dd><p>
<!--
       <function>PQpingParams</function> reports the status of the
       server.  It accepts connection parameters identical to those of
       <function>PQconnectdbParams</function>, described above.  It is not
       necessary to supply correct user name, password, or database name
       values to obtain the server status; however, if incorrect values
       are provided, the server will log a failed connection attempt.
-->
<code class="function">PQpingParams</code>はサーバの状態を報告します。
この関数は上述の<code class="function">PQconnectdbParams</code>と同じ接続パラメータを受け付けます。
サーバの状態を得るために正しいユーザ名、パスワード、データベース名を提供する必要はありません。
しかし、不適切な値が供給されると、サーバは不成功に終わった接続の試みをログに残します。

</p><pre class="synopsis">
PGPing PQpingParams(const char * const *keywords,
                    const char * const *values,
                    int expand_dbname);
</pre><p>

<!--
       The function returns one of the following values:
-->
このサーバは以下の値のいずれかを返します。

       </p><div class="variablelist"><dl class="variablelist"><dt id="LIBPQ-PQPINGPARAMS-PQPING-OK"><span class="term"><code class="literal">PQPING_OK</code></span></dt><dd><p>
<!--
           The server is running and appears to be accepting connections.
-->
サーバは稼動中で、接続を受け付けているようです。
          </p></dd><dt id="LIBPQ-PQPINGPARAMS-PQPING-REJECT"><span class="term"><code class="literal">PQPING_REJECT</code></span></dt><dd><p>
<!--
           The server is running but is in a state that disallows connections
           (startup, shutdown, or crash recovery).
-->
サーバは稼動中ですが、接続を許可しない状態（起動処理中、停止処理中、クラッシュリカバリ中）です。
          </p></dd><dt id="LIBPQ-PQPINGPARAMS-PQPING-NO-RESPONSE"><span class="term"><code class="literal">PQPING_NO_RESPONSE</code></span></dt><dd><p>
<!--
           The server could not be contacted.  This might indicate that the
           server is not running, or that there is something wrong with the
           given connection parameters (for example, wrong port number), or
           that there is a network connectivity problem (for example, a
           firewall blocking the connection request).
-->
サーバと通信できません。
これは、サーバが稼動中ではない、指定した接続パラメータの何か（例えばポート番号の間違い）が間違っている、ネットワーク接続性の問題（例えば接続要求をブロックするファイアウォール）があることを示しているかもしれません。
          </p></dd><dt id="LIBPQ-PQPINGPARAMS-PQPING-NO-ATTEMPT"><span class="term"><code class="literal">PQPING_NO_ATTEMPT</code></span></dt><dd><p>
<!--
           No attempt was made to contact the server, because the supplied
           parameters were obviously incorrect or there was some client-side
           problem (for example, out of memory).
-->
指定されたパラメータが明らかに間違っている、または、（メモリ不足など）クライアント側の問題があったため、サーバとの通信を試行しませんでした。
          </p></dd></dl></div><p>

      </p></dd><dt id="LIBPQ-PQPING"><span class="term"><code class="function">PQping</code><a id="id-1.7.3.8.2.12.13.1.2" class="indexterm"></a></span></dt><dd><p>
<!--
       <function>PQping</function> reports the status of the
       server.  It accepts connection parameters identical to those of
       <function>PQconnectdb</function>, described above.  It is not
       necessary to supply correct user name, password, or database name
       values to obtain the server status; however, if incorrect values
       are provided, the server will log a failed connection attempt.
-->
<code class="function">PQping</code>はサーバの状態を報告します。
この関数は上述の<code class="function">PQconnectdb</code>と同じ接続パラメータを受け付けます。
サーバの状態を得るために正しいユーザ名、パスワード、データベース名を提供する必要はありません。
しかし、不適切な値が供給されると、サーバは不成功に終わった接続の試みをログに残します。

</p><pre class="synopsis">
PGPing PQping(const char *conninfo);
</pre><p>
      </p><p>
<!--
       The return values are the same as for <function>PQpingParams</function>.
-->
戻り値は<code class="function">PQpingParams</code>と同じです。
      </p></dd></dl></div><p>
  </p><div class="sect2" id="LIBPQ-CONNSTRING"><div class="titlepage"><div><div><h3 class="title">34.1.1. 接続文字列</h3></div></div></div><!--
   <title>Connection Strings</title>
--><a id="id-1.7.3.8.3.2" class="indexterm"></a><a id="id-1.7.3.8.3.3" class="indexterm"></a><p>
<!--
    Several <application>libpq</application> functions parse a user-specified string to obtain
    connection parameters.  There are two accepted formats for these strings:
    plain <literal>keyword = value</literal> strings
    and URIs.  URIs generally follow
    <ulink url="https://tools.ietf.org/html/rfc3986">RFC
    3986</ulink>, except that multi-host connection strings are allowed
    as further described below.
-->
複数の<span class="application">libpq</span>関数は、接続パラメータを得るためにユーザが指定した文字列の解析を行います。
この文字列として、単純な<code class="literal">keyword = value</code>文字列とURIという２種類の書式が受け付けられます。
URIは通常<a class="ulink" href="https://tools.ietf.org/html/rfc3986" target="_top">RFC3986</a>に従いますが、以下で詳細を説明する複数ホスト接続文字列が使用できるところが例外です。
   </p><div class="sect3" id="id-1.7.3.8.3.5"><div class="titlepage"><div><div><h4 class="title">34.1.1.1. キーワード/値形式の接続文字列</h4></div></div></div><!--
    <title>Keyword/Value Connection Strings</title>
--><p>
<!--
    In the first format, each parameter setting is in the form
    <literal>keyword = value</literal>.  Spaces around the equal sign are
    optional. To write an empty value, or a value containing spaces, surround it
    with single quotes, e.g., <literal>keyword = 'a value'</literal>. Single
    quotes and backslashes within
    the value must be escaped with a backslash, i.e., <literal>\'</literal> and
    <literal>\\</literal>.
-->
最初の書式では、各パラメータ設定は<code class="literal">keyword = value</code>という形式です。
等号記号の前後の空白文字は省略可能です。
空の値を書く、または空白文字を含む値を書くためには、<code class="literal">keyword = 'a value'</code>のように単一引用符で値を括ります。
値内部の単一引用符とバックスラッシュはバックスラッシュでエスケープしなければなりません。
つまり<code class="literal">\'</code>と<code class="literal">\\</code>です。
   </p><p>
<!--
    Example:
-->
以下に例を示します。
</p><pre class="programlisting">
host=localhost port=5432 dbname=mydb connect_timeout=10
</pre><p>
   </p><p>
<!--
    The recognized parameter key words are listed in <xref
    linkend="libpq-paramkeywords"/>.
-->
有効なパラメータキーワードを<a class="xref" href="libpq-connect.html#LIBPQ-PARAMKEYWORDS" title="34.1.2. パラメータキーワード">34.1.2</a>に示します。
   </p></div><div class="sect3" id="id-1.7.3.8.3.6"><div class="titlepage"><div><div><h4 class="title">34.1.1.2. 接続URI</h4></div></div></div><!--
    <title>Connection URIs</title>
--><p>
<!--
   The general form for a connection <acronym>URI</acronym> is:
-->
接続<acronym class="acronym">URI</acronym>の一般的な形式を以下に示します。
</p><pre class="synopsis">
postgresql://[user[:password]@][netloc][:port][,...][/dbname][?param1=value1&amp;...]
</pre><p>
   </p><p>
<!--
    The <acronym>URI</acronym> scheme designator can be either
    <literal>postgresql://</literal> or <literal>postgres://</literal>.  Each
    of the <acronym>URI</acronym> parts is optional.  The following examples
    illustrate valid <acronym>URI</acronym> syntax uses:
-->
<acronym class="acronym">URI</acronym>スキーム指示子は<code class="literal">postgresql://</code>または<code class="literal">postgres://</code>のいずれかを取ることができます。
個々の<acronym class="acronym">URI</acronym>部品は省略可能です。
以下の例で有効な<acronym class="acronym">URI</acronym>構文の使用例を示します。
</p><pre class="programlisting">
postgresql://
postgresql://localhost
postgresql://localhost:5433
postgresql://localhost/mydb
postgresql://user@localhost
postgresql://user:secret@localhost
postgresql://other@localhost/otherdb?connect_timeout=10&amp;application_name=myapp
postgresql://host1:123,host2:456/somedb?target_session_attrs=any&amp;application_name=myapp
</pre><p>
<!--
    Components of the hierarchical part of the <acronym>URI</acronym> can also
    be given as parameters.  For example:
-->
<acronym class="acronym">URI</acronym>の階層部品の要素をパラメータとして与えることができます。
以下に例を示します。
</p><pre class="programlisting">
postgresql:///mydb?host=localhost&amp;port=5433
</pre><p>
   </p><p>
<!--
    Percent-encoding may be used to include symbols with special meaning in any
    of the <acronym>URI</acronym> parts, e.g. replace <literal>=</literal> with
    <literal>%3D</literal>.

-->
パーセント符号化を使用して、<acronym class="acronym">URI</acronym>部品のいずれかに特殊な意味を持つ記号を含めることができます。
たとえば<code class="literal">=</code>を<code class="literal">%3D</code>で置き換えます。
   </p><p>
<!--
    Any connection parameters not corresponding to key words listed in <xref
    linkend="libpq-paramkeywords"/> are ignored and a warning message about them
    is sent to <filename>stderr</filename>.
-->
<a class="xref" href="libpq-connect.html#LIBPQ-PARAMKEYWORDS" title="34.1.2. パラメータキーワード">34.1.2</a>に示されたキーワードに対応しない接続パラメータは無視され、これに関する警告メッセージが<code class="filename">stderr</code>に書き出されます。
   </p><p>
<!--
    For improved compatibility with JDBC connection <acronym>URI</acronym>s,
    instances of parameter <literal>ssl=true</literal> are translated into
    <literal>sslmode=require</literal>.
-->
JDBCの接続<acronym class="acronym">URI</acronym>構文との互換性を高めるために、<code class="literal">ssl=true</code>パラメータインスタンスは<code class="literal">sslmode=require</code>に変換されます。
   </p><p>
<!--
    The host part may be either host name or an IP address.  To specify an
    IPv6 host address, enclose it in square brackets:
-->
ホスト部分にはホスト名またはIPアドレスを書くことができます。
IPv6ホストアドレスを指定するためには角括弧で括ります。
</p><pre class="synopsis">
postgresql://[2001:db8::1234]/database
</pre><p>
   </p><p>
<!--
    The host component is interpreted as described for the parameter <xref
    linkend="libpq-connect-host"/>.  In particular, a Unix-domain socket
    connection is chosen if the host part is either empty or starts with a
    slash, otherwise a TCP/IP connection is initiated.  Note, however, that the
    slash is a reserved character in the hierarchical part of the URI.  So, to
    specify a non-standard Unix-domain socket directory, either omit the host
    specification in the URI and specify the host as a parameter, or
    percent-encode the path in the host component of the URI:
-->
ホスト要素は<a class="xref" href="libpq-connect.html#LIBPQ-CONNECT-HOST">host</a>で説明したように解釈されます。
具体的には、ホスト部品が空またはスラッシュで始まる場合Unixドメインソケット接続が選択され、さもなければTCP/IP接続で初期化されます。
しかしURIの階層部ではスラッシュが予約された文字であることに注意してください。
このため、標準以外のUnixドメインソケットディレクトリを指定するためには、URIからホスト指定を省き、パラメータとしてホストを指定するか、URIのホスト要素内のパスをパーセントエスケープするかどちらかを行ってください。
</p><pre class="programlisting">
postgresql:///dbname?host=/var/lib/postgresql
postgresql://%2Fvar%2Flib%2Fpostgresql/dbname
</pre><p>
   </p><p>
<!--
    It is possible to specify multiple host components, each with an optional
    port component, in a single URI.  A URI of the form
    <literal>postgresql://host1:port1,host2:port2,host3:port3/</literal>
    is equivalent to a connection string of the form
    <literal>host=host1,host2,host3 port=port1,port2,port3</literal>.  Each
    host will be tried in turn until a connection is successfully established.
-->
単一のURIの中に、オプションのポート要素を伴う複数のホスト要素を指定することができます。
<code class="literal">postgresql://host1:port1,host2:port2,host3:port3/</code>という形式のURIは、<code class="literal">host=host1,host2,host3 port=port1,port2,port3</code>という形式の接続文字列と同じです。
接続の確立に成功するまで、各々のホストが順番に試されます。
   </p></div><div class="sect3" id="LIBPQ-MULTIPLE-HOSTS"><div class="titlepage"><div><div><h4 class="title">34.1.1.3. 複数ホストの指定</h4></div></div></div><!--
     <title>Specifying Multiple Hosts</title>
--><p>
<!--
       It is possible to specify multiple hosts to connect to, so that they are
       tried in the given order. In the Keyword/Value format, the <literal>host</literal>,
       <literal>hostaddr</literal>, and <literal>port</literal> options accept a comma-separated
       list of values. The same number of elements must be given in each
       option that is specified, such
       that e.g. the first <literal>hostaddr</literal> corresponds to the first host name,
       the second <literal>hostaddr</literal> corresponds to the second host name, and so
       forth. As an exception, if only one <literal>port</literal> is specified, it
       applies to all the hosts.
-->
接続先に複数のホストを指定することができ、指定された順に試されます。
キーワード/値形式では、<code class="literal">host</code>、<code class="literal">hostaddr</code>、<code class="literal">port</code>オプションは、カンマで区切った値のリストを受け付けます。
指定された各々のオプションでは、同じ数の要素を与えなければなりません。
たとえば、最初の<code class="literal">hostaddr</code>は最初のホスト名に関連付けられ、二番目の<code class="literal">hostaddr</code>は二番目のホスト名に関連付けられる、という具合です。
例外として、一つの<code class="literal">port</code>だけが指定された場合には、すべてのホストにそれが適用されます。
     </p><p>
<!--
       In the connection URI format, you can list multiple <literal>host:port</literal> pairs
       separated by commas, in the <literal>host</literal> component of the URI.
-->
接続URI形式では、<code class="literal">host</code>要素中にカンマで区切って複数の<code class="literal">host:port</code>ペアを指定できます。
     </p><p>
<!--
       In either format, a single host name can translate to multiple network
       addresses. A common example of this is a host that has both an IPv4 and
       an IPv6 address.
-->
いずれの形式でも、単一ホスト名は複数のネットワークアドレスに変換されることがあります。
これの一般的な例はIPv4とIPv6のアドレスを両方持つホストです。
     </p><p>
<!--
       When multiple hosts are specified, or when a single host name is
       translated to multiple addresses,  all the hosts and addresses will be
       tried in order, until one succeeds. If none of the hosts can be reached,
       the connection fails. If a connection is established successfully, but
       authentication fails, the remaining hosts in the list are not tried.
-->
複数のホスト名が指定された場合、あるいは単一のホスト名が複数のアドレスに変換された場合、そのうちの一つが成功するまで、すべてのホストとアドレスがその順に試されます。
どのホストも到達可能でなければ、接続は失敗します。
接続の確立に成功しても、認証に失敗すると、リスト中の残りのホストは試されません。
     </p><p>
<!--
       If a password file is used, you can have different passwords for
       different hosts. All the other connection options are the same for every
       host in the list; it is not possible to e.g. specify different
       usernames for different hosts.
-->
パスワードファイルが使用される場合は、異なるホストに対して異なるパスワードを使用できます。
他の接続オプションは、リスト中のすべてのホストで同じです。
たとえば、異なるユーザ名を異なるホストに指定することはできません。
     </p></div></div><div class="sect2" id="LIBPQ-PARAMKEYWORDS"><div class="titlepage"><div><div><h3 class="title">34.1.2. パラメータキーワード</h3></div></div></div><!--
   <title>Parameter Key Words</title>
--><p>
<!--
    The currently recognized parameter key words are:
-->
現時点で有効なパラメータのキーワードは以下に示す通りです。

    </p><div class="variablelist"><dl class="variablelist"><dt id="LIBPQ-CONNECT-HOST"><span class="term"><code class="literal">host</code></span></dt><dd><p>
<!--
        Name of host to connect to.<indexterm><primary>host name</primary></indexterm>
        If a host name begins with a slash, it specifies Unix-domain
        communication rather than TCP/IP communication; the value is the
        name of the directory in which the socket file is stored.
        The default behavior when <literal>host</literal> is
        not specified, or is empty, is to connect to a Unix-domain
        socket<indexterm><primary>Unix domain socket</primary></indexterm> in
        <filename>/tmp</filename> (or whatever socket directory was specified
        when <productname>PostgreSQL</productname> was built). On machines without
        Unix-domain sockets, the default is to connect to <literal>localhost</literal>.
-->
接続するホスト名を指定します。
<a id="id-1.7.3.8.4.2.1.1.2.1.1" class="indexterm"></a> ホスト名がスラッシュで始まるならば、それはTCP/IPによる通信ではなく、Unixドメインの通信を示します。
その場合、この値はソケットファイルを格納するディレクトリの名前になります。
<code class="literal">host</code>が指定されなかったり、空の場合のデフォルトの振る舞いは、<code class="filename">/tmp</code>（または、<span class="productname">PostgreSQL</span>の構築時に指定したソケットディレクトリ）にあるUnixドメインのソケットに接続することです。
<a id="id-1.7.3.8.4.2.1.1.2.1.5" class="indexterm"></a>
Unixドメインソケットを持たないマシンにおけるデフォルトは、<code class="literal">localhost</code>に接続することです。
       </p><p>
<!--
        A comma-separated list of host names is also accepted, in which case
        each host name in the list is tried in order; an empty item in the
        list selects the default behavior as explained above. See
        <xref linkend="libpq-multiple-hosts"/> for details.
-->
カンマで区切ったホスト名も受け付けます。
この場合、リスト中のホスト名が順に試されます。
リスト中の空の項目には、上で説明したデフォルトの挙動が適用されます。
詳細は<a class="xref" href="libpq-connect.html#LIBPQ-MULTIPLE-HOSTS" title="34.1.1.3. 複数ホストの指定">34.1.1.3</a>をご覧ください。
       </p></dd><dt id="LIBPQ-CONNECT-HOSTADDR"><span class="term"><code class="literal">hostaddr</code></span></dt><dd><p>
<!--
        Numeric IP address of host to connect to.  This should be in the
        standard IPv4 address format, e.g., <literal>172.28.40.9</literal>.  If
        your machine supports IPv6, you can also use those addresses.
        TCP/IP communication is
        always used when a nonempty string is specified for this parameter.
-->
接続するホストのIPアドレスを指定します。
これは、<code class="literal">172.28.40.9</code>といった標準的なIPv4アドレス書式でなければなりません。
使用するマシンでIPv6をサポートする場合は、そのアドレスを使用することもできます。
このパラメータに空以外の文字列が指定されると、TCP/IP通信が常に使用されます。
       </p><p>
<!--
        Using <literal>hostaddr</literal> instead of <literal>host</literal> allows the
        application to avoid a host name look-up, which might be important
        in applications with time constraints. However, a host name is
        required for GSSAPI or SSPI authentication
        methods, as well as for <literal>verify-full</literal> SSL
        certificate verification.  The following rules are used:
-->
<code class="literal">host</code>の代わりに<code class="literal">hostaddr</code>を使用することで、アプリケーションがホスト名の検索を行なわずに済みます。
特に時間的制約があるアプリケーションでは重要になるでしょう。
しかし、GSSAP、SSPI認証方式では、ホスト名が必要になります。
<code class="literal">verify-full</code>SSL証明書検証を行う場合も同様です。
以下の規則が使用されます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
<!--
           If <literal>host</literal> is specified
           without <literal>hostaddr</literal>, a host name lookup occurs.
           (When using <function>PQconnectPoll</function>, the lookup occurs
           when <function>PQconnectPoll</function> first considers this host
           name, and it may cause <function>PQconnectPoll</function> to block
           for a significant amount of time.)
-->
<code class="literal">hostaddr</code>を使わずに<code class="literal">host</code>を指定した場合は、ホスト名の検索が発生します。
（<code class="function">PQconnectPoll</code>を使う場合、<code class="function">PQconnectPoll</code>が最初にホスト名を考慮するときに、<code class="function">PQconnectPoll</code>をかなり長い時間、ブロックさせてしまうかもしれません。）
          </p></li><li class="listitem"><p>
<!--
           If <literal>hostaddr</literal> is specified without <literal>host</literal>,
           the value for <literal>hostaddr</literal> gives the server network address.
           The connection attempt will fail if the authentication
           method requires a host name.
-->
<code class="literal">host</code>を使わずに<code class="literal">hostaddr</code>を指定した場合、<code class="literal">hostaddr</code>の値はサーバのネットワークアドレスとなります。
認証方式がホスト名を必要する場合は接続試行が失敗します。
          </p></li><li class="listitem"><p>
<!--
           If both <literal>host</literal> and <literal>hostaddr</literal> are specified,
           the value for <literal>hostaddr</literal> gives the server network address.
           The value for <literal>host</literal> is ignored unless the
           authentication method requires it, in which case it will be
           used as the host name.
-->
<code class="literal">host</code>と<code class="literal">hostaddr</code>の両方を指定した場合、<code class="literal">hostaddr</code>がサーバのネットワークアドレスとなります。
<code class="literal">host</code>の値は認証方式で必要とされない限り無視され、必要とされる場合にはホスト名として使用されます。
          </p></li></ul></div><p>
<!--
        Note that authentication is likely to fail if <literal>host</literal>
        is not the name of the server at network address <literal>hostaddr</literal>.
        Also, when both <literal>host</literal> and <literal>hostaddr</literal>
        are specified, <literal>host</literal>
        is used to identify the connection in a password file (see
        <xref linkend="libpq-pgpass"/>).
-->
<code class="literal">host</code>が<code class="literal">hostaddr</code>ネットワークアドレスに対応するマシンの名前と一致しない場合は、認証に失敗する可能性があるので注意してください。
また、<code class="literal">host</code>と<code class="literal">hostaddr</code>の両方が指定されると、<code class="literal">host</code>がパスワードファイル(<a class="xref" href="libpq-pgpass.html" title="34.15. パスワードファイル">34.15</a>を参照)での接続の識別に使用されます。
       </p><p>
<!--
        A comma-separated list of <literal>hostaddr</literal> values is also
        accepted, in which case each host in the list is tried in order.
        An empty item in the list causes the corresponding host name to be
        used, or the default host name if that is empty as well. See
        <xref linkend="libpq-multiple-hosts"/> for details.
-->
カンマ区切りの<code class="literal">hostaddrs</code>値のリストも受け付けます。
この場合、リスト中のホストが順に試されます。
リスト中の空の項目には、対応するホスト名が使用されます。
そのホスト名も空の場合は、デフォルトのホスト名が使用されます。
詳細は<a class="xref" href="libpq-connect.html#LIBPQ-MULTIPLE-HOSTS" title="34.1.1.3. 複数ホストの指定">34.1.1.3</a>をご覧ください。
       </p><p>
<!--
        Without either a host name or host address,
        <application>libpq</application> will connect using a
        local Unix-domain socket; or on machines without Unix-domain
        sockets, it will attempt to connect to <literal>localhost</literal>.
-->
ホスト名もホストのアドレスも用いない場合、<span class="application">libpq</span>はローカルのUnixドメインソケットを使用して接続します。
ただし、Unixドメインソケットを持たないマシンでは、<code class="literal">localhost</code>への接続を試みます。
       </p></dd><dt id="LIBPQ-CONNECT-PORT"><span class="term"><code class="literal">port</code></span></dt><dd><p>
<!--
        Port number to connect to at the server host, or socket file
        name extension for Unix-domain
        connections.<indexterm><primary>port</primary></indexterm>
        If multiple hosts were given in the <literal>host</literal> or
        <literal>hostaddr</literal> parameters, this parameter may specify a
        comma-separated list of ports of the same length as the host list, or
        it may specify a single port number to be used for all hosts.
        An empty string, or an empty item in a comma-separated list,
        specifies the default port number established
        when <productname>PostgreSQL</productname> was built.
-->
サーバホストでの接続用のポート番号、または、Unixドメイン接続の場合は、ソケットファイルの拡張子を指定します。
<a id="id-1.7.3.8.4.2.1.3.2.1.1" class="indexterm"></a>
もし複数のホストが<code class="literal">host</code>あるいは<code class="literal">hostaddr</code>パラメータで与えられると、このパラメータで同じ長さのポートのリストを与えることができます。
あるいは、一つのポート番号をすべてのホストに指定することもできます。
空文字、あるいはカンマ区切りリスト中の空の項目は、<span class="productname">PostgreSQL</span>が構築されたときに設定されたデフォルトポート番号を指定します。
       </p></dd><dt id="LIBPQ-CONNECT-DBNAME"><span class="term"><code class="literal">dbname</code></span></dt><dd><p>
<!--
       The database name.  Defaults to be the same as the user name.
       In certain contexts, the value is checked for extended
       formats; see <xref linkend="libpq-connstring"/> for more details on
       those.
-->
データベース名を指定します。
デフォルトはユーザ名と同じです。
特定の文脈では、この値は拡張書式で検査されます。
詳細については<a class="xref" href="libpq-connect.html#LIBPQ-CONNSTRING" title="34.1.1. 接続文字列">34.1.1</a>を参照してください。
      </p></dd><dt id="LIBPQ-CONNECT-USER"><span class="term"><code class="literal">user</code></span></dt><dd><p>
<!--
       <productname>PostgreSQL</productname> user name to connect as.
       Defaults to be the same as the operating system name of the user
       running the application.
-->
データベースへ接続する<span class="productname">PostgreSQL</span>ユーザ名を指定します。
デフォルトは、そのアプリケーションを実行しているユーザのオペレーティングシステム上の名前と同じです。
      </p></dd><dt id="LIBPQ-CONNECT-PASSWORD"><span class="term"><code class="literal">password</code></span></dt><dd><p>
<!--
       Password to be used if the server demands password authentication.
-->
サーバがパスワードによる認証を必要とした場合に使用されるパスワードを指定します。
      </p></dd><dt id="LIBPQ-CONNECT-PASSFILE"><span class="term"><code class="literal">passfile</code></span></dt><dd><p>
<!--
       Specifies the name of the file used to store passwords
       (see <xref linkend="libpq-pgpass"/>).
       Defaults to <filename>~/.pgpass</filename>, or
       <filename>%APPDATA%\postgresql\pgpass.conf</filename> on Microsoft Windows.
       (No error is reported if this file does not exist.)
-->
パスワードを格納するファイル名を指定します。（<a class="xref" href="libpq-pgpass.html" title="34.15. パスワードファイル">34.15</a>参照。）
デフォルトは<code class="filename">~/.pgpass</code>または、Microsoft Windowsでは<code class="filename">%APPDATA%\postgresql\pgpass.conf</code>です。
（このファイルが存在しなくてもエラーは報告されません。）
      </p></dd><dt id="LIBPQ-CONNECT-CONNECT-TIMEOUT"><span class="term"><code class="literal">connect_timeout</code></span></dt><dd><p>
<!--
       Maximum wait for connection, in seconds (write as a decimal integer,
       e.g. <literal>10</literal>).  Zero, negative, or not specified means
       wait indefinitely.  The minimum allowed timeout is 2 seconds, therefore
       a value of <literal>1</literal> is interpreted as <literal>2</literal>.
       This timeout applies separately to each host name or IP address.
       For example, if you specify two hosts and <literal>connect_timeout</literal>
       is 5, each host will time out if no connection is made within 5
       seconds, so the total time spent waiting for a connection might be
       up to 10 seconds.
-->
接続用の最大待機を秒単位（10進整数で記述してください、<code class="literal">10</code>など）で指定します。
ゼロ、負値、もしくは未設定は、無期限の待機を意味します。
許容される最小のタイムアウトは2秒です。
したがって、<code class="literal">1</code>は<code class="literal">2</code>と解釈されます。
このタイムアウトは各ホスト名やIPアドレスに別々に適用されます。
例えば、二つのホストを指定して、<code class="literal">connect_timeout</code>が5であるなら、各ホストが5秒以内に接続できないときにタイムアウトして、接続を待つ合計所要時間は10秒近くになるかもしれません。
      </p></dd><dt id="LIBPQ-CONNECT-CLIENT-ENCODING"><span class="term"><code class="literal">client_encoding</code></span></dt><dd><p>
<!--
       This sets the <varname>client_encoding</varname>
       configuration parameter for this connection.  In addition to
       the values accepted by the corresponding server option, you
       can use <literal>auto</literal> to determine the right
       encoding from the current locale in the client
       (<envar>LC_CTYPE</envar> environment variable on Unix
       systems).
-->
接続用の<code class="varname">client_encoding</code>設定パラメータを設定します。
対応するサーバオプションで受け付けられる値の他に、クライアントにおける現在のロケール（Unixシステムの場合は<code class="envar">LC_CTYPE</code>環境変数）から正しい符号化方式を決定する<code class="literal">auto</code>を使用することができます。
      </p></dd><dt id="LIBPQ-CONNECT-OPTIONS"><span class="term"><code class="literal">options</code></span></dt><dd><p>
<!--
        Specifies command-line options to send to the server at connection
        start.  For example, setting this to <literal>-c geqo=off</literal> sets the
        session's value of the <varname>geqo</varname> parameter to
        <literal>off</literal>.  Spaces within this string are considered to
        separate command-line arguments, unless escaped with a backslash
        (<literal>\</literal>); write <literal>\\</literal> to represent a literal
        backslash.  For a detailed discussion of the available
        options, consult <xref linkend="runtime-config"/>.
-->
接続開始時にサーバに送信するコマンドラインオプションを指定します。
例えば、これを<code class="literal">-c geqo=off</code>に設定すると、<code class="varname">geqo</code>パラメータのセッション値は<code class="literal">off</code>になります。
この文字列中の空白はバックスラッシュ(<code class="literal">\</code>)でエスケープされていなければコマンド行引数の区切りであるとみなされます。
リテラルのバックスラッシュを表すには<code class="literal">\\</code>と書いて下さい。
利用可能なオプションに関する詳細については<a class="xref" href="runtime-config.html" title="第19章 サーバの設定">第19章</a>を参照してください。
       </p></dd><dt id="LIBPQ-CONNECT-APPLICATION-NAME"><span class="term"><code class="literal">application_name</code></span></dt><dd><p>
<!--
        Specifies a value for the <xref linkend="guc-application-name"/>
        configuration parameter.
-->
<a class="xref" href="runtime-config-logging.html#GUC-APPLICATION-NAME">application_name</a>設定パラメータの値を指定します。
       </p></dd><dt id="LIBPQ-CONNECT-FALLBACK-APPLICATION-NAME"><span class="term"><code class="literal">fallback_application_name</code></span></dt><dd><p>
<!--
        Specifies a fallback value for the <xref
        linkend="guc-application-name"/> configuration parameter.
        This value will be used if no value has been given for
        <literal>application_name</literal> via a connection parameter or the
        <envar>PGAPPNAME</envar> environment variable.  Specifying
        a fallback name is useful in generic utility programs that
        wish to set a default application name but allow it to be
        overridden by the user.
-->
<a class="xref" href="runtime-config-logging.html#GUC-APPLICATION-NAME">application_name</a>設定パラメータの予備値を指定します。
接続パラメータまたは<code class="envar">PGAPPNAME</code>環境変数により<code class="literal">application_name</code>の値が指定されない場合に、この値が使用されます。
予備の名前を指定することは、デフォルトのアプリケーション名を設定したいが、ユーザにもそれを上書きできるようにしておきたい、一般的なユーティリティプログラムで有用です。
       </p></dd><dt id="LIBPQ-KEEPALIVES"><span class="term"><code class="literal">keepalives</code></span></dt><dd><p>
<!--
        Controls whether client-side TCP keepalives are used. The default
        value is 1, meaning on, but you can change this to 0, meaning off,
        if keepalives are not wanted.  This parameter is ignored for
        connections made via a Unix-domain socket.
-->
クライアント側におけるTCPキープアライブの使用を制御します。
デフォルト値は1であり、有効であることを意味します。
しかしキープアライブを望まない場合は、無効であることを意味するゼロに設定することができます。
このパラメータはUnixドメインソケット経由の接続では無視されます。
       </p></dd><dt id="LIBPQ-KEEPALIVES-IDLE"><span class="term"><code class="literal">keepalives_idle</code></span></dt><dd><p>
<!--
        Controls the number of seconds of inactivity after which TCP should
        send a keepalive message to the server.  A value of zero uses the
        system default. This parameter is ignored for connections made via a
        Unix-domain socket, or if keepalives are disabled.
        It is only supported on systems where <symbol>TCP_KEEPIDLE</symbol> or
        an equivalent socket option is available, and on Windows; on other
        systems, it has no effect.
-->
TCPがサーバにキープアライブメッセージを送信した後に活動を行わない期間を秒単位で制御します。
ゼロという値ではシステムのデフォルトを使用します。
Unixドメインソケット経由でなされた接続の場合もしくはキープアライブが無効な場合、このパラメータは無視されます。
これは<code class="symbol">TCP_KEEPIDLE</code>または同等のソケットオプションが利用できるシステムおよびWindowsでのみサポートされます。
他のシステムでは効果がありません。
       </p></dd><dt id="LIBPQ-KEEPALIVES-INTERVAL"><span class="term"><code class="literal">keepalives_interval</code></span></dt><dd><p>
<!--
        Controls the number of seconds after which a TCP keepalive message
        that is not acknowledged by the server should be retransmitted.  A
        value of zero uses the system default. This parameter is ignored for
        connections made via a Unix-domain socket, or if keepalives are disabled.
        It is only supported on systems where <symbol>TCP_KEEPINTVL</symbol> or
        an equivalent socket option is available, and on Windows; on other
        systems, it has no effect.
-->
TCPキープアライブメッセージに対する応答がサーバからない場合に、何秒後に再送を行うかを制御します。
ゼロという値ではシステムのデフォルトを使用します。
Unixドメインソケット経由でなされた接続の場合、またはキープアライブを無効にしている場合、このパラメータは無視されます。
これは<code class="symbol">TCP_KEEPINTVL</code>または同等のソケットオプションが利用できるシステムおよびWindowsでのみサポートされます。
他のシステムでは効果がありません。
       </p></dd><dt id="LIBPQ-KEEPALIVES-COUNT"><span class="term"><code class="literal">keepalives_count</code></span></dt><dd><p>
<!--
        Controls the number of TCP keepalives that can be lost before the
        client's connection to the server is considered dead.  A value of
        zero uses the system default. This parameter is ignored for
        connections made via a Unix-domain socket, or if keepalives are disabled.
        It is only supported on systems where <symbol>TCP_KEEPCNT</symbol> or
        an equivalent socket option is available; on other systems, it has no
        effect.
-->
サーバへのクライアント接続が不要になったとみなすまで、何回キープアライブの欠落を認めるかを制御します。
ゼロという値ではシステムのデフォルトを使用します。
Unixドメインソケット経由でなされた接続の場合、またはキープアライブを無効にしている場合、このパラメータは無視されます。
これは<code class="symbol">TCP_KEEPCNT</code>または同等のソケットオプションが利用できるシステムでのみサポートされます。
他のシステムでは効果がありません。
       </p></dd><dt id="LIBPQ-CONNECT-TTY"><span class="term"><code class="literal">tty</code></span></dt><dd><p>
<!--
       Ignored (formerly, this specified where to send server debug output).
-->
無視されます(以前は、これはサーバデバッグ出力を送信する場所を指定するものでした)。
      </p></dd><dt id="LIBPQ-CONNECT-REPLICATION"><span class="term"><code class="literal">replication</code></span></dt><dd><p>
<!--
       This option determines whether the connection should use the
       replication protocol instead of the normal protocol.  This is what
       PostgreSQL replication connections as well as tools such as
       <application>pg_basebackup</application> use internally, but it can
       also be used by third-party applications.  For a description of the
       replication protocol, consult <xref linkend="protocol-replication"/>.
-->
このオプションは接続が通常プロトコルの代わりにレプリケーションプロトコルで使われるかどうかを決めます。
これは<span class="application">pg_basebackup</span>などのツールが内部的に使うPostgreSQLのレプリケーション接続ですが、サードパーティアプリケーションからも使われることがあります。
レプリケーションプロトコルについての説明は<a class="xref" href="protocol-replication.html" title="53.4. ストリーミングレプリケーションプロトコル">53.4</a>を参照してください。
      </p><p>
<!--
       The following values, which are case-insensitive, are supported:
-->
以下の値がサポートされます。これらは大文字小文字を区別しません。
       </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">
          <code class="literal">true</code>, <code class="literal">on</code>,
          <code class="literal">yes</code>, <code class="literal">1</code>
         </span></dt><dd><p>
<!--
           The connection goes into physical replication mode.
-->
接続は物理レプリケーションモードになります。
          </p></dd><dt><span class="term"><code class="literal">database</code></span></dt><dd><p>
<!--
           The connection goes into logical replication mode, connecting to
           the database specified in the <literal>dbname</literal> parameter.
-->
接続はロジカルレプリケーションモードになり、<code class="literal">dbname</code>パラメータで指定されたデータベースに接続します。
          </p></dd><dt><span class="term">
          <code class="literal">false</code>, <code class="literal">off</code>,
          <code class="literal">no</code>, <code class="literal">0</code>
         </span></dt><dd><p>
<!--
           The connection is a regular one, which is the default behavior.
-->
接続は通常のものになります。これがデフォルトの振る舞いです。
          </p></dd></dl></div><p>
      </p><p>
<!--
       In physical or logical replication mode, only the simple query protocol
       can be used.
-->
物理あるいは論理レプリケーションモードでは、簡易問い合わせプロトコルのみが使用できます。
      </p></dd><dt id="LIBPQ-CONNECT-SSLMODE"><span class="term"><code class="literal">sslmode</code></span></dt><dd><p>
<!--
        This option determines whether or with what priority a secure
        <acronym>SSL</acronym> TCP/IP connection will be negotiated with the
        server. There are six modes:
-->
このオプションは、どの<acronym class="acronym">SSL</acronym>による安全なTCP/IP接続の優先度でサーバと調停するかを決定します。
6つのモードがあります。

        </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">disable</code></span></dt><dd><p>
<!--
            only try a non-<acronym>SSL</acronym> connection
-->
非<acronym class="acronym">SSL</acronym>接続のみ試行
           </p></dd><dt><span class="term"><code class="literal">allow</code></span></dt><dd><p>
<!--
            first try a non-<acronym>SSL</acronym> connection; if that
            fails, try an <acronym>SSL</acronym> connection
-->
最初に非<acronym class="acronym">SSL</acronym>接続を試行し、失敗したら、<acronym class="acronym">SSL</acronym>接続を試行
           </p></dd><dt><span class="term"><code class="literal">prefer</code> （デフォルト）</span></dt><dd><p>
<!--
            first try an <acronym>SSL</acronym> connection; if that fails,
            try a non-<acronym>SSL</acronym> connection
-->
最初に<acronym class="acronym">SSL</acronym>接続を試行し、失敗したら、非<acronym class="acronym">SSL</acronym>接続を試行
           </p></dd><dt><span class="term"><code class="literal">require</code></span></dt><dd><p>
<!--
            only try an <acronym>SSL</acronym> connection. If a root CA
            file is present, verify the certificate in the same way as
            if <literal>verify-ca</literal> was specified
-->
<acronym class="acronym">SSL</acronym>接続のみ試行。
ルートCAファイルが存在する場合、<code class="literal">verify-ca</code>が指定された場合と同じ方法で証明書が検証されます。
           </p></dd><dt><span class="term"><code class="literal">verify-ca</code></span></dt><dd><p>
<!--
            only try an <acronym>SSL</acronym> connection, and verify that
            the server certificate is issued by a trusted
            certificate authority (<acronym>CA</acronym>)
-->
<acronym class="acronym">SSL</acronym>接続のみ試行し、サーバ証明書が信用された認証局（<acronym class="acronym">CA</acronym>）から発行されたかを検証
           </p></dd><dt><span class="term"><code class="literal">verify-full</code></span></dt><dd><p>
<!--
            only try an <acronym>SSL</acronym> connection, verify that the
            server certificate is issued by a
            trusted <acronym>CA</acronym> and that the requested server host name
            matches that in the certificate
-->
<acronym class="acronym">SSL</acronym>接続のみ試行し、サーバ証明書が信用された<acronym class="acronym">CA</acronym>から発行されたか、およびそのサーバホスト名が証明書内のものと一致するかを検証
           </p></dd></dl></div><p>

<!--
        See <xref linkend="libpq-ssl"/> for a detailed description of how
        these options work.
-->
これらのオプションがどのように動くのかについては<a class="xref" href="libpq-ssl.html" title="34.18. SSLサポート">34.18</a>を参照してください。
       </p><p>
<!--
        <literal>sslmode</literal> is ignored for Unix domain socket
        communication.
        If <productname>PostgreSQL</productname> is compiled without SSL support,
        using options <literal>require</literal>, <literal>verify-ca</literal>, or
        <literal>verify-full</literal> will cause an error, while
        options <literal>allow</literal> and <literal>prefer</literal> will be
        accepted but <application>libpq</application> will not actually attempt
        an <acronym>SSL</acronym>
        connection.<indexterm><primary>SSL</primary><secondary
        sortas="libpq">with libpq</secondary></indexterm>
-->
<code class="literal">sslmode</code>はUnixドメインソケット通信では無視されます。
SSLサポートなしで<span class="productname">PostgreSQL</span>がコンパイルされた場合に、<code class="literal">require</code>、<code class="literal">verify-ca</code>、<code class="literal">verify-full</code>を使用するとエラーになります。
一方、<code class="literal">allow</code>と<code class="literal">prefer</code>は使用できますが、実際に<span class="application">libpq</span>は<acronym class="acronym">SSL</acronym>接続を受け付けません。
<a id="id-1.7.3.8.4.2.1.19.2.2.10" class="indexterm"></a>
       </p></dd><dt id="LIBPQ-CONNECT-REQUIRESSL"><span class="term"><code class="literal">requiressl</code></span></dt><dd><p>
<!--
        This option is deprecated in favor of the <literal>sslmode</literal>
        setting.
-->
このオプションは<code class="literal">sslmode</code>設定を支持する観点から廃止予定になっています。
       </p><p>
<!--
        If set to 1, an <acronym>SSL</acronym> connection to the server
        is required (this is equivalent to <literal>sslmode</literal>
        <literal>require</literal>).  <application>libpq</application> will then refuse
        to connect if the server does not accept an
        <acronym>SSL</acronym> connection.  If set to 0 (default),
        <application>libpq</application> will negotiate the connection type with
        the server (equivalent to <literal>sslmode</literal>
        <literal>prefer</literal>).  This option is only available if
        <productname>PostgreSQL</productname> is compiled with SSL support.
-->
1に設定することで、サーバへの<acronym class="acronym">SSL</acronym>接続が必要になります
(これは<code class="literal">sslmode</code>の<code class="literal">require</code>と同じです)。
サーバが<acronym class="acronym">SSL</acronym>接続を受け付けない場合、<span class="application">libpq</span>は接続を拒絶します。
0(デフォルト)に設定することで、サーバと接続形式の調停を行います。
(<code class="literal">sslmode</code>の<code class="literal">prefer</code>と同じです。)
SSLサポート付きで<span class="productname">PostgreSQL</span>をコンパイルした場合にのみ、このオプションが利用できます。
       </p></dd><dt id="LIBPQ-CONNECT-SSLCOMPRESSION"><span class="term"><code class="literal">sslcompression</code></span></dt><dd><p>
<!--
        If set to 1, data sent over SSL connections will be compressed.  If
        set to 0, compression will be disabled.  The default is 0.  This
        parameter is ignored if a connection without SSL is made.
-->
1に設定することで、SSL接続越えで送信されるデータは圧縮されます。
0に設定すると、圧縮が無効になります。
デフォルトは0です。
このパラメータはSSLを使わない接続では無視されます。
       </p><p>
<!--
        SSL compression is nowadays considered insecure and its use is no
        longer recommended.  <productname>OpenSSL</productname> 1.1.0 disables
        compression by default, and many operating system distributions
        disable it in prior versions as well, so setting this parameter to on
        will not have any effect if the server does not accept compression.
        On the other hand, <productname>OpenSSL</productname> before 1.0.0
        does not support disabling compression, so this parameter is ignored
        with those versions, and whether compression is used depends on the
        server.
-->
SSL圧縮は今日では安全ではないと考えられていて、もはや使用は推奨されません。
<span class="productname">OpenSSL</span> 1.1.0はデフォルトでは圧縮を無効にしており、多くのOSディストリビューションでもこれまでのバージョンで無効化しています。そのため、サーバが圧縮を受け付けない場合、本パラメータをonに設定しても効果がありません。
一方で、1.0.0以前の<span class="productname">OpenSSL</span>は圧縮の無効化をサポートしていませんので、これらのバージョンでは本パラメータは無視されて、圧縮が使用されるかはサーバ次第です。
       </p><p>
<!--
        If security is not a primary concern, compression can improve
        throughput if the network is the bottleneck.  Disabling compression
        can improve response time and throughput if CPU performance is the
        limiting factor.
-->
セキュリティが主要な関心でないなら、ネットワークがボトルネックであるとき圧縮でスループットを改善できます。
CPU性能が律速要素であるなら、圧縮を無効化することで応答時間とスループットを改善できます。
       </p></dd><dt id="LIBPQ-CONNECT-SSLCERT"><span class="term"><code class="literal">sslcert</code></span></dt><dd><p>
<!--
        This parameter specifies the file name of the client SSL
        certificate, replacing the default
        <filename>~/.postgresql/postgresql.crt</filename>.
        This parameter is ignored if an SSL connection is not made.
-->
このパラメータは、<code class="filename">~/.postgresql/postgresql.crt</code>というデフォルトを置き換えるクライアントSSL証明書のファイル名を指定します。
このパラメータはSSL接続が確立していない場合は無視されます。
       </p></dd><dt id="LIBPQ-CONNECT-SSLKEY"><span class="term"><code class="literal">sslkey</code></span></dt><dd><p>
<!--
        This parameter specifies the location for the secret key used for
        the client certificate. It can either specify a file name that will
        be used instead of the default
        <filename>~/.postgresql/postgresql.key</filename>, or it can specify a key
        obtained from an external <quote>engine</quote> (engines are
        <productname>OpenSSL</productname> loadable modules).  An external engine
        specification should consist of a colon-separated engine name and
        an engine-specific key identifier.  This parameter is ignored if an
        SSL connection is not made.
-->
このパラメータはクライアント証明書に対して使用される秘密鍵の場所を指定します。
デフォルトの<code class="filename">~/.postgresql/postgresql.key</code>の代わりに使用されるファイル名、または外部<span class="quote">「<span class="quote">エンジン</span>」</span>（エンジンとは<span class="productname">OpenSSL</span>ロード可能なモジュール）から得られるキーを指定することも可能です。
外部エンジンの指定にはコロンで区切ったエンジン名とエンジン特有の鍵識別子を含んでいなければなりません。
SSL接続が確立していない場合このパラメータは無視されます。
       </p></dd><dt id="LIBPQ-CONNECT-SSLROOTCERT"><span class="term"><code class="literal">sslrootcert</code></span></dt><dd><p>
<!--
        This parameter specifies the name of a file containing SSL
        certificate authority (<acronym>CA</acronym>) certificate(s).
        If the file exists, the server's certificate will be verified
        to be signed by one of these authorities.  The default is
        <filename>~/.postgresql/root.crt</filename>.
-->
このパラメータはSSL認証局(<acronym class="acronym">CA</acronym>)の証明書のファイル名を指定します。
このファイルが存在する場合、サーバ証明書はこれらの認証局の1つで署名されているかどうか検証されます。
デフォルトは<code class="filename">~/.postgresql/root.crt</code>です。
       </p></dd><dt id="LIBPQ-CONNECT-SSLCRL"><span class="term"><code class="literal">sslcrl</code></span></dt><dd><p>
<!--
        This parameter specifies the file name of the SSL certificate
        revocation list (CRL).  Certificates listed in this file, if it
        exists, will be rejected while attempting to authenticate the
        server's certificate.  The default is
        <filename>~/.postgresql/root.crl</filename>.
-->
このパラメータはSSL証明書失効リスト（CRL）のファイル名を指定します。
このファイルに列挙された証明書が存在した場合、それはサーバ証明書を承認しようとする時に拒絶されます。
デフォルトは<code class="filename">~/.postgresql/root.crl</code>です。
       </p></dd><dt id="LIBPQ-CONNECT-REQUIREPEER"><span class="term"><code class="literal">requirepeer</code></span></dt><dd><p>
<!--
        This parameter specifies the operating-system user name of the
        server, for example <literal>requirepeer=postgres</literal>.
        When making a Unix-domain socket connection, if this
        parameter is set, the client checks at the beginning of the
        connection that the server process is running under the specified
        user name; if it is not, the connection is aborted with an error.
        This parameter can be used to provide server authentication similar
        to that available with SSL certificates on TCP/IP connections.
        (Note that if the Unix-domain socket is in
        <filename>/tmp</filename> or another publicly writable location,
        any user could start a server listening there.  Use this parameter
        to ensure that you are connected to a server run by a trusted user.)
        This option is only supported on platforms for which the
        <literal>peer</literal> authentication method is implemented; see
        <xref linkend="auth-peer"/>.
-->
このパラメータは、例えば<code class="literal">requirepeer=postgres</code>のようにサーバのオペレーティングシステムのユーザ名を指定します。
Unixドメインソケット接続を確立する時に、このパラメータが設定された場合、クライアントは接続開始時にサーバプロセスが指定されたユーザ名で稼動しているか検査し、稼動していない場合は接続をエラーとして中断します。
このパラメータは、TCP/IP接続においてSSL証明書で実現するようなサーバ認証を実現するために使用することができます。
（Unixドメインソケットが<code class="filename">/tmp</code>などの誰にでも書き込むことができる場所にある場合、誰でもそこで接続を監視するサーバを起動できることに注意してください。
信頼できるユーザが起動したサーバに接続することを確実に行うために、このパラメータを使用してください。）
このオプションは<code class="literal">peer</code>認証方式が実装されたプラットフォームでのみでサポートされます。
<a class="xref" href="auth-peer.html" title="20.9. Peer認証">20.9</a>を参照してください。
       </p></dd><dt id="LIBPQ-CONNECT-KRBSRVNAME"><span class="term"><code class="literal">krbsrvname</code></span></dt><dd><p>
<!--
        Kerberos service name to use when authenticating with GSSAPI.
        This must match the service name specified in the server
        configuration for Kerberos authentication to succeed. (See also
        <xref linkend="gssapi-auth"/>.)
-->
GSSAPIの認証時に使われるKerberosサービス名です。
成功するためには、これはサーバのKerberos認証設定のサービス名と一致していなければなりません。
(<a class="xref" href="gssapi-auth.html" title="20.6. GSSAPI認証">20.6</a>も参照してください。)
       </p></dd><dt id="LIBPQ-CONNECT-GSSLIB"><span class="term"><code class="literal">gsslib</code></span></dt><dd><p>
<!--
        GSS library to use for GSSAPI authentication. Only used on Windows.
        Set to <literal>gssapi</literal> to force libpq to use the GSSAPI
        library for authentication instead of the default SSPI.
-->
GSSAPI認証で使用されるGSSライブラリです。
Windows上のみで使用されます。
libpqの認証がデフォルトのSSPIではなく、強制的にGSSAPIライブラリを使用させるには<code class="literal">gssapi</code>を設定してください。
       </p></dd><dt id="LIBPQ-CONNECT-SERVICE"><span class="term"><code class="literal">service</code></span></dt><dd><p>
<!--
        Service name to use for additional parameters.  It specifies a service
        name in <filename>pg_service.conf</filename> that holds additional connection parameters.
        This allows applications to specify only a service name so connection parameters
        can be centrally maintained. See <xref linkend="libpq-pgservice"/>.
-->
追加のパラメータ用に使用されるサービス名です。
<code class="filename">pg_service.conf</code>内の追加的な接続パラメータを保持するサービス名を指定します。
これによりアプリケーションはサービス名だけを指定でき、接続パラメータを集中的に保守できるようになります。
<a class="xref" href="libpq-pgservice.html" title="34.16. 接続サービスファイル">34.16</a>を参照してください。
       </p></dd><dt id="LIBPQ-CONNECT-TARGET-SESSION-ATTRS"><span class="term"><code class="literal">target_session_attrs</code></span></dt><dd><p>
<!--
        If this parameter is set to <literal>read-write</literal>, only a
        connection in which read-write transactions are accepted by default
        is considered acceptable.  The query
        <literal>SHOW transaction_read_only</literal> will be sent upon any
        successful connection; if it returns <literal>on</literal>, the connection
        will be closed.  If multiple hosts were specified in the connection
        string, any remaining servers will be tried just as if the connection
        attempt had failed.  The default value of this parameter,
        <literal>any</literal>, regards all connections as acceptable.
-->
このパラメータが<code class="literal">read-write</code>なら、読み書きトランザクションがデフォルトで許容される接続だけが受付可能になります。
接続に成功すると、問合せ<code class="literal">SHOW transaction_read_only</code>が送られ、<code class="literal">on</code>が返ると接続は閉じられます。
接続文字列で複数のホストが指定されている場合は、あたかも接続の試みが失敗したかのように、残りのサーバが試されます。
このパラメータのデフォルト値は<code class="literal">any</code>で、すべての接続が受付可能であると見なされます。
      </p></dd></dl></div><p>
   </p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="libpq.html">前へ</a> </td><td width="20%" align="center"><a accesskey="u" href="libpq.html">上へ</a></td><td width="40%" align="right"> <a accesskey="n" href="libpq-status.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">第34章 <span class="application">libpq</span> - C ライブラリ </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> 34.2. 接続状態関数</td></tr></table></div></body></html>